#!/bin/bash

# 美化01_initialization.c文件的脚本
# 替换非语义化的函数名和变量名为语义化名称

FILE="/dev/shm/mountblade-code/TaleWorlds.Native/src/01_initialization.c"

# 备份原文件
cp "$FILE" "$FILE.backup"

# 函数名替换
sed -i 's/FUN_18002c340/system_initialize_main/g' "$FILE"
sed -i 's/FUN_18002c440/system_initialize_subsystem/g' "$FILE"
sed -i 's/FUN_18002c540/system_initialize_memory/g' "$FILE"
sed -i 's/FUN_18002c640/system_initialize_thread/g' "$FILE"
sed -i 's/FUN_18002c740/system_initialize_config/g' "$FILE"
sed -i 's/FUN_18002c840/system_initialize_resource/g' "$FILE"
sed -i 's/FUN_18002c940/system_initialize_audio/g' "$FILE"
sed -i 's/FUN_18002ca40/system_initialize_network/g' "$FILE"
sed -i 's/FUN_18002cb40/system_initialize_render/g' "$FILE"
sed -i 's/FUN_18002cc40/system_initialize_input/g' "$FILE"
sed -i 's/FUN_18002d150/system_initialize_module/g' "$FILE"
sed -i 's/FUN_18002d320/system_initialize_plugin/g' "$FILE"
sed -i 's/FUN_18002d420/system_initialize_security/g' "$FILE"
sed -i 's/FUN_18002d550/system_initialize_debug/g' "$FILE"
sed -i 's/FUN_18002d5e0/system_initialize_monitor/g' "$FILE"
sed -i 's/FUN_18002d6e0/system_initialize_log/g' "$FILE"
sed -i 's/FUN_18002d7e0/system_initialize_cleanup/g' "$FILE"
sed -i 's/FUN_18002d8e0/system_initialize_sync/g' "$FILE"
sed -i 's/FUN_18002d9e0/system_initialize_performance/g' "$FILE"
sed -i 's/FUN_18002dae0/system_initialize_error/g' "$FILE"

# 变量名替换
sed -i 's/DAT_1809fc740/system_init_config_data/g' "$FILE"
sed -i 's/UNK_18098c790/system_init_context_ptr/g' "$FILE"
sed -i 's/FUN_18008d070/system_get_context_manager/g' "$FILE"
sed -i 's/FUN_18008f0d0/system_allocate_memory/g' "$FILE"
sed -i 's/FUN_18008f140/system_initialize_context/g' "$FILE"
sed -i 's/FUN_18006b8f0/system_get_init_function/g' "$FILE"

# 替换其他UNK和DAT变量
sed -i 's/UNK_180a25b40/system_module_loader_ptr/g' "$FILE"
sed -i 's/UNK_180a25b48/system_resource_manager_ptr/g' "$FILE"
sed -i 's/UNK_180a25b60/system_config_manager_ptr/g' "$FILE"
sed -i 's/UNK_180a25b6c/system_thread_manager_ptr/g' "$FILE"
sed -i 's/UNK_180a25b80/system_memory_manager_ptr/g' "$FILE"
sed -i 's/UNK_180a25b88/system_network_manager_ptr/g' "$FILE"
sed -i 's/UNK_180a25bc8/system_audio_manager_ptr/g' "$FILE"
sed -i 's/UNK_180a25bd4/system_render_manager_ptr/g' "$FILE"
sed -i 's/UNK_180a25be0/system_input_manager_ptr/g' "$FILE"
sed -i 's/UNK_180a25c58/system_plugin_manager_ptr/g' "$FILE"
sed -i 's/UNK_180a25c84/system_security_manager_ptr/g' "$FILE"
sed -i 's/UNK_180a25c90/system_debug_manager_ptr/g' "$FILE"
sed -i 's/UNK_180a2b468/system_monitor_manager_ptr/g' "$FILE"
sed -i 's/UNK_180a25c04/system_log_manager_ptr/g' "$FILE"
sed -i 's/UNK_180a25c10/system_cleanup_manager_ptr/g' "$FILE"
sed -i 's/UNK_180a25c20/system_sync_manager_ptr/g' "$FILE"
sed -i 's/UNK_180a25ca0/system_performance_manager_ptr/g' "$FILE"
sed -i 's/UNK_180a25cdc/system_error_manager_ptr/g' "$FILE"
sed -i 's/UNK_180a0dcf8/system_context_base_ptr/g' "$FILE"
sed -i 's/UNK_180a25bfc/system_config_base_ptr/g' "$FILE"
sed -i 's/UNK_180a25ce8/system_memory_base_ptr/g' "$FILE"
sed -i 's/UNK_180a25cf8/system_thread_base_ptr/g' "$FILE"
sed -i 's/DAT_180a25d28/system_version_info_ptr/g' "$FILE"
sed -i 's/DAT_180a0209c/system_engine_info_ptr/g' "$FILE"
sed -i 's/DAT_180a022f0/system_platform_info_ptr/g' "$FILE"
sed -i 's/DAT_180a02320/system_device_info_ptr/g' "$FILE"
sed -i 's/UNK_180a25ca8/system_resource_cache_ptr/g' "$FILE"
sed -i 's/DAT_180a25cb4/system_memory_cache_ptr/g' "$FILE"
sed -i 's/UNK_180a25cc0/system_thread_cache_ptr/g' "$FILE"
sed -i 's/UNK_180a25cd0/system_config_cache_ptr/g' "$FILE"
sed -i 's/UNK_180a25d78/system_module_cache_ptr/g' "$FILE"
sed -i 's/UNK_180a25d90/system_plugin_cache_ptr/g' "$FILE"
sed -i 's/UNK_180a25d98/system_security_cache_ptr/g' "$FILE"
sed -i 's/UNK_180a25da8/system_debug_cache_ptr/g' "$FILE"
sed -i 's/DAT_180a02030/system_monitor_cache_ptr/g' "$FILE"
sed -i 's/DAT_180a0206c/system_log_cache_ptr/g' "$FILE"
sed -i 's/DAT_180a02080/system_cleanup_cache_ptr/g' "$FILE"
sed -i 's/UNK_180a25e58/system_sync_cache_ptr/g' "$FILE"
sed -i 's/UNK_180a25e70/system_performance_cache_ptr/g' "$FILE"
sed -i 's/UNK_180a25e80/system_error_cache_ptr/g' "$FILE"
sed -i 's/UNK_180a25e90/system_context_cache_ptr/g' "$FILE"
sed -i 's/UNK_180a25ebc/system_version_cache_ptr/g' "$FILE"
sed -i 's/UNK_180a25ec4/system_engine_cache_ptr/g' "$FILE"
sed -i 's/UNK_180a25ed0/system_platform_cache_ptr/g' "$FILE"
sed -i 's/UNK_180a25ee0/system_device_cache_ptr/g' "$FILE"
sed -i 's/UNK_180a25ef0/system_resource_buffer_ptr/g' "$FILE"
sed -i 's/UNK_180a25ef8/system_memory_buffer_ptr/g' "$FILE"
sed -i 's/UNK_180a25900/system_thread_buffer_ptr/g' "$FILE"
sed -i 's/UNK_180a25ad0/system_config_buffer_ptr/g' "$FILE"
sed -i 's/UNK_180a25a6c/system_module_buffer_ptr/g' "$FILE"

echo "文件美化完成"