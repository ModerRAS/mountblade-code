#!/usr/bin/env python3
# -*- coding: utf-8 -*-

"""
99_unmatched_functions.c 变量和函数名美化脚本
将未美化的变量名和函数名重命名为语义化名称
"""

import re

def beautify_99_unmatched_functions():
    """美化99_unmatched_functions.c文件中的变量名和函数名"""
    
    # 读取文件内容
    with open('/dev/shm/mountblade-code/TaleWorlds.Native/src/99_unmatched_functions.c', 'r', encoding='utf-8') as f:
        content = f.read()
    
    # 函数名映射表
    function_mappings = {
        'func_0x00018064e870': 'ProcessSystemException',
        'func_0x000180225d90': 'ConvertToIntegerValue',
        'func_0x0001800ab000': 'GetUnsignedIntegerValue',
        'func_0x0001800aada0': 'AllocateMemoryBuffer',
        'func_0x0001802a1d70': 'ValidateMemoryBuffer',
        'func_0x0001800adfc0': 'FreeMemoryBuffer',
        'func_0x0001800ab240': 'ProcessBufferData',
        'func_0x0001800ab380': 'CreateSystemHandle',
        'func_0x0001800ab2c0': 'InitializeSystemResource',
        'func_0x000180085de0': 'CreateSystemObject',
        'func_0x00018022d300': 'GetSystemStatus',
        'func_0x00018066bd70': 'ProcessSystemData',
        'func_0x000180220c90': 'ValidateSystemData',
        'func_0x00018066b9a0': 'FormatSystemData',
        'func_0x00018029db20': 'ProcessSystemMessage',
        'func_0x0001800e2bf0': 'CompareStringData',
        'func_0x0001800ed880': 'GetStringLength',
        'func_0x00018024c420': 'ParseStringData',
        'func_0x0001800858c0': 'CreateNetworkConnection',
        'func_0x0001800ae1f0': 'InitializeNetworkContext',
        'func_0x0001800ed840': 'ProcessNetworkRequest',
        'func_0x0001800e7950': 'ProcessNetworkEvent',
        'func_0x0001800da750': 'CompareCharacterData',
        'func_0x0001800ba3b0': 'ValidateCharacterData',
        'func_0x00018024c040': 'ProcessBufferData',
        'func_0x00018029dab0': 'ProcessSystemOperation',
        'func_0x0001800d4090': 'CompareMemoryData',
        'func_0x0001800d40c0': 'ProcessMemoryOperation',
        'func_0x00018005d390': 'CleanupSystemResource',
        'func_0x00018023a1e0': 'FormatDataOutput',
        'func_0x0001801c0ee0': 'ExecuteSystemCommand',
        'func_0x0001803b0980': 'InitializeSystemModule',
        'func_0x00018031cb70': 'ExecuteSystemTask',
        'func_0x0001801be7c0': 'ProcessArrayData',
        'func_0x0001801be740': 'ProcessSystemConfiguration',
        'func_0x0001801bb330': 'ProcessSystemRequest',
        'func_0x000180360380': 'GetSystemErrorCode',
        'func_0x0001802e1840': 'ProcessSystemCallback',
        'func_0x0001801be000': 'ValidateSystemParameter',
        'func_0x0001801bb270': 'ExecuteSystemOperation',
        'func_0x000180388c90': 'CreateSystemContext',
        'func_0x00018038d2f0': 'CalculateSystemValue',
        'func_0x0001801ece00': 'InitializeSystemService',
        'func_0x0001801eb6f0': 'ProcessSystemValidation',
        'func_0x000180079240': 'GetSystemInformation',
        'func_0x00018066c530': 'ProcessSystemFunction',
        'func_0x00018066d300': 'GetSystemConfiguration',
        'func_0x0001802eeba0': 'ExecuteSystemCleanup',
        'thunk_FUN_18064e900': 'SystemExceptionThunk',
        'thunk_FUN_1801be3b5': 'SystemOperationThunk'
    }
    
    # 变量名映射表
    variable_mappings = {
        'uVar1': 'UnsignedValue1',
        'uVar2': 'UnsignedValue2',
        'uVar3': 'UnsignedValue3',
        'uVar4': 'UnsignedValue4',
        'uVar5': 'UnsignedValue5',
        'uVar6': 'UnsignedValue6',
        'uVar7': 'UnsignedValue7',
        'uVar8': 'UnsignedValue8',
        'uVar9': 'UnsignedValue9',
        'uVar10': 'UnsignedValue10',
        'uVar11': 'UnsignedValue11',
        'uVar12': 'UnsignedValue12',
        'uVar13': 'UnsignedValue13',
        'uVar14': 'UnsignedValue14',
        'uVar15': 'UnsignedValue15',
        'uVar16': 'UnsignedValue16',
        'uVar17': 'UnsignedValue17',
        'uVar18': 'UnsignedValue18',
        'uVar19': 'UnsignedValue19',
        'uVar20': 'UnsignedValue20',
        'lVar1': 'LongValue1',
        'lVar2': 'LongValue2',
        'lVar3': 'LongValue3',
        'lVar4': 'LongValue4',
        'lVar5': 'LongValue5',
        'lVar6': 'LongValue6',
        'lVar7': 'LongValue7',
        'lVar8': 'LongValue8',
        'lVar9': 'LongValue9',
        'lVar10': 'LongValue10',
        'lVar11': 'LongValue11',
        'lVar12': 'LongValue12',
        'lVar13': 'LongValue13',
        'lVar14': 'LongValue14',
        'lVar15': 'LongValue15',
        'lVar16': 'LongValue16',
        'lVar17': 'LongValue17',
        'lVar18': 'LongValue18',
        'lVar19': 'LongValue19',
        'lVar20': 'LongValue20',
        'cVar1': 'CharValue1',
        'cVar2': 'CharValue2',
        'cVar3': 'CharValue3',
        'cVar4': 'CharValue4',
        'cVar5': 'CharValue5',
        'cVar6': 'CharValue6',
        'cVar7': 'CharValue7',
        'cVar8': 'CharValue8',
        'cVar9': 'CharValue9',
        'cVar10': 'CharValue10',
        'cVar11': 'CharValue11',
        'cVar12': 'CharValue12',
        'cVar13': 'CharValue13',
        'cVar14': 'CharValue14',
        'cVar15': 'CharValue15',
        'cVar16': 'CharValue16',
        'cVar17': 'CharValue17',
        'cVar18': 'CharValue18',
        'cVar19': 'CharValue19',
        'cVar20': 'CharValue20',
        'bVar1': 'BoolValue1',
        'bVar2': 'BoolValue2',
        'bVar3': 'BoolValue3',
        'bVar4': 'BoolValue4',
        'bVar5': 'BoolValue5',
        'fVar1': 'FloatValue1',
        'fVar2': 'FloatValue2',
        'fVar3': 'FloatValue3',
        'fVar4': 'FloatValue4',
        'fVar5': 'FloatValue5',
        'fVar6': 'FloatValue6',
        'fVar7': 'FloatValue7',
        'fVar8': 'FloatValue8',
        'fVar9': 'FloatValue9',
        'fVar10': 'FloatValue10',
        'puVar1': 'PointerUnsignedValue1',
        'puVar2': 'PointerUnsignedValue2',
        'puVar3': 'PointerUnsignedValue3',
        'puVar4': 'PointerUnsignedValue4',
        'puVar5': 'PointerUnsignedValue5',
        'puVar6': 'PointerUnsignedValue6',
        'puVar7': 'PointerUnsignedValue7',
        'puVar8': 'PointerUnsignedValue8',
        'puVar9': 'PointerUnsignedValue9',
        'puVar10': 'PointerUnsignedValue10',
        'plVar1': 'PointerLongValue1',
        'plVar2': 'PointerLongValue2',
        'plVar3': 'PointerLongValue3',
        'plVar4': 'PointerLongValue4',
        'plVar5': 'PointerLongValue5',
        'plVar6': 'PointerLongValue6',
        'plVar7': 'PointerLongValue7',
        'plVar8': 'PointerLongValue8',
        'plVar9': 'PointerLongValue9',
        'plVar10': 'PointerLongValue10',
        'param_1': 'Parameter1',
        'param_2': 'Parameter2',
        'param_3': 'Parameter3',
        'param_4': 'Parameter4',
        'param_5': 'Parameter5',
        'param_6': 'Parameter6',
        'in_stack_00000078': 'InputStackValue78',
        'unaff_R14': 'UnaffectedRegister14',
        'unaff_RBX': 'UnaffectedRegisterBX',
        'unaff_RSI': 'UnaffectedRegisterSI',
        'in_R10': 'InputRegister10',
        'lStackX_8': 'LocalStackX8',
        'stack0x00000040': 'StackValue40',
        'stack0x00000050': 'StackValue50',
        'stack0x00000030': 'StackValue30',
        'uStack0000000000000078': 'UnsignedStackValue78',
        'fStack_90': 'FloatStack90',
        'fStack_d8': 'FloatStackD8',
        'fStack_140': 'FloatStack140',
        'ArrayStack_128': 'ArrayStack128',
        'LongStack_e0': 'LongStackE0',
        'LongStack_110': 'LongStack110',
        'LongStack_80': 'LongStack80',
        'LongStack_b0': 'LongStackB0',
        'UnsignedStack_148': 'UnsignedStack148',
        'UnsignedStack_68': 'UnsignedStack68',
        'UnsignedStack_1d0': 'UnsignedStack1D0',
        'UnsignedStack_240': 'UnsignedStack240',
        'UnsignedStack_1e8': 'UnsignedStack1E8',
        'UnsignedStack_228': 'UnsignedStack228',
        'UnsignedStack_9a0': 'UnsignedStack9A0',
        'UnsignedStack_60': 'UnsignedStack60',
        'UnsignedStack_158': 'UnsignedStack158',
        'UnsignedStack_38': 'UnsignedStack38',
        'UnsignedStack_13c': 'UnsignedStack13C',
        'UnsignedStack_48': 'UnsignedStack48',
        'UnsignedStack_b8': 'UnsignedStackB8',
        'IntegerVariable1': 'IntegerValue1',
        'IntegerVariable2': 'IntegerValue2',
        'IntegerVariable3': 'IntegerValue3',
        'IntegerVariable4': 'IntegerValue4',
        'IntegerVariable5': 'IntegerValue5',
        'IntegerVariable6': 'IntegerValue6',
        'IntegerVariable7': 'IntegerValue7',
        'IntegerVariable8': 'IntegerValue8',
        'IntegerVariable9': 'IntegerValue9',
        'IntegerVariable10': 'IntegerValue10',
        'IntegerVariable11': 'IntegerValue11',
        'IntegerVariable12': 'IntegerValue12',
        'IntegerVariable13': 'IntegerValue13',
        'IntegerVariable14': 'IntegerValue14',
        'IntegerVariable15': 'IntegerValue15',
        'IntegerVariable16': 'IntegerValue16',
        'IntegerVariable17': 'IntegerValue17',
        'IntegerVariable18': 'IntegerValue18',
        'IntegerVariable19': 'IntegerValue19',
        'IntegerVariable20': 'IntegerValue20',
        'IntegerVariable22': 'IntegerValue22',
        'UnsignedStack_188': 'UnsignedStack188',
        'UnsignedStack_200': 'UnsignedStack200',
        'UnsignedStack_58': 'UnsignedStack58',
        'UnsignedStack_80': 'UnsignedStack80',
        'formatFlags': 'FormatFlags',
        'ExceptionList': 'ExceptionList',
        'CONCAT71': 'Concatenation71',
        '_DAT_180c86938': 'SystemDataTable180c86938',
        '_DAT_180c86890': 'SystemDataTable180c86890',
        'undefined1': 'UndefinedValue1',
        'undefined2': 'UndefinedValue2',
        'undefined3': 'UndefinedValue3',
        'undefined4': 'UndefinedValue4',
        'undefined8': 'UndefinedValue8',
        'undefined': 'UndefinedValue',
        'pppppppuVar7': 'PointerPointerPointerPointerPointerPointerPointerUnsignedValue7',
        'pppppppuVar4': 'PointerPointerPointerPointerPointerPointerPointerUnsignedValue4',
        'ppppppuVar7': 'PointerPointerPointerPointerPointerPointerUnsignedValue7',
        'pppuVar1': 'PointerPointerPointerUnsignedValue1',
        'ppuVar1': 'PointerPointerUnsignedValue1',
        'ppuVar2': 'PointerPointerUnsignedValue2',
        'ppuVar3': 'PointerPointerUnsignedValue3',
        'ppuVar4': 'PointerPointerUnsignedValue4',
        'ppuVar5': 'PointerPointerUnsignedValue5',
        'ppuVar6': 'PointerPointerUnsignedValue6',
        'ppuVar7': 'PointerPointerUnsignedValue7',
        'ppuVar8': 'PointerPointerUnsignedValue8',
        'ppuVar9': 'PointerPointerUnsignedValue9',
        'ppVar1': 'PointerPointerValue1',
        'ppVar2': 'PointerPointerValue2',
        'ppVar3': 'PointerPointerValue3',
        'ppVar4': 'PointerPointerValue4',
        'ppVar5': 'PointerPointerValue5',
        'ppVar6': 'PointerPointerValue6',
        'ppVar7': 'PointerPointerValue7',
        'ppVar8': 'PointerPointerValue8',
        'ppVar9': 'PointerPointerValue9',
        'ppVar10': 'PointerPointerValue10',
        'ppVar11': 'PointerPointerValue11',
        'pppVar1': 'PointerPointerPointerValue1',
        'pppVar2': 'PointerPointerPointerValue2',
        'pppVar3': 'PointerPointerPointerValue3',
        'pppVar4': 'PointerPointerPointerValue4',
        'pppVar5': 'PointerPointerPointerValue5',
        'pppVar6': 'PointerPointerPointerValue6',
        'pppVar7': 'PointerPointerPointerValue7',
        'pppVar8': 'PointerPointerPointerValue8',
        'pppVar9': 'PointerPointerPointerValue9',
        'ppppVar1': 'PointerPointerPointerPointerValue1',
        'ppppVar2': 'PointerPointerPointerPointerValue2',
        'ppppVar3': 'PointerPointerPointerPointerValue3',
        'ppppVar4': 'PointerPointerPointerPointerValue4',
        'ppppVar5': 'PointerPointerPointerPointerValue5',
        'ppppVar6': 'PointerPointerPointerPointerValue6',
        'ppppVar7': 'PointerPointerPointerPointerValue7',
        'ppppVar8': 'PointerPointerPointerPointerValue8',
        'ppppVar9': 'PointerPointerPointerPointerValue9',
        'pppppVar1': 'PointerPointerPointerPointerPointerValue1',
        'pppppVar2': 'PointerPointerPointerPointerPointerValue2',
        'pppppVar3': 'PointerPointerPointerPointerPointerValue3',
        'pppppVar4': 'PointerPointerPointerPointerPointerValue4',
        'pppppVar5': 'PointerPointerPointerPointerPointerValue5',
        'pppppVar6': 'PointerPointerPointerPointerPointerValue6',
        'pppppVar7': 'PointerPointerPointerPointerPointerValue7',
        'pppppVar8': 'PointerPointerPointerPointerPointerValue8',
        'pppppVar9': 'PointerPointerPointerPointerPointerValue9',
        'ppppppVar1': 'PointerPointerPointerPointerPointerPointerValue1',
        'ppppppVar2': 'PointerPointerPointerPointerPointerPointerValue2',
        'ppppppVar3': 'PointerPointerPointerPointerPointerPointerValue3',
        'ppppppVar4': 'PointerPointerPointerPointerPointerPointerValue4',
        'ppppppVar5': 'PointerPointerPointerPointerPointerPointerValue5',
        'ppppppVar6': 'PointerPointerPointerPointerPointerPointerValue6',
        'ppppppVar7': 'PointerPointerPointerPointerPointerPointerValue7',
        'ppppppVar8': 'PointerPointerPointerPointerPointerPointerValue8',
        'ppppppVar9': 'PointerPointerPointerPointerPointerPointerValue9',
        'pppppppVar1': 'PointerPointerPointerPointerPointerPointerPointerValue1',
        'pppppppVar2': 'PointerPointerPointerPointerPointerPointerPointerValue2',
        'pppppppVar3': 'PointerPointerPointerPointerPointerPointerPointerValue3',
        'pppppppVar4': 'PointerPointerPointerPointerPointerPointerPointerValue4',
        'pppppppVar5': 'PointerPointerPointerPointerPointerPointerPointerValue5',
        'pppppppVar6': 'PointerPointerPointerPointerPointerPointerPointerValue6',
        'pppppppVar7': 'PointerPointerPointerPointerPointerPointerPointerValue7',
        'pppppppVar8': 'PointerPointerPointerPointerPointerPointerPointerValue8',
        'pppppppVar9': 'PointerPointerPointerPointerPointerPointerPointerValue9',
        'ppppppppVar1': 'PointerPointerPointerPointerPointerPointerPointerPointerValue1',
        'ppppppppVar2': 'PointerPointerPointerPointerPointerPointerPointerPointerValue2',
        'ppppppppVar3': 'PointerPointerPointerPointerPointerPointerPointerPointerValue3',
        'ppppppppVar4': 'PointerPointerPointerPointerPointerPointerPointerPointerValue4',
        'ppppppppVar5': 'PointerPointerPointerPointerPointerPointerPointerPointerValue5',
        'ppppppppVar6': 'PointerPointerPointerPointerPointerPointerPointerPointerValue6',
        'ppppppppVar7': 'PointerPointerPointerPointerPointerPointerPointerPointerValue7',
        'ppppppppVar8': 'PointerPointerPointerPointerPointerPointerPointerPointerValue8',
        'ppppppppVar9': 'PointerPointerPointerPointerPointerPointerPointerPointerValue9'
    }
    
    # 应用函数名映射
    for old_name, new_name in function_mappings.items():
        # 使用正则表达式确保只匹配完整的函数名
        pattern = r'\b' + re.escape(old_name) + r'\b'
        content = re.sub(pattern, new_name, content)
    
    # 应用变量名映射
    for old_name, new_name in variable_mappings.items():
        # 使用正则表达式确保只匹配完整的变量名
        pattern = r'\b' + re.escape(old_name) + r'\b'
        content = re.sub(pattern, new_name, content)
    
    # 写回文件
    with open('/dev/shm/mountblade-code/TaleWorlds.Native/src/99_unmatched_functions.c', 'w', encoding='utf-8') as f:
        f.write(content)
    
    print("99_unmatched_functions.c 文件美化完成")

if __name__ == '__main__':
    beautify_99_unmatched_functions()