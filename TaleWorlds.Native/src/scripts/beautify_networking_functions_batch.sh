#!/bin/bash

# 批量替换05_networking.c文件中的FUN_函数名
# 这个脚本会根据注释中的映射关系来替换实际的函数名

# 定义函数映射关系
declare -A function_mapping=(
    ["FUN_180740b40"]="ProcessConnectionRequest"
    ["FUN_1808d71b0"]="ProcessPacket"
    ["FUN_1808c7d50"]="GetConnectionHandle"
    ["FUN_180861ef0"]="CloseConnection"
    ["FUN_180855467"]="ValidateBufferAccessEx"
    ["FUN_18085551e"]="InitializeContextArray"
    ["FUN_180855559"]="InitializePacketTransmitter"
    ["FUN_180856512"]="ConnectionPlaceholder"
    ["FUN_18085791f"]="NetworkStatusCheckPlaceholder"
    ["FUN_180857928"]="GetErrorCode"
    ["FUN_18085b050"]="ProcessPacketTransmission"
    ["FUN_18085d860"]="CreateConnectionContext"
    ["FUN_18085dd4b"]="ReleaseConnectionMemory"
    ["FUN_18085dd7c"]="CleanupNetworkSystemResources"
    ["FUN_18085dff0"]="DestroyConnection"
    ["FUN_18085f163"]="ValidateConnectionContext"
    ["FUN_18085f2d3"]="InitializeConnectionDataStructure"
    ["FUN_18085f812"]="ProcessConnectionStatusUpdate"
    ["FUN_18085f879"]="ConnectionStatusSync"
    ["FUN_18085f893"]="ResetConnectionState"
    ["FUN_180860170"]="ProcessConnectionAuthentication"
    ["FUN_180860210"]="GetConnectionPacketInfo"
    ["FUN_180860690"]="ProcessConnectionHandler"
    ["FUN_180860737"]="ProcessConnectionStateHandler"
    ["FUN_1808616d8"]="ProcessDataTransferHandler"
    ["FUN_1808616f0"]="SetConnectionHandle"
    ["FUN_180861720"]="ProcessConnectionStatusData"
    ["FUN_180861820"]="FindAndProcessPacket"
    ["FUN_1808618d0"]="ValidatePacketSize"
    ["FUN_180861900"]="SetConnectionDataParameters"
    ["FUN_180861970"]="ProcessConnectionContext"
    ["FUN_1808619a0"]="ProcessConnectionDataTransfer"
    ["FUN_1808619d0"]="GetConnectionContextData"
    ["FUN_180861a00"]="ProcessConnectionPacket"
    ["FUN_180861aa8"]="CheckConnectionIntegrity"
    ["FUN_180861b0c"]="ValidateConnectionContextState"
    ["FUN_180861b29"]="CheckConnectionStateIntegrity"
    ["FUN_180861cc6"]="ConnectionPlaceholder1"
    ["FUN_180861ccb"]="ConnectionPlaceholder2"
    ["FUN_180861cd0"]="ConnectionPlaceholder3"
    ["FUN_180861d0b"]="InitializeConnectionDataCopy"
    ["FUN_180861d76"]="ProcessConnectionDataCopy"
    ["FUN_180861d98"]="ProcessConnectionPacketTransfer"
    ["FUN_180861fdf"]="ProcessDataTransfer"
    ["FUN_18086226d"]="ProcessConnectionStatusFlags"
    ["FUN_180862670"]="CheckConnectionSecurityStatus"
    ["FUN_180862910"]="ProcessConnectionStateUpdate"
    ["FUN_1808629e9"]="CleanupConnectionResources"
    ["FUN_180862ad1"]="ValidateConnectionParameters"
    ["FUN_180862b96"]="InitializeConnectionProtocol"
    ["FUN_180862bc0"]="ProcessConnectionProtocol"
    ["FUN_180862c50"]="ProcessConnectionProtocolData"
    ["FUN_180862d17"]="InitializeSecurityContext"
    ["FUN_180862d20"]="ProcessSecurityContext"
    ["FUN_180862d70"]="ProcessPacketTransfer"
    ["FUN_180862e90"]="ValidateConnectionPacket"
    ["FUN_180863140"]="ProcessConnectionDataTransferOperation"
    ["FUN_180863180"]="ProcessConnectionPacketOperation"
    ["FUN_180863420"]="ValidateConnectionIntegrity"
    ["FUN_180863430"]="ProcessConnectionLifecycle"
    ["FUN_1808637ae"]="CheckConnectionStatusAndUpdate"
    ["FUN_180863820"]="HandleConnectionDataTransfer"
    ["FUN_180863930"]="ProcessConnectionOperation"
    ["FUN_1808639e2"]="CleanupConnectionBuffers"
    ["FUN_180863a57"]="ReleaseConnectionResources"
    ["FUN_180863aa3"]="ValidateConnectionState"
    ["FUN_180863bf7"]="SetupConnectionParameters"
    ["FUN_180863c00"]="SetupPacketBuffer"
    ["FUN_180863d75"]="UpdateConnectionStatus"
    ["FUN_180863d92"]="InitializeConnectionStackBuffer"
    ["FUN_180863f57"]="ValidateConnectionContext"
    ["FUN_180864040"]="ProcessConnectionStateMachine"
    ["FUN_1808640c7"]="ProcessConnectionContextState"
    ["FUN_18086463a"]="GetConnectionStatus"
    ["FUN_180865027"]="ProcessNetworkFloatParameter"
    ["FUN_180865286"]="ProcessConnectionStateSync"
    ["FUN_1808652fd"]="ValidateConnectionParameters"
    ["FUN_18086547c"]="ProcessConnectionPool"
    ["FUN_1808654be"]="GetConnectionPoolStatus"
    ["FUN_18086551b"]="ValidateConnectionPool"
    ["FUN_180865541"]="ProcessConnectionHandle"
    ["FUN_1808655bb"]="GetConnectionHandleStatus"
    ["FUN_1808657eb"]="NetworkSystemNoOperation"
    ["FUN_180865800"]="ProcessPacketData"
    ["FUN_180865a0f"]="ResetNetworkSystemState"
    ["FUN_180865a20"]="InitializeConnectionBuffer"
    ["FUN_180866a90"]="TraverseConnectionContext"
    ["FUN_180866ba0"]="ProcessPacketRegistration"
    ["FUN_180866c90"]="InitializeConnectionContext"
    ["FUN_180866d00"]="ProcessConnectionStateManagement"
    ["FUN_180866e25"]="InitializeConnectionProcessor"
    ["FUN_180866e97"]="SetConnectionParameters"
    ["FUN_180866fe0"]="ProcessConnectionDataTransferOperation"
    ["FUN_180867092"]="InitializeNetworkAddressBuffer"
    ["FUN_180867111"]="ValidateConnectionParameterStatus"
    ["FUN_1808672e4"]="CleanupConnectionResources"
    ["FUN_18086735a"]="NetworkSystemNoOperation"
    ["FUN_180867470"]="ProcessConnectionDataCopy"
    ["FUN_1808674e0"]="ProcessConnectionPacketData"
    ["FUN_180867600"]="InitializeConnectionData"
    ["FUN_180867714"]="ValidateConnectionHandle"
    ["FUN_1808677fa"]="GetConnectionDefaultStatus"
    ["FUN_180867810"]="ValidateConnectionPacketData"
    ["FUN_1808678e0"]="FindAndSendMatchingData"
    ["FUN_180867990"]="ManageConnectionData"
    ["FUN_180867f80"]="ProcessConnectionDataTransferOperation"
    ["FUN_1808681d0"]="ValidateConnectionData"
    ["FUN_180868363"]="ProcessPacketArray"
    ["FUN_180868459"]="CleanupSecurityGuardFourthInstance"
    ["FUN_180868490"]="InitializeConnectionData"
    ["FUN_1808686a0"]="ProcessDataStreamHighPriority"
    ["FUN_180868700"]="ReallocateConnectionData"
    ["FUN_180868724"]="GetConnectionStatusCode"
    ["FUN_1808687df"]="GetConnectionDefaultIdentifier"
    ["FUN_180868800"]="ProcessConnectionDataTransfer"
    ["FUN_1808689a5"]="ProcessConnectionHandleInitialization"
    ["FUN_1808689f2"]="GetConnectionStatusConstant"
    ["FUN_180868a00"]="ProcessConnectionPacketTransfer"
    ["FUN_180868a33"]="InitializeConnectionResources"
    ["FUN_180868a47"]="BatchInitializeNetworkResources"
    ["FUN_180868a67"]="ResetConnectionState"
    ["FUN_180868a6c"]="SetConnectionStatusFlag"
    ["FUN_180868a80"]="ProcessConnectionParameterValidation"
    ["FUN_180868fc0"]="ExecuteConnectionOperation"
    ["FUN_180869020"]="ProcessConnectionPoolIterator"
    ["FUN_180869080"]="ProcessConnectionPoolIteration"
    ["FUN_1808690e0"]="ProcessConnectionContextHandler"
    ["FUN_180869400"]="ProcessConnectionContextTertiaryHandler"
    ["FUN_180869590"]="ProcessConnectionDataHandler"
    ["FUN_180869720"]="ProcessConnectionDataTransmitter"
    ["FUN_180869ab0"]="ProcessConnectionPacketTransfer"
    ["FUN_180869b10"]="ManageConnectionDataSorting"
    ["FUN_180869b4f"]="CleanupConnectionArray"
    ["FUN_180869b6c"]="InitializeConnectionParameters"
    ["FUN_180869cdf"]="CleanupSecurityGuardFirstInstance"
    ["FUN_180869cee"]="CleanupSecurityGuardSecondInstance"
    ["FUN_180869d10"]="ProcessConnectionDataValidation"
    ["FUN_180869d52"]="InitializeConnectionStateManager"
    ["FUN_180869d6f"]="ProcessConnectionStateUpdate"
    ["FUN_180869edf"]="CleanupSecurityGuardThirdInstance"
    ["FUN_180869f10"]="ProcessConnectionPacketTransmission"
    ["FUN_180869f52"]="ResetConnectionStatusFlags"
    ["FUN_180869f6f"]="InitializeConnectionErrorHandler"
    ["FUN_18086a0df"]="SecurityCleanup"
    ["FUN_18086a0ee"]="ResetSecurityGuardSecondInstance"
    ["FUN_18086a110"]="ProcessConnectionPacketValidation"
    ["FUN_18086a2df"]="ResetSecurityGuardThirdInstance"
    ["FUN_18086a2ee"]="InitializeNetworkSystemResources"
    ["FUN_18086a310"]="ProcessConnectionDataTransferOperation"
    ["FUN_18086a34f"]="CleanupConnectionArray"
    ["FUN_18086a36c"]="ResetConnectionState"
    ["FUN_18086a4df"]="CleanupSecurityGuardFirstInstance"
    ["FUN_18086a4ee"]="CleanupSecurityGuardSecondInstance"
    ["FUN_18086a510"]="ProcessConnectionPacketValidation"
    ["FUN_18086a552"]="ConnectionCleanup"
    ["FUN_18086a56f"]="SecurityGuardReset"
    ["FUN_18086a6df"]="InitializeConnectionPoolResources"
    ["FUN_18086a6ee"]="CleanupConnectionPoolResources"
    ["FUN_18086a710"]="ConnectionValidate"
    ["FUN_18086a94f"]="ValidateDataIntegrityChecker"
    ["FUN_18086a96c"]="CleanupDataBufferEx"
    ["FUN_18086aadf"]="InitializeSecuritySystemEx"
    ["FUN_18086aaee"]="ResetSecurityContextEx"
    ["FUN_18086ab10"]="ProcessSecurityPacketEx"
    ["FUN_18086ab52"]="ProcessSecurityContextValidation"
    ["FUN_18086ab6c"]="CleanupSecurityContextEx"
    ["FUN_18086acbc"]="InitializeEncryptionEx"
    ["FUN_18086accb"]="ProcessEncryptionEx"
    ["FUN_18086acf0"]="ValidateEncryptionEx"
    ["FUN_18086ad32"]="ValidateSecurityPacketEx"
    ["FUN_18086ad4c"]="ProcessEncryptionContextEx"
    ["FUN_18086ae9c"]="AnalyzeNetworkPerformanceMetrics"
    ["FUN_18086aeab"]="GenerateNetworkPerformanceAnalysis"
    ["FUN_18086aed0"]="OptimizeNetworkPerformance"
    ["FUN_18086af12"]="HandleErrorProcessing"
    ["FUN_18086af2f"]="LogErrorDetails"
    ["FUN_18086b4b0"]="ProcessPacketArray"
    ["FUN_18086b50c"]="ValidateConnectionStatus"
    ["FUN_18086b67f"]="InitializeConnectionManager"
    ["FUN_18086b68e"]="CleanupSecurityGuard"
    ["FUN_18086b6b0"]="ProcessConnectionContext"
    ["FUN_18086b6f2"]="ResetConnectionState"
    ["FUN_18086b70f"]="InitializeConnectionHandler"
    ["FUN_18086b87f"]="CleanupConnectionBuffers"
    ["FUN_18086b88e"]="ReleaseConnectionResources"
    ["FUN_18086b8b0"]="ValidateConnectionIntegrity"
    ["FUN_18086ba5c"]="MonitorConnectionStatus"
    ["FUN_18086ba6b"]="MonitorConnectionPerformance"
    ["FUN_18086bc90"]="ProcessConnectionPacketValidation"
    ["FUN_18086bccf"]="InitializeConnectionDataCleanup"
    ["FUN_18086bcec"]="ProcessConnectionErrorState"
    ["FUN_18086be5f"]="CleanupSecurityGuardSimple"
    ["FUN_18086be6e"]="CleanupSecurityGuardBasic"
    ["FUN_18086be90"]="ProcessConnectionDataTransfer"
    ["FUN_18086bed2"]="InitializeConnectionStateManager"
    ["FUN_18086beef"]="ResetConnectionStateManager"
    ["FUN_18086c05f"]="CleanupSecurityGuardWithStack"
    ["FUN_18086c06e"]="ResetSecurityGuardWithStack"
    ["FUN_18086c090"]="ProcessConnectionSecurityValidation"
    ["FUN_18086c0d2"]="ProcessConnectionDataHandler"
    ["FUN_18086c0ef"]="InitializeConnectionHandler"
    ["FUN_18086c25f"]="CleanupConnectionHandler"
    ["FUN_18086c26e"]="ResetConnectionHandler"
    ["FUN_18086c4cf"]="CleanupConnectionResources"
    ["FUN_18086c63f"]="CleanupSecurityContext"
    ["FUN_18086c64e"]="ResetConnectionStatus"
    ["FUN_18086c670"]="ProcessConnectionContext"
    ["FUN_18086c6b2"]="InitializeConnectionPool"
    ["FUN_18086c6cf"]="ProcessConnectionEntrySorting"
    ["FUN_18086c83f"]="SecurityGuardCleanupSimple"
    ["FUN_18086c84e"]="SecurityGuardCleanupBasic"
    ["FUN_18086c870"]="ProcessPacketTransferEx"
    ["FUN_18086c8b2"]="ResetConnectionStateFlags"
    ["FUN_18086c8cf"]="InitializeConnectionProcessor"
    ["FUN_18086ca3f"]="ValidateConnectionParameters"
    ["FUN_18086ca4e"]="ProcessConnectionStateUpdate"
    ["FUN_18086ca70"]="ProcessConnectionDataValidation"
    ["FUN_18086cab2"]="CleanupConnectionBuffers"
    ["FUN_18086cacf"]="ResetConnectionProcessor"
    ["FUN_18086cc3f"]="ValidateConnectionIntegrity"
    ["FUN_18086cc4e"]="InitializeConnectionPool"
    ["FUN_18086cc70"]="ProcessConnectionDataTransfer"
    ["FUN_18086ccaf"]="ReleaseConnectionResources"
    ["FUN_18086cccc"]="ValidateConnectionState"
    ["FUN_18086ce3f"]="SetConnectionParameters"
    ["FUN_18086d070"]="ProcessConnectionContextHandler"
    ["FUN_18086d0b2"]="ResetConnectionContextHandler"
    ["FUN_18086d0cf"]="CleanupConnectionEntryArray"
    ["FUN_18086d23f"]="CleanupSecurityGuardFifthInstance"
    ["FUN_18086d24e"]="CleanupSecurityGuardSixthInstance"
    ["FUN_18086d270"]="ProcessConnectionPacketTransferSecondInstance"
    ["FUN_18086d2af"]="ProcessConnectionDataTransferThirdInstance"
    ["FUN_18086d2cc"]="ProcessConnectionDataTransferFourthInstance"
    ["FUN_18086d43f"]="SecurityGuardCleanup_001"
    ["FUN_18086d44e"]="SecurityGuardCleanup_002"
    ["FUN_18086d470"]="ProcessConnectionDataTransfer"
    ["FUN_18086d620"]="ProcessConnectionDataTransferExtended"
    ["FUN_18086daa2"]="FindConnectionIndex"
    ["FUN_18086dc50"]="ProcessConnectionDataQueue"
    ["FUN_18086ddc0"]="ProcessConnectionContextEx"
    ["FUN_18086ddc8"]="ProcessConnectionContextAlt"
    ["FUN_18086df30"]="ProcessConnectionDataWithSize"
    ["FUN_18086e090"]="ValidateConnectionPacket"
    ["FUN_18086e330"]="HandleConnectionTransfer"
    ["FUN_18086e5c0"]="ProcessConnectionStream"
    ["FUN_18086e710"]="HandleConnectionContextData"
    ["FUN_18086e860"]="ProcessConnectionContextFinal"
    ["FUN_18086eb00"]="InitializePacketIterator"
    ["FUN_18086ec60"]="ValidateAndCleanupPacket"
    ["FUN_18086eda0"]="ProcessContextDataPrimary"
    ["FUN_18086f040"]="ProcessConnectionStatusUpdate"
    ["FUN_18086f1a0"]="ProcessPacketTransmission"
    ["FUN_18086f460"]="ProcessConnectionDataStream"
    ["FUN_18086f4ed"]="InitializeConnectionManager"
    ["FUN_18086f5fd"]="NetworkOperationIdleHandler"
    ["FUN_18086f69d"]="ConnectionStatusValidator"
    ["FUN_18086f793"]="OperationStatusChecker"
    ["FUN_18086f7c0"]="ClearDataSizeBuffer"
    ["FUN_18086f8b0"]="ProcessDataStreamEx"
    ["FUN_18086f9a0"]="ProcessDataTransmission"
    ["FUN_18086fa90"]="ProcessPacketStream"
    ["FUN_18086fb80"]="ProcessDataQueue"
    ["FUN_18086fc70"]="ProcessDataBuffer"
    ["FUN_180870210"]="ClearDataBufferFirstInstance"
    ["FUN_180870310"]="ClearDataBufferSecondInstance"
    ["FUN_180870410"]="ClearDataBufferThirdInstance"
    ["FUN_180870500"]="ClearDataBufferFirstInstance"
    ["FUN_1808705f0"]="ClearDataBufferSecondInstance"
    ["FUN_1808706e0"]="ClearDataBufferThirdInstance"
    ["FUN_1808707d0"]="ClearDataSizeBufferSeventhInstance"
    ["FUN_1808708c0"]="ClearDataSizeBufferEighthInstance"
    ["FUN_1808709b0"]="ClearDataSizeBuffer"
    ["FUN_180870aa0"]="ResetDataSizeBuffer"
    ["FUN_180870b90"]="ZeroDataSizeBuffer"
    ["FUN_180870c80"]="InitializeDataSizeBuffer"
    ["FUN_180870d70"]="PurgeDataSizeBuffer"
    ["FUN_180870e60"]="FlushDataSizeBuffer"
    ["FUN_180870f50"]="SanitizeDataSizeBuffer"
    ["FUN_180871040"]="ClearDataBufferFourthInstance"
    ["FUN_180871130"]="ClearDataBufferFifthInstance"
    ["FUN_1808719a0"]="InitializeContextArray"
    ["FUN_1808723c0"]="CleanupConnectionStatusType2"
    ["FUN_180872480"]="CleanupConnectionStatusType3"
    ["FUN_180872630"]="ValidateConnectionStateAndReturnHandle"
    ["FUN_180872cc0"]="InitializeConnectionContextState"
    ["FUN_180872ef0"]="ResetConnectionContextState"
    ["FUN_180872f02"]="ProcessPacketTransmission"
    ["FUN_180872f0b"]="ProcessPacketTransmissionSecondInstance"
    ["FUN_18087304a"]="CleanupConnectionContextData"
    ["FUN_18087306d"]="CleanupConnectionContextDataAlternate"
    ["FUN_18087309b"]="ProcessPacketCleanup"
    ["FUN_1808732fb"]="CleanupConnectionStatusData"
    ["FUN_1808733a0"]="CleanupConnectionStatusType4"
    ["FUN_180873cd0"]="InitializeConnectionState"
    ["FUN_180873ec0"]="SetConnectionContextWithRelease"
    ["FUN_180873ef0"]="SetConnectionContextWithSizedRelease"
    ["FUN_180873f20"]="SetConnectionContextWith16ByteRelease"
    ["FUN_180873f80"]="ProcessConnectionDataTransfer"
    ["FUN_1808740c0"]="ProcessPacketIndexValidation"
    ["FUN_180874340"]="ValidateConnectionContextSecurity"
    ["FUN_18087439e"]="InitializeConnectionContextManager"
    ["FUN_18087446c"]="GetConnectionDataSize"
    ["FUN_18087447c"]="ProcessConnectionContextCleanup"
    ["FUN_1808744c7"]="AllocateConnectionMemory"
    ["FUN_1808746d5"]="InitializeConnectionDataStructure"
    ["FUN_18087471e"]="ValidateConnectionState"
    ["FUN_180874760"]="ReleaseConnectionContextResources"
    ["FUN_180874980"]="ProcessNetworkStatusUpdate"
    ["FUN_180874afe"]="CleanupNetworkResourceFinal"
    ["FUN_1808753b5"]="NetworkSystemNoOperationFirstInstance"
    ["FUN_1808753c6"]="GetConnectionConstantValue"
    ["FUN_1808753d0"]="HandleConnectionEvent"
    ["FUN_180875569"]="EstablishConnection"
    ["FUN_1808757c0"]="NetworkSystemNoOperationSecondInstance"
    ["FUN_1808757cc"]="SetConnectionArrayIndex"
    ["FUN_180875d28"]="ValidateConnectionStatus"
    ["FUN_180875fa1"]="ResetConnectionState"
    ["FUN_180875fc0"]="ValidatePacketIntegrity"
    ["FUN_180876026"]="InitializeConnectionProcessor"
    ["FUN_18087615c"]="GetConnectionErrorCode"
    ["FUN_180876180"]="ProcessPacketFilter"
)

# 备份原文件
cp 05_networking.c 05_networking.c.backup

# 执行替换
for old_name in "${!function_mapping[@]}"; do
    new_name="${function_mapping[$old_name]}"
    echo "替换 $old_name 为 $new_name"
    sed -i "s/$old_name/$new_name/g" 05_networking.c
done

echo "批量替换完成"