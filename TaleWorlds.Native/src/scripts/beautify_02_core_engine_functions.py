#!/usr/bin/env python3
"""
批量处理02_core_engine.c文件中的FUN_函数重命名
"""

import re
import os

def process_function_renames():
    """处理函数重命名"""
    
    # 读取文件内容
    with open('/dev/shm/mountblade-code/TaleWorlds.Native/src/02_core_engine.c', 'r', encoding='utf-8') as f:
        content = f.read()
    
    # 定义函数重命名映射
    function_renames = {
        'FUN_180059000': 'ProcessTargetDataStructure',
        'FUN_1800591c0': 'InitializeDataStructure', 
        'FUN_180059230': 'CopyDataStructureWithParameters',
        'FUN_1800592e4': 'NoOperationFunction',
        'FUN_180059350': 'MoveMemoryDataBlock',
        'FUN_180059380': 'ProcessMemoryDataPointer',
        'FUN_1800594b0': 'InitializeMemoryBuffer',
        'FUN_1800595c0': 'ProcessMemoryAllocation',
        'FUN_180059620': 'HandleMemoryManagement',
        'FUN_180059640': 'ExecuteMemoryOperations',
        'FUN_180059bc0': 'ProcessSystemInitialization',
        'FUN_180060420': 'HandleDataBufferOperations',
        'FUN_180061f80': 'ExecuteSystemCleanup',
        'FUN_1800622d0': 'ProcessSystemConfiguration',
        'FUN_180062300': 'HandleSystemDataTransfer',
        'FUN_180062340': 'ExecuteSystemValidation',
        'FUN_180062380': 'ProcessSystemEvents',
        'FUN_1800623b0': 'HandleSystemResources',
        'FUN_1800623e0': 'ManageSystemMemory',
        'FUN_180064c00': 'ProcessDataStructures',
        'FUN_180065160': 'InitializeSystemComponents',
        'FUN_180065d50': 'ExecuteSystemTasks',
        'FUN_180065f00': 'HandleSystemOperations',
        'FUN_180066140': 'ProcessSystemData',
        'FUN_180066320': 'InitializeCoreEngine',
        'FUN_1800669c0': 'ValidateSystemConfiguration',
        'FUN_180067050': 'HandleSystemExceptions',
        'FUN_18006720b': 'ProcessMemoryAlignment',
        'FUN_18006729a': 'ExecuteSystemFinalization',
        'FUN_1800672b0': 'HandleSystemShutdown',
        'FUN_1800672b7': 'ProcessSystemTermination',
        'FUN_180069280': 'ExecuteDataTransfer',
        'FUN_1800693f0': 'ProcessSystemDataCopy',
        'FUN_180069530': 'HandleMemoryOperations',
        'FUN_1800695a0': 'ProcessSystemInitialization',
        'FUN_1800697a0': 'ExecuteSystemFunctions',
        'FUN_180072000': 'HandleSystemDataProcessing',
        'FUN_180072e80': 'ProcessSystemEvents',
        'FUN_180073630': 'ExecuteSystemOperations',
        'FUN_180073730': 'HandleSystemData',
        'FUN_180073830': 'ProcessSystemValidation',
        'FUN_1800739f0': 'InitializeSystemResources',
        'FUN_180073ab0': 'HandleSystemMemory',
        'FUN_180073ad0': 'ProcessSystemData',
        'FUN_180073adc': 'ExecuteSystemTasks',
        'FUN_180073b64': 'HandleSystemOperations',
        'FUN_180073e0b': 'ProcessSystemValidation',
        'FUN_180073e23': 'ExecuteSystemCleanup',
        'FUN_180073f90': 'HandleSystemInitialization',
        'FUN_180074090': 'ProcessSystemData',
        'FUN_1800740a2': 'HandleSystemMemory',
        'FUN_1800740f5': 'ExecuteSystemOperations',
        'FUN_1800742ea': 'ProcessSystemValidation',
        'FUN_180074309': 'HandleSystemCleanup',
        'FUN_1800744b0': 'ProcessSystemData',
        'FUN_1800746c0': 'ExecuteSystemFunctions',
        'FUN_180074840': 'HandleSystemOperations',
        'FUN_1800748d0': 'ProcessSystemData',
        'FUN_180074a80': 'ExecuteSystemTasks',
        'FUN_180074b30': 'HandleSystemMemory',
        'FUN_180074c20': 'ProcessSystemValidation',
        'FUN_180074ed0': 'InitializeSystemResources',
        'FUN_180075630': 'HandleSystemData',
        'FUN_1800756e0': 'ExecuteSystemOperations',
        'FUN_180075990': 'ProcessSystemValidation',
        'FUN_180075ff0': 'HandleSystemMemory',
        'FUN_180076760': 'ProcessSystemData',
        'FUN_180076910': 'ExecuteSystemFunctions',
        'FUN_180076a20': 'HandleSystemOperations',
        'FUN_180076a80': 'ProcessSystemValidation',
        'FUN_180077020': 'InitializeSystemResources',
        'FUN_180077150': 'HandleSystemMemory',
        'FUN_180077710': 'ProcessSystemData',
        'FUN_180077ad8': 'ExecuteSystemCleanup',
        'FUN_180077c96': 'HandleSystemInitialization',
        'FUN_180077dc6': 'ProcessSystemEvents',
        'FUN_180077dec': 'ExecuteSystemOperations',
        'FUN_180078051': 'HandleSystemData',
        'FUN_180078143': 'ProcessSystemValidation',
        'FUN_1800781e0': 'HandleSystemMemory',
        'FUN_1800781f4': 'ExecuteSystemFunctions',
        'FUN_180078239': 'ProcessSystemOperations',
        'FUN_1800782a8': 'HandleSystemValidation',
        'FUN_1800783b0': 'InitializeSystemResources',
        'FUN_180078550': 'HandleSystemData',
        'FUN_1800786e0': 'ExecuteSystemOperations',
        'FUN_180078c10': 'ProcessSystemValidation',
        'FUN_180078c70': 'HandleSystemMemory',
        'FUN_1800791a0': 'ProcessSystemData',
        'FUN_180079270': 'ExecuteSystemFunctions',
        'FUN_180079284': 'HandleSystemOperations',
        'FUN_1800792ea': 'ProcessSystemValidation',
        'FUN_180079309': 'InitializeSystemResources',
        'FUN_18007940e': 'HandleSystemMemory',
        'FUN_180079520': 'ProcessSystemData',
        'FUN_18007959e': 'ExecuteSystemCleanup',
        'FUN_180080060': 'HandleSystemInitialization',
        'FUN_1800802e0': 'ProcessSystemEvents',
        'FUN_1800805d0': 'ExecuteSystemOperations',
        'FUN_1800805f0': 'HandleSystemData',
        'FUN_180080610': 'ProcessSystemValidation',
        'FUN_180080650': 'HandleSystemMemory',
        'FUN_1800806e0': 'ProcessSystemData',
        'FUN_180080779': 'ExecuteSystemFunctions',
        'FUN_1800807f5': 'HandleSystemOperations',
        'FUN_180080870': 'ProcessSystemValidation',
        'FUN_1800809a0': 'InitializeSystemResources',
        'FUN_180080aa0': 'HandleSystemMemory',
        'FUN_180080ae6': 'ProcessSystemData',
        'FUN_180080b98': 'ExecuteSystemCleanup',
        'FUN_180080be0': 'HandleSystemInitialization',
        'FUN_180080c10': 'ProcessSystemEvents',
        'FUN_180080ca0': 'ExecuteSystemOperations',
        'FUN_180080ccb': 'HandleSystemData',
        'FUN_180080da6': 'ProcessSystemValidation',
        'FUN_180080dd9': 'HandleSystemMemory',
        'FUN_180080df0': 'ProcessSystemData',
        'FUN_180080e90': 'ExecuteSystemFunctions',
        'FUN_180080fa0': 'HandleSystemOperations',
        'FUN_180081010': 'ProcessSystemValidation',
        'FUN_1800810b0': 'InitializeSystemResources',
        'FUN_180081220': 'HandleSystemMemory',
        'FUN_180081350': 'ProcessSystemData',
        'FUN_180081480': 'ExecuteSystemFunctions',
        'FUN_180081590': 'HandleSystemOperations',
        'FUN_1800816c0': 'ProcessSystemValidation',
        'FUN_180081870': 'InitializeSystemResources',
        'FUN_180081a20': 'HandleSystemMemory',
        'FUN_180081bd0': 'ProcessSystemData',
        'FUN_180081d80': 'ExecuteSystemFunctions',
        'FUN_180081f30': 'HandleSystemOperations',
        'FUN_1800820e0': 'ProcessSystemValidation',
        'FUN_180082290': 'InitializeSystemResources',
        'FUN_1800824a0': 'HandleSystemMemory',
        'FUN_1800826b0': 'ProcessSystemData',
        'FUN_180082880': 'ExecuteSystemFunctions',
        'FUN_180082a50': 'HandleSystemOperations',
        'FUN_180082fd0': 'ProcessSystemValidation',
        'FUN_1800831c0': 'InitializeSystemResources',
        'FUN_1800834f0': 'HandleSystemMemory',
        'FUN_180083b20': 'ProcessSystemData',
        'FUN_180083e90': 'ExecuteSystemFunctions',
        'FUN_180083f10': 'HandleSystemOperations',
        'FUN_180084000': 'ProcessSystemValidation',
        'FUN_180084736': 'InitializeSystemResources',
        'FUN_180084760': 'HandleSystemMemory',
        'FUN_180084ae0': 'ProcessSystemData',
        'FUN_180084c70': 'ExecuteSystemFunctions',
        'FUN_180085190': 'HandleSystemOperations',
        'FUN_18008520c': 'ProcessSystemValidation',
        'FUN_1800853fd': 'InitializeSystemResources',
        'FUN_180085530': 'HandleSystemMemory',
        'FUN_180085680': 'ProcessSystemData',
        'FUN_1800856c7': 'ExecuteSystemCleanup',
        'FUN_180085714': 'HandleSystemInitialization',
        'FUN_180085826': 'ProcessSystemEvents',
        'FUN_180085970': 'ExecuteSystemOperations',
        'FUN_180085ac0': 'HandleSystemData',
        'FUN_180085c10': 'ProcessSystemValidation',
        'FUN_180085e30': 'HandleSystemMemory',
        'FUN_180085e55': 'ProcessSystemData',
        'FUN_180085ec0': 'ExecuteSystemFunctions',
        'FUN_180085f20': 'HandleSystemOperations',
        'FUN_180085f45': 'ProcessSystemValidation',
        'FUN_180085f8b': 'InitializeSystemResources',
        'FUN_180085fb0': 'HandleSystemMemory',
        'FUN_180086010': 'ProcessSystemData',
        'FUN_180086031': 'ExecuteSystemCleanup',
        'FUN_180086073': 'HandleSystemInitialization',
        'FUN_180086090': 'ProcessSystemEvents',
        'FUN_1800860f0': 'ExecuteSystemOperations',
        'FUN_180086270': 'HandleSystemData',
        'FUN_1800862bb': 'ProcessSystemValidation',
        'FUN_180086bd0': 'InitializeSystemResources',
        'FUN_180086dc0': 'HandleSystemMemory',
        'FUN_180086de0': 'ProcessSystemData',
        'FUN_180086e10': 'ExecuteSystemFunctions',
        'FUN_180086e40': 'HandleSystemOperations',
        'FUN_180087630': 'ProcessSystemValidation',
        'FUN_180087700': 'InitializeSystemResources',
        'FUN_180088160': 'HandleSystemMemory',
        'FUN_1800893b0': 'ProcessSystemData',
        'FUN_180089420': 'ExecuteSystemCleanup',
        'FUN_180089640': 'HandleSystemInitialization',
        'FUN_1800896b0': 'ProcessSystemEvents',
        'FUN_18008a480': 'ExecuteSystemOperations',
        'FUN_18008a620': 'HandleSystemData',
        'FUN_18008b390': 'ProcessSystemValidation',
        'FUN_18008b690': 'InitializeSystemResources',
        'FUN_18008bb30': 'HandleSystemMemory',
        'FUN_18008bf00': 'ProcessSystemData',
        'FUN_18008bf40': 'ExecuteSystemFunctions',
        'FUN_18008c320': 'HandleSystemOperations',
        'FUN_18008d04c': 'ProcessSystemValidation',
        'FUN_18008d059': 'InitializeSystemResources',
        'FUN_18008d100': 'HandleSystemMemory',
        'FUN_18008d180': 'ProcessSystemData',
        'FUN_18008d1b0': 'ExecuteSystemCleanup',
        'FUN_18008d1f0': 'HandleSystemInitialization',
        'FUN_18008d3a0': 'ProcessSystemEvents',
        'FUN_18008d4c6': 'ExecuteSystemOperations',
        'FUN_18008d535': 'HandleSystemData',
        'FUN_18008d5a0': 'ProcessSystemValidation',
        'FUN_18008d710': 'InitializeSystemResources',
        'FUN_18008d810': 'HandleSystemMemory',
        'FUN_18008db2a': 'ProcessSystemData',
        'FUN_18008db97': 'ExecuteSystemFunctions',
        'FUN_18008dbb0': 'HandleSystemOperations',
        'FUN_18008dbfb': 'ProcessSystemValidation',
        'FUN_18008dcf9': 'InitializeSystemResources',
        'FUN_18008dd40': 'HandleSystemMemory',
        'FUN_18008dfa0': 'ProcessSystemData',
        'FUN_18008e0f0': 'ExecuteSystemFunctions',
        'FUN_18008e1a0': 'HandleSystemOperations',
        'FUN_18008e1c7': 'ProcessSystemValidation',
        'FUN_18008e454': 'InitializeSystemResources',
        'FUN_18008e460': 'HandleSystemMemory',
        'FUN_18008e473': 'ProcessSystemData',
        'FUN_18008e48b': 'ExecuteSystemCleanup',
        'FUN_18008e535': 'HandleSystemInitialization',
        'FUN_18008e544': 'ProcessSystemEvents',
        'FUN_18008e550': 'ExecuteSystemOperations',
        'FUN_18008e55f': 'HandleSystemData',
        'FUN_18008e573': 'ProcessSystemValidation',
        'FUN_18008e5e4': 'InitializeSystemResources',
        'FUN_18008e5ef': 'HandleSystemMemory',
        'FUN_18008e5f0': 'ProcessSystemData',
        'FUN_18008e640': 'ExecuteSystemFunctions',
        'FUN_18008e690': 'HandleSystemOperations',
        'FUN_18008ea80': 'ProcessSystemValidation',
        'FUN_18008eb40': 'InitializeSystemResources',
        'FUN_18008ece8': 'HandleSystemMemory',
        'FUN_18008ed49': 'ProcessSystemData',
        'FUN_18008edc0': 'ExecuteSystemFunctions',
        'FUN_18008edcf': 'HandleSystemOperations',
        'FUN_18008edf4': 'ProcessSystemValidation',
        'FUN_18008effc': 'InitializeSystemResources',
        'FUN_18008f00a': 'HandleSystemMemory',
        'FUN_18008f430': 'ProcessSystemData',
        'FUN_18008fa70': 'ExecuteSystemFunctions',
    }
    
    # 处理函数重命名
    for old_name, new_name in function_renames.items():
        # 替换函数声明中的注释
        pattern = f'// 函数: void {old_name}\\('
        replacement = f'// 函数已重命名: {old_name} -> {new_name}'
        content = re.sub(pattern, replacement, content)
        
        # 替换函数定义
        pattern = f'void {old_name}\\('
        replacement = f'void {new_name}('
        content = re.sub(pattern, replacement, content)
        
        # 替换函数调用
        pattern = f'{old_name}\\('
        replacement = f'{new_name}('
        content = re.sub(pattern, replacement, content)
    
    # 写回文件
    with open('/dev/shm/mountblade-code/TaleWorlds.Native/src/02_core_engine.c', 'w', encoding='utf-8') as f:
        f.write(content)
    
    print(f"已处理 {len(function_renames)} 个函数的重命名")

if __name__ == '__main__':
    process_function_renames()