#!/usr/bin/env python3
"""
美化05_networking.c文件中的func_0x函数调用
"""

import re
import sys

def beautify_networking_file():
    """美化networking文件中的函数调用"""
    
    # 读取文件
    with open('/dev/shm/mountblade-code/TaleWorlds.Native/src/05_networking.c', 'r', encoding='utf-8') as f:
        content = f.read()
    
    # 函数调用映射表
    function_mappings = {
        'func_0x000180242600': 'GetNetworkSystemStatus',
        'func_0x000180767970': 'InitializeNetworkCore',
        'func_0x000180772c00': 'SetupNetworkConnection',
        'func_0x00018084c030': 'GetNetworkContextPointer',
        'func_0x00018084dcc0': 'CalculateNetworkFloatValue',
        'func_0x00018084e700': 'ProcessNetworkErrorFlag',
        'func_0x000180851460': 'ValidateNetworkContext',
        'func_0x000180851e20': 'GetNetworkValidationResult',
        'func_0x000180853cc0': 'ProcessNetworkFloatParameter',
        'func_0x000180857b00': 'ValidateConnectionHandle',
        'func_0x00018085d7b0': 'GetNetworkConnectionState',
        'func_0x00018085eef0': 'ProcessNetworkContextEntry',
        'func_0x000180861a30': 'CheckNetworkStackStatus',
        'func_0x0001808661c0': 'ValidateNetworkConnection',
        'func_0x0001808661d0': 'CheckNetworkConnectionSecurity',
        'func_0x000180866330': 'ResetNetworkConnection',
        'func_0x000180866440': 'ProcessNetworkPacketData',
        'func_0x0001808664e0': 'ValidateNetworkPacket',
        'func_0x000180866480': 'ProcessNetworkStatus',
        'func_0x000180866b40': 'ProcessNetworkSecurityValidation',
        'func_0x000180867200': 'GetNetworkStatusCode',
        'func_0x000180867370': 'GetNetworkSecurityFlags',
        'func_0x000180867680': 'InitializeNetworkTimeout',
        'func_0x0001808676e0': 'ProcessNetworkStreamData',
        'func_0x000180867960': 'ValidateNetworkTimeout',
        'func_0x0001808671f0': 'ResetNetworkStream',
        'func_0x000180868fc0': 'ExecuteNetworkOperation',
        'func_0x000180869020': 'ProcessNetworkPoolIterator',
        'func_0x000180869080': 'IterateNetworkPool',
        'func_0x0001808690e0': 'HandleNetworkContext',
        'func_0x000180869400': 'ProcessNetworkContextTertiary',
        'func_0x000180869590': 'HandleNetworkData',
        'func_0x000180869720': 'TransmitNetworkData',
        'func_0x000180869ab0': 'TransferNetworkPacket',
        'func_0x000180869b10': 'SortNetworkData',
        'func_0x000180869b4f': 'CleanupNetworkArray',
        'func_0x000180869b6c': 'InitializeNetworkParameters',
        'func_0x000180869cdf': 'CleanupSecurityGuardFirst',
        'func_0x000180869cee': 'CleanupSecurityGuardSecond',
        'func_0x000180869d10': 'ValidateNetworkData',
        'func_0x000180869d52': 'InitializeNetworkStateManager',
        'func_0x000180869d6f': 'UpdateNetworkState',
        'func_0x000180869edf': 'CleanupSecurityGuardThird',
        'func_0x000180869eee': 'CleanupSecurityGuardThirdAlt',
        'func_0x000180869f10': 'TransmitNetworkPacketEx',
        'func_0x000180869f52': 'ResetNetworkStatusFlags',
        'func_0x000180869f6f': 'InitializeNetworkErrorHandler',
        'func_0x00018086a0df': 'CleanupNetworkSecurity',
        'func_0x00018086a0ee': 'ResetSecurityGuardSecond',
        'func_0x00018086a110': 'ValidateNetworkPacketEx',
        'func_0x00018086a2df': 'ResetSecurityGuardThird',
        'func_0x00018086a2ee': 'InitializeNetworkResources',
        'func_0x00018086a310': 'ProcessNetworkTransferOperation',
        'func_0x00018086a34f': 'CleanupNetworkArrayEx',
        'func_0x00018086a36c': 'ResetNetworkState',
        'func_0x00018086a4df': 'CleanupSecurityGuardFirstEx',
        'func_0x00018086a4ee': 'CleanupSecurityGuardSecondEx',
        'func_0x00018086a510': 'ValidateNetworkPacketExFinal',
        'func_0x00018086a552': 'CleanupNetworkConnection',
        'func_0x00018086a56f': 'ResetSecurityGuard',
        'func_0x00018086a6df': 'InitializeConnectionPool',
        'func_0x00018086a6ee': 'CleanupConnectionPool',
        'func_0x00018086a710': 'ValidateConnection',
        'func_0x00018086a94f': 'ValidateDataIntegrity',
        'func_0x00018086a96c': 'CleanupDataBuffer',
        'func_0x00018086aadf': 'InitializeSecuritySystem',
        'func_0x00018086aaee': 'ResetSecurityContext',
        'func_0x00018086ab10': 'ProcessSecurityPacket',
        'func_0x00018086ab52': 'ValidateSecurityContext',
        'func_0x00018086ab6c': 'CleanupSecurityContext',
        'func_0x00018086acbc': 'InitializeEncryption',
        'func_0x00018086accb': 'ProcessEncryption',
        'func_0x00018086acf0': 'ValidateEncryption',
        'func_0x00018086ad32': 'ValidateSecurityPacket',
        'func_0x00018086ad4c': 'ProcessEncryptionContext',
        'func_0x00018086ae9c': 'AnalyzeNetworkPerformance',
        'func_0x00018086aeab': 'GeneratePerformanceReport',
        'func_0x00018086aed0': 'OptimizeNetworkPerformance',
        'func_0x00018086af12': 'HandleNetworkError',
        'func_0x00018086af2f': 'LogNetworkError',
        'func_0x00018086b4b0': 'ProcessPacketArray',
        'func_0x00018086b50c': 'ValidateConnectionStatus',
        'func_0x00018086b67f': 'InitializeConnectionManager',
        'func_0x00018086b68e': 'CleanupSecurityGuardBasic',
        'func_0x00018086b6b0': 'ProcessConnectionContext',
        'func_0x00018086b6f2': 'ResetConnectionState',
        'func_0x00018086b70f': 'InitializeConnectionHandler',
        'func_0x00018086b87f': 'CleanupConnectionBuffers',
        'func_0x00018086b88e': 'ReleaseConnectionResources',
        'func_0x00018086b8b0': 'ValidateConnectionIntegrity',
        'func_0x00018086ba5c': 'MonitorConnectionStatus',
        'func_0x00018086ba6b': 'MonitorConnectionPerformance',
        'func_0x00018086bc90': 'ValidateConnectionPacket',
        'func_0x00018086bccf': 'InitializeConnectionCleanup',
        'func_0x00018086bcec': 'HandleConnectionError',
        'func_0x00018086be5f': 'CleanupSecurityGuardSimple',
        'func_0x00018086be6e': 'CleanupSecurityGuardMinimal',
        'func_0x00018086be90': 'ProcessConnectionTransfer',
        'func_0x00018086bed2': 'InitializeConnectionStateManager',
        'func_0x00018086beef': 'ResetConnectionStateManager',
        'func_0x00018086c05f': 'CleanupSecurityGuardWithStack',
        'func_0x00018086c06e': 'ResetSecurityGuardWithStack',
        'func_0x00018086c090': 'ValidateConnectionSecurity',
        'func_0x00018086c0d2': 'ProcessConnectionData',
        'func_0x00018086c0ef': 'InitializeConnectionHandlerEx',
        'func_0x00018086c25f': 'CleanupConnectionHandler',
        'func_0x00018086c26e': 'ResetConnectionHandler',
        'func_0x00018086c4cf': 'CleanupConnectionResourcesEx',
        'func_0x00018086c63f': 'CleanupSecurityContextEx',
        'func_0x00018086c64e': 'ResetConnectionStatus',
        'func_0x00018086c670': 'ProcessConnectionContextEx',
        'func_0x00018086c6b2': 'InitializeConnectionPoolEx',
        'func_0x00018086c6cf': 'SortConnectionEntries',
        'func_0x00018086c83f': 'CleanupSecurityGuardSimpleEx',
        'func_0x00018086c84e': 'CleanupSecurityGuardBasicEx',
        'func_0x00018086c870': 'TransferPacketEx',
        'func_0x00018086c8b2': 'ResetConnectionStateFlags',
        'func_0x00018086c8cf': 'InitializeConnectionProcessor',
        'func_0x00018086ca3f': 'ValidateConnectionParametersEx',
        'func_0x00018086ca4e': 'UpdateConnectionState',
        'func_0x00018086ca70': 'ValidateConnectionData',
        'func_0x00018086cab2': 'CleanupConnectionBuffersEx',
        'func_0x00018086cacf': 'ResetConnectionProcessor',
        'func_0x00018086cc3f': 'ValidateConnectionIntegrityEx',
        'func_0x00018086cc4e': 'InitializeConnectionPoolFinal',
        'func_0x00018086cc70': 'ProcessConnectionTransferEx',
        'func_0x00018086ccaf': 'ReleaseConnectionResourcesEx',
        'func_0x00018086cccc': 'ValidateConnectionStateEx',
        'func_0x00018086ce3f': 'SetConnectionParametersEx',
        'func_0x00018086ce4e': 'InitializePacketBufferEx',
        'func_0x00018086ce70': 'UpdateConnectionStatusEx',
        'func_0x00018086ceaf': 'InitializeConnectionStackBufferEx',
        'func_0x00018086cecc': 'ProcessConnectionContextHandler',
        'func_0x00018086d03f': 'ResetConnectionContextHandler',
        'func_0x00018086d04e': 'CleanupConnectionEntryArray',
        'func_0x00018086d070': 'ProcessConnectionContextHandlerEx',
        'func_0x00018086d0b2': 'ResetConnectionContextHandlerEx',
        'func_0x00018086d0cf': 'CleanupConnectionEntryArrayEx',
        'func_0x00018086d23f': 'CleanupSecurityGuardFifth',
        'func_0x00018086d24e': 'CleanupSecurityGuardSixth',
        'func_0x00018086d270': 'TransferConnectionPacketSecond',
        'func_0x00018086d43f': 'CleanupSecurityGuard001',
        'func_0x00018086d44e': 'CleanupSecurityGuard002',
        'func_0x00018086d470': 'ProcessConnectionTransferFinal',
        'func_0x00018086d620': 'ProcessConnectionTransferExtended',
        'func_0x00018086daa2': 'FindConnectionIndex',
        'func_0x00018086dc50': 'ProcessConnectionQueue',
        'func_0x00018086ddc0': 'ProcessConnectionContextExtended',
        'func_0x00018086ddc8': 'ProcessConnectionContextAlternate',
        'func_0x00018086df30': 'ProcessConnectionDataWithSize',
        'func_0x00018086e090': 'ValidateConnectionPacketEx',
        'func_0x00018086e330': 'HandleConnectionTransfer',
        'func_0x00018086e5c0': 'ProcessConnectionStream',
        'func_0x00018086e710': 'HandleConnectionContext',
        'func_0x00018086e860': 'ProcessConnectionContextFinal',
        'func_0x00018086e9b0': 'ProcessConnectionTransferFinalEx',
        'func_0x00018086eb00': 'InitializePacketIterator',
        'func_0x00018086ec60': 'ValidateAndCleanupPacket',
        'func_0x00018086eda0': 'ProcessContextDataPrimary',
        'func_0x00018086f040': 'UpdateConnectionStatusFinal',
        'func_0x00018086f1a0': 'TransmitPacket',
        'func_0x00018086f460': 'ProcessConnectionStreamEx',
        'func_0x00018086f4ed': 'InitializeConnectionManagerEx',
        'func_0x00018086f5fd': 'HandleNetworkIdle',
        'func_0x00018086f69d': 'ValidateConnectionStatusEx',
        'func_0x00018086f793': 'CheckOperationStatus',
        'func_0x00018086f7c0': 'ClearDataSizeBuffer',
        'func_0x00018086f8b0': 'ProcessDataStreamEx',
        'func_0x00018086f9a0': 'ProcessDataTransmission',
        'func_0x00018086fa90': 'ProcessPacketStream',
        'func_0x00018086fb80': 'ProcessDataQueue',
        'func_0x00018086fc70': 'ProcessDataBuffer',
        'func_0x00018086fd60': 'ProcessDataBufferOperation',
        'func_0x00018086fe50': 'ProcessDataQueueOperation',
        'func_0x00018086ff40': 'ProcessDataTransmissionOperation',
        'func_0x000180870030': 'ClearNetworkBuffer',
        'func_0x000180870120': 'ResetNetworkBuffer',
        'func_0x000180870210': 'ClearDataBufferFirst',
        'func_0x000180870310': 'ClearDataBufferSecond',
        'func_0x000180870410': 'ClearDataBufferThird',
        'func_0x000180870500': 'ClearDataBufferFirstEx',
        'func_0x0001808705f0': 'ClearDataBufferSecondEx',
        'func_0x0001808706e0': 'ClearDataBufferThirdEx',
        'func_0x0001808707d0': 'ClearDataSizeBufferSeventh',
        'func_0x0001808708c0': 'ClearDataSizeBufferEighth',
        'func_0x0001808709b0': 'ClearDataSizeBufferFinal',
        'func_0x000180870aa0': 'ResetDataSizeBufferEx',
        'func_0x000180870b90': 'ZeroDataSizeBuffer',
        'func_0x000180870c80': 'InitializeDataSizeBuffer',
        'func_0x000180870d70': 'PurgeDataSizeBuffer',
        'func_0x000180870e60': 'FlushDataSizeBuffer',
        'func_0x000180870f50': 'SanitizeDataSizeBuffer',
        'func_0x000180871040': 'ClearDataBufferFourth',
        'func_0x000180871130': 'ClearDataBufferFifth',
        'func_0x0001808719a0': 'InitializeContextArray',
        'func_0x000180871840': 'ProcessConnectionContextSpecial',
        'func_0x0001808713a0': 'InitializeNetworkStack',
        'func_0x0001808723c0': 'CleanupConnectionStatusType2',
        'func_0x000180872480': 'CleanupConnectionStatusType3',
        'func_0x000180872630': 'ValidateConnectionStateReturnHandle',
        'func_0x000180872cc0': 'InitializeConnectionContextState',
        'func_0x000180872ef0': 'ResetConnectionContextState',
        'func_0x000180872f02': 'TransmitPacketEx',
        'func_0x000180872f0b': 'TransmitPacketSecond',
        'func_0x00018087304a': 'CleanupConnectionContextData',
        'func_0x00018087306d': 'CleanupConnectionContextDataAlt',
        'func_0x00018087309b': 'CleanupPacket',
        'func_0x0001808732fb': 'CleanupConnectionStatusData',
        'func_0x0001808733a0': 'CleanupConnectionStatusType4',
        'func_0x000180873cd0': 'InitializeConnectionState',
        'func_0x000180873ec0': 'SetConnectionContextRelease',
        'func_0x000180873ef0': 'SetConnectionContextSizedRelease',
        'func_0x000180873f20': 'SetConnectionContext16ByteRelease',
        'func_0x000180873f80': 'ProcessConnectionTransferFinal',
        'func_0x0001808740c0': 'ValidatePacketIndex',
        'func_0x000180874340': 'ValidateConnectionContextSecurity',
        'func_0x00018087439e': 'InitializeConnectionContextManager',
        'func_0x00018087446c': 'GetConnectionDataSize',
        'func_0x00018087447c': 'ProcessConnectionContextCleanup',
        'func_0x0001808744c7': 'AllocateConnectionMemory',
        'func_0x0001808746d5': 'InitializeConnectionDataStructure',
        'func_0x00018087471e': 'ValidateConnectionStateFinal',
        'func_0x000180874760': 'ReleaseConnectionContextResources',
        'func_0x000180874280': 'InitializeConnectionBufferEx',
        'func_0x000180874320': 'GetConnectionSecondaryStatus',
        'func_0x000180879a40': 'GetNetworkContextIndex',
        'func_0x000180879a50': 'GetConnectionSecondaryStatusPointer',
        'func_0x00018087c16c0': 'ProcessConnectionResource',
        'func_0x00018087cded0': 'ReleaseConnectionHandle',
        'func_0x00018087cf130': 'InitializeConnectionField',
        'func_0x00018087d390': 'ProcessConnectionField',
        'func_0x00018087d7290': 'ValidateStackParameter',
        'func_0x00018087da780': 'ProcessNetworkContextArray',
        'func_0x00018087dbe40': 'CleanupNetworkContextArray',
        'func_0x00018087db610': 'ProcessNetworkContextValidation',
        'func_0x00018087dcac0': 'ValidateNetworkContextEntry',
        'func_0x00018087dd5c0': 'FindConnectionIndexEx',
        'func_0x00018087de0070': 'ProcessConnectionStreamEx',
        'func_0x00018087de0080': 'ProcessConnectionStreamFinal',
        'func_0x00018087e0070': 'ProcessConnectionDataStreamEx',
        'func_0x00018087e0080': 'ProcessConnectionDataStreamFinal',
        'func_0x00018087e2ff0': 'GetNetworkContextPointerEx',
        'func_0x00018087e3b80': 'ProcessNetworkStackData',
        'func_0x00018087e3470': 'ProcessNetworkContextValidationEx',
        'func_0x00018087e3470': 'ValidateNetworkContextEx',
        'func_0x00018087e57e0': 'ProcessNetworkStackDataEx',
        'func_0x00018087e64d0': 'GetConnectionHandleStatus',
        'func_0x00018087e64e0': 'InitializeConnectionTransfer',
        'func_0x00018087e64b0': 'ResetConnectionTransfer',
        'func_0x00018087e63f0': 'GetNetworkContextStatus',
        'func_0x000180881f80': 'GetNetworkCurrentChar',
        'func_0x00018088aed0': 'ProcessNetworkPacket',
        'func_0x00018088c500': 'ProcessConnectionOperation',
        'func_0x00018088c570': 'ProcessConnectionTransferBasic',
        'func_0x00018088c6e0': 'ProcessConnectionTertiaryStatus',
        'func_0x00018088c7d30': 'ValidateConnectionHandleEx',
        'func_0x00018088c8470': 'GetConnectionHandleData',
        'func_0x00018088c8700': 'ProcessConnectionHandleBasic',
        'func_0x00018088c8710': 'ProcessConnectionHandleAdvanced',
        'func_0x00018088c2130': 'ProcessNetworkPacketEx',
        'func_0x00018088d2620': 'ProcessConnectionTransferFirst',
        'func_0x00018088d2660': 'ProcessConnectionTransferSecond',
        'func_0x00018088d2830': 'ProcessConnectionTransferThird',
        'func_0x00018088d5fb0': 'GetNetworkByteIndicator',
        'func_0x00018088d57c0': 'FindConnectionIndexFinal',
        'func_0x00018088dd50': 'ProcessConnectionPrimaryStatus',
        'func_0x00018088e470': 'ValidateConnectionHandleFinal',
        'func_0x00018088e6f0': 'ProcessConnectionSecondaryStatus',
        'func_0x00018088a120': 'ResetNetworkSystem',
        'func_0x00018088be40': 'CleanupNetworkContext',
        'func_0x00018088bad50': 'GetNetworkContext',
        'func_0x00018088c6590': 'GetNetworkFlags',
        'func_0x00018088e470': 'ValidateConnectionHandleFinal',
        'func_0x0001808967b0': 'ProcessNetworkConnectionByte',
        'func_0x0001808c16c0': 'ProcessConnectionResourceEx',
        'func_0x0001808c57f0': 'GetNetworkByteIndicatorEx',
        'func_0x0001808666d0': 'ProcessNetworkStatusEx',
        'func_0x0001808b8390': 'InitializeNetworkPosition',
        'func_0x0001808cef10': 'InitializeNetworkField',
        'func_0x0001808ded80': 'InitializeNetworkContextArray',
        'func_0x0001808e3470': 'ValidateNetworkContextFinal',
        'func_0x0001808e57e0': 'ProcessNetworkStackFinal',
        'func_0x00018085fa80': 'GetNetworkProcessingStatus',
        'func_0x00018074b7b0': 'ProcessNetworkPacketDataEx',
        'func_0x0001808757f0': 'ProcessNetworkConnectionPrimary',
        'func_0x0001808c7d30': 'ValidateConnectionHandleFinal',
        'func_0x0001808c8710': 'ProcessConnectionHandleAdvanced',
        'func_0x0001808c8700': 'ProcessConnectionHandleBasic',
        'func_0x0001808c8470': 'GetConnectionHandleData'
    }
    
    # 应用替换
    original_content = content
    for old_name, new_name in function_mappings.items():
        content = re.sub(r'\b' + re.escape(old_name) + r'\b', new_name, content)
    
    # 检查是否有变化
    if content != original_content:
        # 写回文件
        with open('/dev/shm/mountblade-code/TaleWorlds.Native/src/05_networking.c', 'w', encoding='utf-8') as f:
            f.write(content)
        print(f"成功美化 {len(function_mappings)} 个函数调用")
    else:
        print("没有找到需要美化的函数调用")

if __name__ == "__main__":
    beautify_networking_file()