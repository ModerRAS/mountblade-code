#!/usr/bin/env python3
"""
批量替换03_rendering.c文件中的函数名
"""

import re

def read_file(file_path):
    """读取文件内容"""
    with open(file_path, 'r', encoding='utf-8') as f:
        return f.read()

def write_file(file_path, content):
    """写入文件内容"""
    with open(file_path, 'w', encoding='utf-8') as f:
        f.write(content)

def replace_functions(content):
    """替换函数名"""
    
    # 函数名映射表
    function_mapping = {
        'FUN_1804c1300': 'AllocateRenderMemory',
        'FUN_180628ca0': 'GetRenderContext',
        'FUN_180630b20': 'ProcessRenderString',
        'FUN_18041bf60': 'CreateRenderContext',
        'FUN_18040b330': 'ValidateRenderData',
        'FUN_180436c30': 'InitializeRenderShader',
        'FUN_1804373a0': 'SetupRenderPipeline',
        'FUN_180436ae0': 'ConfigureRenderTargets',
        'FUN_180437320': 'SetRenderViewport',
        'FUN_180436a50': 'ClearRenderBuffers',
        'FUN_180437050': 'BindRenderResources',
        'FUN_180436f20': 'UpdateRenderConstants',
        'FUN_180436da0': 'SetRenderSamplers',
        'FUN_180436d00': 'ConfigureRenderStates',
        'FUN_180436bb0': 'PrepareRenderDraw',
        'FUN_1804369d0': 'ExecuteRenderDraw',
        'FUN_180437110': 'FinalizeRenderFrame',
        'FUN_180436bf0': 'PresentRenderFrame',
        'FUN_180436a00': 'ResetRenderDevice',
        'FUN_180436fd0': 'FlushRenderQueue',
        'FUN_180437290': 'UpdateRenderBuffers',
        'FUN_1804372e0': 'SyncRenderFences',
        'FUN_180437d60': 'CreateRenderTexture',
        'FUN_1804375f0': 'DestroyRenderTexture',
        'FUN_1804374c0': 'UpdateRenderTexture',
        'FUN_180437560': 'BindRenderTexture',
        'FUN_180437cf0': 'SetTextureParameters',
        'FUN_180437680': 'GenerateTextureMipmaps',
        'FUN_1804377b0': 'CopyTextureData',
        'FUN_180437e80': 'CompressTextureData',
        'FUN_180437ba0': 'DecompressTextureData',
        'FUN_180437c40': 'ValidateTextureFormat',
        'FUN_1804378e0': 'CreateRenderBuffer',
        'FUN_1804379d0': 'DestroyRenderBuffer',
        'FUN_180437460': 'UpdateRenderBuffer',
        'FUN_180437b60': 'BindRenderBuffer',
        'FUN_180437ca0': 'MapBufferData',
        'FUN_180437d40': 'UnmapBufferData',
        'FUN_18043b930': 'CreateRenderShader',
        'FUN_18043b290': 'CompileShaderSource',
        'FUN_180438560': 'LinkShaderProgram',
        'FUN_180438210': 'ValidateShaderProgram',
        'FUN_18043bbe0': 'SetShaderUniform',
        'FUN_180438940': 'GetShaderAttribute',
        'FUN_1804386b0': 'BindShaderAttribute',
        'FUN_180438350': 'ConfigureShaderInput',
        'FUN_18043ab40': 'SetShaderParameter',
        'FUN_18043a140': 'GetShaderParameter',
        'FUN_1804382b0': 'UpdateShaderBuffer',
        'FUN_180438c50': 'CreateRenderPipeline',
        'FUN_1804389f0': 'ConfigurePipelineState',
        'FUN_180438680': 'SetPipelineRasterizer',
        'FUN_180438c70': 'SetPipelineBlending',
        'FUN_18043c350': 'SetPipelineDepthStencil',
        'FUN_18043c370': 'SetPipelineMultisample',
        'FUN_18043c740': 'ConfigurePipelineOutput',
        'FUN_18043c6b0': 'BindPipelineState',
        'FUN_18043c3b0': 'CreateRenderPass',
        'FUN_18043c510': 'BeginRenderPass',
        'FUN_18043c0f0': 'EndRenderPass',
        'FUN_18043c020': 'NextSubpass',
        'FUN_18043c060': 'ExecuteRenderPass',
        'FUN_18043c290': 'ResetRenderPass',
        'FUN_18043c2e0': 'DestroyRenderPass',
        'FUN_18043c0b0': 'CreateFramebuffer',
        'FUN_18043c230': 'BindFramebuffer',
        'FUN_18043c160': 'ConfigureFramebuffer',
        'FUN_18043c6e0': 'ValidateFramebuffer',
        'FUN_18043bff0': 'CreateRenderCommand',
        'FUN_18043bfb0': 'ExecuteRenderCommand',
        'FUN_18043cb50': 'ResetCommandBuffer',
        'FUN_18043c820': 'BeginCommandRecording',
        'FUN_18043c8e0': 'EndCommandRecording',
        'FUN_18043cae0': 'SubmitCommandBuffer',
        'FUN_18043c7a0': 'WaitCommandCompletion',
        'FUN_1804378e0': 'CreateRenderSemaphore',
        'FUN_18043ca10': 'SignalRenderSemaphore',
        'FUN_180437460': 'WaitRenderSemaphore',
        'FUN_180437b60': 'ResetRenderSemaphore',
        'FUN_18043caa0': 'CreateRenderFence',
        'FUN_18043d100': 'SignalRenderFence',
        'FUN_18043cbd0': 'WaitRenderFence',
        'FUN_1804403d0': 'CreateRenderQuery',
        'FUN_18043fe70': 'BeginRenderQuery',
        'FUN_180442860': 'EndRenderQuery',
        'FUN_180441c50': 'GetQueryResult',
        'FUN_18043ea80': 'ResetRenderQuery',
        'FUN_18043eb00': 'CreateRenderDescriptor',
        'FUN_180440910': 'UpdateDescriptorSet',
        'FUN_18043ff20': 'BindDescriptorSet',
        'FUN_180442180': 'CreateDescriptorPool',
        'FUN_1804410a0': 'ResetDescriptorPool',
        'FUN_180440220': 'AllocateDescriptorSet',
        'FUN_180440280': 'FreeDescriptorSet',
        'FUN_1804402e0': 'UpdateDescriptorBuffers',
        'FUN_1804401b0': 'CopyDescriptorData',
        'FUN_180442720': 'ValidateDescriptorLayout',
        'FUN_18043f5f0': 'CreateRenderSampler',
        'FUN_180442370': 'ConfigureSamplerParameters',
        'FUN_1804424d0': 'BindRenderSampler',
        'FUN_18043e7f0': 'DestroyRenderSampler',
        'FUN_18043e990': 'CreateRenderLayout',
        'FUN_18043ea60': 'ConfigureLayoutBindings',
        'FUN_18043e9b0': 'DestroyRenderLayout',
        'FUN_180442e00': 'CreateRenderAcceleration',
        'FUN_18043f300': 'BuildAccelerationStructure',
        'FUN_18043f0d0': 'UpdateAccelerationStructure',
        'FUN_180443630': 'DestroyAccelerationStructure',
        'FUN_18043e630': 'CreateRayTracingPipeline',
        'FUN_18043e720': 'ConfigureRayTracingShader',
        'FUN_18043f3f0': 'BuildRayTracingShaderTable',
        'FUN_18043f610': 'TraceRayTracingRays',
        'FUN_180440350': 'CreateRenderSwapchain',
        'FUN_180440750': 'ConfigureSwapchainParameters',
        'FUN_18043fd10': 'AcquireNextSwapchainImage',
        'FUN_180443320': 'PresentSwapchainImage',
        'FUN_180441e10': 'RecreateSwapchain',
        'FUN_180441dd0': 'DestroySwapchain',
        'FUN_180442b30': 'ResizeSwapchain',
        'FUN_1804404b0': 'GetSwapchainImages',
        'FUN_180441950': 'CreateRenderSurface',
        'FUN_180441640': 'ConfigureSurfaceParameters',
        'FUN_180440cb0': 'DestroyRenderSurface',
        'FUN_180440d90': 'CreateRenderInstance',
        'FUN_180441420': 'ConfigureInstanceParameters',
        'FUN_18043f8f0': 'DestroyRenderInstance',
        'FUN_180441f60': 'CreateRenderDevice',
        'FUN_180441fc0': 'ConfigureDeviceParameters',
        'FUN_18043f9b0': 'DestroyRenderDevice',
        'FUN_18043fce0': 'GetDeviceQueues',
        'FUN_180441cc0': 'CreateDeviceMemory',
        'FUN_18043ef40': 'AllocateDeviceMemory',
        'FUN_180442d10': 'FreeDeviceMemory',
        'FUN_18043f770': 'MapDeviceMemory',
        'FUN_180440d20': 'UnmapDeviceMemory',
        'FUN_180440e00': 'FlushMappedMemory',
        'FUN_180440e70': 'InvalidateMappedMemory',
        'FUN_18043f240': 'GetMemoryRequirements',
        'FUN_180440560': 'BindDeviceMemory',
        'FUN_1804420c0': 'CreateRenderCommandPool',
        'FUN_180442020': 'ResetCommandPool',
        'FUN_180443930': 'AllocateCommandBuffers',
        'FUN_18043f010': 'FreeCommandBuffers',
        'FUN_1804422a0': 'BeginCommandBuffer',
        'FUN_18043e5c0': 'EndCommandBuffer',
        'FUN_180441180': 'SubmitCommandBuffers',
        'FUN_180441260': 'WaitForIdleDevice',
        'FUN_180442450': 'CreateRenderFencePool',
        'FUN_180440f30': 'ConfigureFencePool',
        'FUN_180441e50': 'ResetRenderFencePool',
        'FUN_180443510': 'CreateRenderSemaphorePool',
        'FUN_180441070': 'ConfigureSemaphorePool',
        'FUN_18043ee70': 'ResetSemaphorePool',
        'FUN_18043fef0': 'CreateRenderQueryPool',
        'FUN_180442560': 'ConfigureQueryPool',
        'FUN_180443700': 'ResetQueryPool',
        'FUN_180442950': 'AllocateQueryPool',
        'FUN_18043f880': 'FreeQueryPool',
        'FUN_1804418e0': 'CreateRenderDescriptorPool',
        'FUN_180441110': 'ConfigureDescriptorPool',
        'FUN_18043ed10': 'ResetDescriptorPool',
        'FUN_180443820': 'AllocateDescriptorSets',
        'FUN_180441830': 'FreeDescriptorSets',
        'FUN_18043ed10': 'CreateRenderBufferPool',
        'FUN_180443680': 'ConfigureBufferPool',
        'FUN_180443000': 'ResetBufferPool',
        'FUN_180441e90': 'AllocateBufferPool',
        'FUN_180443770': 'FreeBufferPool',
        'FUN_180442670': 'CreateRenderTexturePool',
        'FUN_180441890': 'ConfigureTexturePool',
        'FUN_18043ecc0': 'ResetTexturePool',
        'FUN_180443a40': 'AllocateTexturePool',
        'FUN_180443aa0': 'FreeTexturePool',
        'FUN_180443ff0': 'CreateRenderPipelinePool',
        'FUN_1804442c0': 'ConfigurePipelinePool',
        'FUN_180444370': 'ResetPipelinePool',
        'FUN_180444100': 'AllocatePipelinePool',
        'FUN_180444600': 'FreePipelinePool',
        'FUN_180444700': 'CreateRenderShaderPool',
        'FUN_1804447c0': 'ConfigureShaderPool',
        'FUN_1804448a0': 'ResetShaderPool',
        'FUN_1804443c0': 'AllocateShaderPool',
        'FUN_1804442e0': 'FreeShaderPool',
        'FUN_180444200': 'CreateRenderCommandPool',
        'FUN_180444280': 'ConfigureCommandPool',
        'FUN_180444070': 'ResetCommandPool',
        'FUN_180444410': 'AllocateCommandPool',
        'FUN_1804445b0': 'FreeCommandPool',
        'FUN_180445180': 'CreateRenderMemoryPool',
        'FUN_1804449a0': 'ConfigureMemoryPool',
        'FUN_180445060': 'ResetMemoryPool',
        'FUN_180445110': 'AllocateMemoryPool',
        'FUN_180444e90': 'FreeMemoryPool',
        'FUN_180444a20': 'CreateRenderDescriptorPool',
        'FUN_180444b70': 'ConfigureDescriptorPool',
        'FUN_180444dd0': 'ResetDescriptorPool',
        'FUN_180445480': 'AllocateDescriptorPool',
        'FUN_180445570': 'FreeDescriptorPool',
        'FUN_1804457b0': 'CreateRenderFencePool',
        'FUN_180445870': 'ConfigureFencePool',
        'FUN_180445110': 'ResetFencePool',
        'FUN_180446010': 'AllocateFencePool',
        'FUN_180446370': 'FreeFencePool',
        'FUN_180446320': 'CreateRenderSemaphorePool',
        'FUN_1804463b0': 'ConfigureSemaphorePool',
        'FUN_1804463f0': 'ResetSemaphorePool',
        'FUN_180446430': 'AllocateSemaphorePool',
        'FUN_180446480': 'FreeSemaphorePool',
        'FUN_180445680': 'CreateRenderQueryPool',
        'FUN_180446080': 'ConfigureQueryPool',
        'FUN_180446760': 'ResetQueryPool',
        'FUN_180446a60': 'AllocateQueryPool',
        'FUN_180446b20': 'FreeQueryPool',
        'FUN_180446ca0': 'CreateRenderBufferPool',
        'FUN_180446d20': 'ConfigureBufferPool',
        'FUN_180446f00': 'ResetBufferPool',
        'FUN_180446ba0': 'AllocateBufferPool',
        'FUN_180446fd0': 'FreeBufferPool',
        'FUN_180446dc0': 'CreateRenderTexturePool',
        'FUN_180446fa0': 'ConfigureTexturePool',
        'FUN_180446e70': 'ResetTexturePool',
        'FUN_180446960': 'AllocateTexturePool',
        'FUN_180447c00': 'FreeTexturePool',
        'FUN_180448110': 'CreateRenderPipelinePool',
        'FUN_1804485c0': 'ConfigurePipelinePool',
        'FUN_1804489a0': 'ResetPipelinePool',
        'FUN_180447e40': 'AllocatePipelinePool',
        'FUN_180447f70': 'FreePipelinePool',
        'FUN_180447660': 'CreateRenderShaderPool',
        'FUN_1804475e0': 'ConfigureShaderPool',
        'FUN_180447710': 'ResetShaderPool',
        'FUN_1804477f0': 'AllocateShaderPool',
        'FUN_180448ea0': 'FreeShaderPool',
        'FUN_180448470': 'CreateRenderCommandPool',
        'FUN_180448540': 'ConfigureCommandPool',
        'FUN_1804484c0': 'ResetCommandPool',
        'FUN_180448420': 'AllocateCommandPool',
        'FUN_180449000': 'FreeCommandPool',
        'FUN_1804491c0': 'CreateRenderMemoryPool',
        'FUN_180447e10': 'ConfigureMemoryPool',
        'FUN_180447de0': 'ResetMemoryPool',
        'FUN_180447430': 'AllocateMemoryPool',
        'FUN_180447b80': 'FreeMemoryPool',
        'FUN_180448f50': 'CreateRenderDescriptorPool',
        'FUN_1804473b0': 'ConfigureDescriptorPool',
        'FUN_180448d90': 'ResetDescriptorPool',
        'FUN_180448df0': 'AllocateDescriptorPool',
        'FUN_180449850': 'FreeDescriptorPool',
        'FUN_180449230': 'CreateRenderFencePool',
        'FUN_180448e50': 'ConfigureFencePool',
        'FUN_1804496f0': 'ResetFencePool',
        'FUN_180449070': 'AllocateFencePool',
        'FUN_180447220': 'FreeFencePool',
        'FUN_180447ca0': 'CreateRenderSemaphorePool',
        'FUN_180448fb0': 'ConfigureSemaphorePool',
        'FUN_180447990': 'ResetSemaphorePool',
        'FUN_180447850': 'AllocateSemaphorePool',
        'FUN_1804498f0': 'FreeSemaphorePool'
    }
    
    # 执行替换
    for old_name, new_name in function_mapping.items():
        # 使用正则表达式替换，确保只替换完整的函数名
        pattern = r'\b' + re.escape(old_name) + r'\b'
        content = re.sub(pattern, new_name, content)
    
    return content

def main():
    """主函数"""
    file_path = '/dev/shm/mountblade-code/TaleWorlds.Native/src/03_rendering.c'
    
    print("开始批量替换03_rendering.c文件中的函数名...")
    
    # 读取文件
    content = read_file(file_path)
    
    # 替换函数名
    new_content = replace_functions(content)
    
    # 写入文件
    write_file(file_path, new_content)
    
    print("函数名替换完成！")

if __name__ == '__main__':
    main()