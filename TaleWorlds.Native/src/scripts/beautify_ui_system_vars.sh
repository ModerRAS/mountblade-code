#!/bin/bash

# 美化UI系统变量名和函数名的脚本
# 用于替换04_ui_system.c中的UNK_变量和FUN_函数名为语义化名称

echo "开始美化UI系统变量名和函数名..."

# 定义变量名映射
declare -A VARIABLE_MAPPINGS=(
    # 系统状态变量
    ["UNK_1809589a0"]="UiSystemStatusFlags"
    ["UNK_180958a10"]="UiSystemRuntimeState"
    ["UNK_180958a50"]="UiSystemConfiguration"
    ["UNK_18076804b"]="UiSystemMainThreadId"
    ["UNK_180958b20"]="UiSystemEventQueue"
    ["UNK_1dd01c85c"]="UiSystemLockFlag"
    ["UNK_180958ac0"]="UiSystemRenderContext"
    ["UNK_180958b00"]="UiSystemInputContext"
    ["UNK_180958b10"]="UiSystemAnimationContext"
    ["UNK_180958ba0"]="UiSystemWindowContext"
    ["UNK_180958c10"]="UiSystemWidgetContext"
    ["UNK_1807693c0"]="UiSystemFontContext"
    ["UNK_180958bf0"]="UiSystemTextureContext"
    ["UNK_180958c88"]="UiSystemShaderContext"
    ["UNK_180958cb0"]="UiSystemVertexBuffer"
    ["UNK_180958d20"]="UiSystemIndexBuffer"
    ["UNK_000003b8"]="UiSystemMemoryPool1"
    ["UNK_000003c0"]="UiSystemMemoryPool2"
    ["UNK_180958d90"]="UiSystemEventDispatcher"
    ["UNK_180958e20"]="UiSystemLayoutManager"
    ["UNK_180958fb0"]="UiSystemStyleManager"
    ["UNK_180770640"]="UiSystemThemeManager"
    ["UNK_180958ec0"]="UiSystemFocusManager"
    ["UNK_180958f10"]="UiSystemTooltipManager"
    ["UNK_180958f68"]="UiSystemDialogManager"
    ["UNK_1809590c0"]="UiSystemMenuManager"
    ["UNK_180747d60"]="UiSystemButtonManager"
    ["UNK_1807868c0"]="UiSystemScrollManager"
    ["UNK_180786c90"]="UiSystemProgressBarManager"
    ["UNK_180788fc0"]="UiSystemTabControlManager"
    ["UNK_180959140"]="UiSystemCanvasManager"
    ["UNK_1809591b0"]="UiSystemPanelManager"
    ["UNK_180959410"]="UiSystemGridManager"
    ["UNK_180959630"]="UiSystemStackManager"
    ["UNK_1809596a4"]="UiSystemDockManager"
    ["UNK_180959b80"]="UiSystemSplitManager"
    ["UNK_180959d10"]="UiSystemTabManager"
    ["UNK_180959d80"]="UiSystemTreeViewManager"
    
    # 资源管理变量
    ["UNK_1803f60a0"]="UiResourceDatabase"
    ["UNK_180655e50"]="UiTextureDatabase"
    ["UNK_180084650"]="UiFontDatabase"
    ["UNK_180655f30"]="UiShaderDatabase"
    ["UNK_1806561b0"]="UiAnimationDatabase"
    ["UNK_1806561c0"]="UiSoundDatabase"
    ["UNK_180150380"]="UiColorDatabase"
    ["UNK_180656100"]="UiIconDatabase"
    ["UNK_180656330"]="UiCursorDatabase"
    ["UNK_180656320"]="UiStringDatabase"
    ["UNK_180656700"]="UiStyleDatabase"
    ["UNK_180046680"]="UiThemeDatabase"
    ["UNK_180046230"]="UiLayoutDatabase"
    
    # 配置变量
    ["UNK_180a16f70"]="UiConfigTemplate"
    ["UNK_1809fe62c"]="UiConfigValidation"
    ["UNK_180a3ddc0"]="UiConfigInitialize"
    ["UNK_180a3dda8"]="UiConfigDefaults"
    ["UNK_180a3deb8"]="UiConfigSettings"
    ["UNK_180c91030"]="UiGlobalConfig"
    ["UNK_180a3c07c"]="UiConfigName"
    ["UNK_180a3e030"]="UiConfigMain"
    ["UNK_180a3e180"]="UiConfigDisplay"
    ["UNK_180a3e230"]="UiConfigVideo"
    ["UNK_180a3e1f8"]="UiConfigAudio"
    ["UNK_180a3e210"]="UiConfigControls"
    ["UNK_180a3e1b0"]="UiConfigGameplay"
    ["UNK_180a3e1c8"]="UiConfigInterface"
    ["UNK_180a3e1a0"]="UiConfigLanguage"
    ["UNK_180a3e178"]="UiConfigResolution"
    ["UNK_180a3e150"]="UiConfigQuality"
    ["UNK_180a3e248"]="UiConfigAccessibility"
    ["UNK_180a3e260"]="UiConfigAdvanced"
    ["UNK_180a3e224"]="UiConfigDebug"
    ["UNK_180a3e148"]="UiConfigNetwork"
    ["UNK_180a3e1e0"]="UiConfigMod"
    ["UNK_180a3e1e8"]="UiConfigSave"
    ["UNK_180a3e2b0"]="UiConfigLoad"
    ["UNK_180a0ee30"]="UiConfigExit"
    ["UNK_180a3e2b8"]="UiConfigCredits"
    ["UNK_180a3e2a0"]="UiConfigOptions"
    ["UNK_180a1a478"]="UiConfigCustom"
    ["UNK_180a16818"]="UiConfigProfile"
    ["UNK_180a0f108"]="UiConfigCloud"
    ["UNK_180a3e294"]="UiConfigPrivacy"
    ["UNK_180a3e270"]="UiConfigLegal"
    ["UNK_180a3e280"]="UiConfigHelp"
    ["UNK_180a3e2e8"]="UiConfigAbout"
    ["UNK_180a3e300"]="UiConfigUpdates"
    ["UNK_180a3e2c8"]="UiConfigDLC"
    ["UNK_180a3e2d8"]="UiConfigAchievements"
    ["UNK_180a1022c"]="UiConfigStats"
    ["UNK_180a21690"]="UiConfigData1"
    ["UNK_180a21720"]="UiConfigData2"
    ["UNK_180a3e310"]="UiConfigData3"
    ["UNK_180a3e3d8"]="UiConfigString1"
    ["UNK_180a3e3f0"]="UiConfigString2"
    ["UNK_180c91038"]="UiSystemGlobal"
    ["UNK_180a3e470"]="UiConfigSteam"
    ["UNK_180a3e408"]="UiSteamInterface1"
    ["UNK_180a3e418"]="UiSteamInterface2"
    ["UNK_180a3e440"]="UiLayoutData1"
    ["UNK_180a3e470"]="UiLayoutData2"
    
    # 渲染资源变量
    ["UNK_180a34d04"]="UiVertexData1"
    ["UNK_180a34d10"]="UiVertexData2"
    ["UNK_180a34d60"]="UiVertexData3"
    ["UNK_180a34b7c"]="UiVertexData4"
    ["UNK_180a34d50"]="UiVertexData5"
    ["UNK_180a34bc8"]="UiVertexData6"
    ["UNK_180a34d80"]="UiVertexData7"
    ["UNK_180a34d70"]="UiVertexData8"
    ["UNK_180a34d20"]="UiVertexData9"
    ["UNK_180a34d18"]="UiVertexData10"
    ["UNK_180a3e4a0"]="UiResourceIndex1"
    ["UNK_180a0fd38"]="UiResourceData1"
    ["UNK_180a3e4b8"]="UiResourceIndex2"
    ["UNK_180a3e500"]="UiResourceIndex3"
    ["UNK_180a3e510"]="UiResourceIndex4"
    ["UNK_180a3e4d8"]="UiResourceIndex5"
    ["UNK_180a3e4e8"]="UiResourceIndex6"
    ["UNK_180a3e4c8"]="UiResourceIndex7"
    ["UNK_180a3e530"]="UiResourceIndex8"
    ["UNK_180a3e588"]="UiResourceIndex9"
    ["UNK_180a19ac8"]="UiResourceCommon"
    
    # 事件系统变量
    ["UNK_180946540"]="UiEventData"
    ["UNK_180946ae0"]="UiEventCallback1"
    ["UNK_180946af8"]="UiEventCallback2"
    ["UNK_180946b10"]="UiEventCallback3"
    
    # 临时变量
    ["DAT_180c8ed30"]="UiRenderScale"
    ["DAT_180c0c1c0"]="UiCriticalSection"
    ["DAT_180c0c1c8"]="UiLockCounter"
    ["DAT_180c0c1cc"]="UiLockFlag"
)

# 定义函数名映射
declare -A FUNCTION_MAPPINGS=(
    ["FUN_18065fdb0"]="UiSystemCalculateLayout"
    ["FUN_180403910"]="UiSystemRenderElement"
    ["FUN_180405240"]="UiSystemUpdateTransform"
    ["FUN_18040dbf0"]="UiSystemProcessAnimation"
    ["FUN_180403be0"]="UiSystemDrawElement"
    ["FUN_18022b240"]="UiSystemMeasureText"
    ["FUN_18040b910"]="UiSystemProcessInput"
    ["FUN_1801c13c0"]="UiSystemCreateResource"
    ["FUN_180535610"]="UiSystemAllocateMemory"
    ["FUN_1806631b0"]="UiSystemUpdateResource"
    ["FUN_1801c10f0"]="UiSystemCreateBuffer"
    ["FUN_1801c0fb0"]="UiSystemUpdateBuffer"
    ["FUN_180285c90"]="UiSystemProcessShader"
    ["FUN_180300b10"]="UiSystemBindResource"
    ["FUN_1801503e0"]="UiSystemValidateResource"
    ["FUN_1801c1690"]="UiSystemCreateTexture"
    ["FUN_18063b720"]="UiSystemUpdateTexture"
    ["FUN_180300bf0"]="UiSystemProcessVertices"
    ["FUN_18065f210"]="UiSystemUpdateState"
    ["FUN_1801aa0f0"]="UiSystemProcessEvent"
    ["FUN_1802e9180"]="UiSystemInitializeDevice"
    ["FUN_18066e8f0"]="UiSystemCreateComponent"
    ["FUN_18066ef00"]="UiSystemInitializeComponent"
    ["FUN_18066d210"]="UiSystemProcessEvents"
    ["FUN_18066d130"]="UiSystemHandleEvent"
    ["FUN_18066eea0"]="UiSystemDispatchEvent"
    ["FUN_18066d370"]="UiSystemRegisterCallback"
    ["FUN_18066e500"]="UiSystemExecuteCallback"
    ["FUN_18066f080"]="UiSystemFindComponent"
    ["FUN_18066ef60"]="UiSystemGetComponentSize"
    ["FUN_18066efd0"]="UiSystemGetComponentData"
    ["FUN_18066d310"]="UiSystemProcessComponent"
    ["FUN_18066d3e9"]="UiSystemCleanupComponent"
    ["FUN_18066d3f4"]="UiSystemDestroyComponent"
)

# 创建备份
cp "04_ui_system.c" "04_ui_system.c.backup"

echo "开始替换变量名..."

# 替换变量名
for old_name in "${!VARIABLE_MAPPINGS[@]}"; do
    new_name="${VARIABLE_MAPPINGS[$old_name]}"
    echo "替换: $old_name -> $new_name"
    sed -i "s/$old_name/$new_name/g" "04_ui_system.c"
done

echo "开始替换函数名..."

# 替换函数名
for old_name in "${!FUNCTION_MAPPINGS[@]}"; do
    new_name="${FUNCTION_MAPPINGS[$old_name]}"
    echo "替换: $old_name -> $new_name"
    sed -i "s/$old_name/$new_name/g" "04_ui_system.c"
done

echo "完成UI系统变量名和函数名美化！"
echo "备份文件保存在: 04_ui_system.c.backup"