#!/usr/bin/env python3
"""
批量替换02_core_engine.c中的FUN_函数名为语义化名称
"""

import re
import sys

# 函数名映射字典
FUNCTION_MAPPINGS = {
    # 系统初始化相关
    'FUN_180049470': 'ProcessTargetDataStructure',
    'FUN_1800495d0': 'InitializeSystemDataHandler',
    'FUN_18004b860': 'ProcessSystemInfo',
    'FUN_18004c2b0': 'ProcessSystemMemoryOffset',
    'FUN_180046130': 'InitializeGraphicsConfiguration',
    'FUN_180052020': 'ProcessEngineInitialization',
    'FUN_180052070': 'InitializeEngineMemory',
    'FUN_180055f70': 'ProcessCharacterData',
    'FUN_180057980': 'ProcessCharacterDataBuffer',
    'FUN_18005dab0': 'ProcessMemoryBlockAddress',
    'FUN_18005db30': 'CleanupSystemResources',
    'FUN_18005e110': 'GetPerformanceCounterValue',
    'FUN_18005e450': 'UpdatePerformanceCounter',
    'FUN_18005f430': 'CompareMemoryAddresses',
    'FUN_18005ff50': 'ValidateMemoryPointer',
    
    # 内存管理相关
    'FUN_180062380': 'InitializeSystemMemoryBlock',
    'FUN_1800623b0': 'ConfigureSystemMemory',
    'FUN_1800623e0': 'FinalizeMemoryInitialization',
    'FUN_180062300': 'ProcessSystemMemoryTable',
    'FUN_180062b8b0': 'AllocateMemoryPool',
    'FUN_180062da70': 'ReleaseMemoryPool',
    'FUN_180062c470': 'ProcessSystemDataPointer',
    'FUN_180062ee0': 'GetDataStructureTypeInfo',
    'FUN_180062fd0': 'ProcessSystemOperationByType',
    'FUN_1800634b0': 'FormatSystemString',
    'FUN_180063510': 'SearchAndCompareDataStructures',
    'FUN_1800635c0': 'ExecuteSystemMemoryInfoProcessor',
    'FUN_1800635e0': 'ProcessSystemMemoryInfo',
    'FUN_180063650': 'InitializeDataStructurePointers',
    'FUN_1800637c0': 'InitializeDataStructureObject',
    'FUN_1800637f0': 'InitializeSecureDataStructureObject',
    'FUN_180063820': 'ProcessSystemDataEncoding',
    'FUN_180063b30': 'ProcessSystemDataWithParameters',
    'FUN_180063cf0': 'FinalizeSystemDataProcessing',
    'FUN_180064010': 'ValidateSystemDataIntegrity',
    'FUN_180064400': 'TerminateSystemProcess',
    'FUN_1800649d0': 'ProcessSystemDataStreamAndMemoryManagement',
    'FUN_180065160': 'ProcessSystemDataValidation',
    'FUN_180065d50': 'InitializeSystemDataProcessor',
    'FUN_180066140': 'ConfigureSystemDataParameters',
    'FUN_180066dd0': 'SystemEmptyFunction',
    'FUN_180066df0': 'ProcessSystemDataStructureTransfer',
    'FUN_180067050': 'HandleSystemOutOfRangeException',
    'FUN_180067070': 'ReleaseTargetDataStructureMemory',
    'FUN_1800670f0': 'HandleSystemLengthErrorException',
    'FUN_180067110': 'AllocateMemoryBlock',
    'FUN_180067170': 'FreeTargetDataStructure',
    'FUN_18006720b': 'ProcessMemoryBlockAlignment',
    'FUN_1800672c0': 'ProcessEngineIOCompletionPort',
    'FUN_180067480': 'ProcessCoreEngineDataBuffer',
    'FUN_180067810': 'ExecuteSystemFunctionCallback',
    'FUN_180067840': 'ManageMemoryBufferAllocation',
    'FUN_180067bc0': 'InitializeSystemEventHandlers',
    'FUN_180067f00': 'DestroyMutexInSitu',
    'FUN_180067f30': 'DestroyMutexInSituAlternate',
    'FUN_180067f60': 'SynchronizeDataStructures',
    'FUN_180068250': 'ProcessDataValidation',
    'FUN_180068490': 'CalculateMemoryAllocationSize',
    'FUN_180068620': 'ExecuteDataTransferOperation',
    'FUN_1800686b0': 'ReleaseSystemResources',
    'FUN_1800687d0': 'UpdateSystemConfiguration',
    'FUN_180068860': 'ProcessSystemDataTransfer',
    'FUN_180068ce0': 'ProcessCharacterVariable',
    'FUN_180068ec0': 'CoreEngineDataStructureManager',
    'FUN_180068ff0': 'InitializeTargetDataStructure',
    'FUN_180069070': 'InitializeThreadLocalStorageStructure',
    'FUN_180069130': 'CopyDataStructureStatusFlags',
    'FUN_180069190': 'ReleaseTargetDataStructure',
    'FUN_1800691e0': 'InitializeThreadLocalStorage',
    'FUN_180069220': 'ProcessDataStructureWithTimeout',
    'FUN_180069241': 'ExecuteMemoryCopyNoReturn',
    'FUN_180069266': 'InitializeByteData',
    'FUN_180069470': 'ReleaseTargetDataStructureResources',
    'FUN_180069530': 'CleanupDataStructureResources',
    'FUN_1800695a0': 'SetThreadLocalStorageTemplate',
    'FUN_1800696d0': 'InitializeDataNodeTemplate',
    'FUN_180069720': 'InitializeSystemDataStructureTemplate',
    'FUN_1800697a0': 'ProcessSystemMemoryReferenceManagement',
    'FUN_180069f00': 'ProcessDataStructureTransfer',
    'FUN_180069f60': 'ProcessDataStructureWithParameters',
    'FUN_180069fb0': 'ProcessDataStructureWithReturn',
    'FUN_18006a1c0': 'ProcessDataStructureWithCallback',
    'FUN_180070680': 'ProcessDataStructureWithSemaphore',
    'FUN_180070930': 'ProcessCoreEngineDataStructure',
    'FUN_180071940': 'ProcessDataStructureWithSource',
    
    # 网络和IO相关
    'FUN_1800ba940': 'InitializeNetworkConfiguration',
    'FUN_1800f93e0': 'ProcessNetworkTimeout',
    'FUN_1800f9600': 'ProcessNetworkCharacterData',
    'FUN_1800f98e0': 'ProcessNetworkSystemVariable',
    'FUN_1800f9ce0': 'AllocateNetworkMemory',
    'FUN_1801570c0': 'ProcessNetworkCompletion',
    'FUN_1801718f0': 'HandleNetworkError',
    'FUN_1801719d0': 'ProcessNetworkRecovery',
    'FUN_1801723a0': 'ProcessNetworkEvent',
    
    # 系统功能相关
    'FUN_180047d40': 'ProcessAudioBuffer',
    'FUN_180047d40': 'ProcessAudioBuffer',
    'FUN_1800567c0': 'ReleaseDataProcessorResource',
    'FUN_180057790': 'CleanupSystemMemoryPointers',
    'FUN_180057796': 'DecrementMemoryReferenceCount',
    'FUN_1800577f6': 'DecrementMemoryReferenceCount',
    'FUN_180057814': 'SafeReleaseMemoryReferenceCount',
    'FUN_180057830': 'ProcessSystemEventQueue',
    'FUN_1800578a0': 'CleanupSystemResources',
    'FUN_180057b00': 'ProcessDataBufferReturnPointer',
    'FUN_180057cb0': 'InitializeSystemResourcesReturnPointer',
    'FUN_180057d70': 'ProcessSystemDataWithTimeout',
    'FUN_180057e90': 'ProcessSystemDataTransfer',
    'FUN_180057ec0': 'HandleSystemDataSynchronization',
    'FUN_180057ee0': 'ExecuteSystemDataValidation',
    'FUN_180057f10': 'ProcessSystemDataConversion',
    'FUN_180057f30': 'InitializeSystemDataHandler',
    'FUN_180058000': 'ProcessSystemContextData',
    'FUN_180058080': 'FindMatchingDataNode',
    'FUN_180058160': 'ReleaseMemoryReferenceCountHandler',
    'FUN_180058826': 'InitializeCoreEngineSystemState',
    'FUN_180058830': 'CleanupCoreEngineSystemResources',
    'FUN_1800588c0': 'AdjustBufferCapacityAndProcessEvents',
    'FUN_1800588fc': 'ProcessBufferDataAndExecuteEvents',
    'FUN_18005892b': 'ExecuteSystemEventLoop',
    'FUN_18005895a': 'CleanupSystemResourceQueue',
    'FUN_180058b3e': 'AllocateAndCopyMemoryBuffer',
    'FUN_180058bfa': 'SystemReservedEmptyFunction',
    'FUN_180058c16': 'SystemInitializationFunction',
    'FUN_180059000': 'ProcessTargetDataStructure',
    'FUN_1800591c0': 'InitializeDataStructure',
    'FUN_180059230': 'CopyDataStructureWithParameters',
    'FUN_1800592e4': 'NoOperationFunction',
    'FUN_180059350': 'MoveMemoryDataBlock',
    'FUN_180059380': 'ProcessMemoryDataPointer',
    'FUN_1800594b0': 'InitializeMemoryBuffer',
    'FUN_1800590b0': 'AllocateSystemMemoryBlock',
    'FUN_180060420': 'ProcessTargetDataStructureInternal',
    'FUN_1800605d0': 'SetTargetDataStructureWithMemoryManagement',
    'FUN_180060630': 'FreeTargetDataStructureMemory',
    'FUN_1800606e0': 'InitializeSystemContext',
    'FUN_1800607f0': 'ProcessCharacterDataConversion',
    'FUN_1800609c0': 'ValidateSystemDataStatus',
    'FUN_180060a50': 'ProcessDataStructureExchangeAndBufferAllocation',
    'FUN_180060b80': 'SwapDataStructuresWithBufferManagement',
    'FUN_180060bd0': 'ExecuteTargetDataStructureCallback',
    'FUN_180060d76': 'ProcessSystemMemoryAllocation',
    'FUN_180060e22': 'GetSystemStatusFlag',
    'FUN_180060f50': 'ValidateSystemContextStatus',
    'FUN_180060fc0': 'ProcessSystemContextAndMemory',
    'FUN_1800611a0': 'ProcessSystemContextWithLock',
    'FUN_180061290': 'CloseSystemHandle',
    'FUN_1800612b0': 'InitializeSystemDataStructure',
    'FUN_180061f80': 'ProcessSystemInitialization',
    'FUN_1800622d0': 'ConfigureSystemParameters',
    'FUN_180062300': 'ProcessSystemMemoryTable',
    'FUN_180062340': 'ProcessSystemDataTransfer',
    'FUN_180062380': 'InitializeSystemMemoryBlock',
    'FUN_1800623b0': 'ConfigureSystemMemory',
    'FUN_1800623e0': 'FinalizeMemoryInitialization',
    'FUN_1800623e0': 'FinalizeMemoryInitialization',
    'FUN_1800624c0': 'InitializeSystemDataProcessor',
    'FUN_180062920': 'ProcessIntegerDataStructure',
    'FUN_1800634b0': 'FormatSystemString',
    'FUN_180063510': 'SearchAndCompareDataStructures',
    'FUN_1800635c0': 'ExecuteSystemMemoryInfoProcessor',
    'FUN_1800635e0': 'ProcessSystemMemoryInfo',
    'FUN_180063650': 'InitializeDataStructurePointers',
    'FUN_1800637c0': 'InitializeDataStructureObject',
    'FUN_1800637f0': 'InitializeSecureDataStructureObject',
    'FUN_180063820': 'ProcessSystemDataEncoding',
    'FUN_180064400': 'TerminateSystemProcess',
    'FUN_1800649d0': 'ProcessSystemDataStreamAndMemoryManagement',
    'FUN_180064c00': 'ProcessSystemDataBuffer',
    'FUN_180065160': 'ProcessSystemDataValidation',
    'FUN_180065d50': 'InitializeSystemDataProcessor',
    'FUN_180065f00': 'InitializeSystemConfiguration',
    'FUN_180066140': 'ConfigureSystemDataParameters',
    'FUN_180066320': 'ProcessCoreEngineSystemInitialization',
    'FUN_1800669c0': 'ValidateSystemCoreConfiguration',
    'FUN_180066dd0': 'SystemEmptyFunction',
    'FUN_180066df0': 'ProcessSystemDataStructureTransfer',
    'FUN_180067050': 'HandleSystemOutOfRangeException',
    'FUN_180067070': 'ReleaseTargetDataStructureMemory',
    'FUN_1800670f0': 'HandleSystemLengthErrorException',
    'FUN_180067110': 'AllocateMemoryBlock',
    'FUN_180067170': 'FreeTargetDataStructure',
    'FUN_18006720b': 'ProcessMemoryBlockAlignment',
    'FUN_1800672c0': 'ProcessEngineIOCompletionPort',
    'FUN_180067480': 'ProcessCoreEngineDataBuffer',
    'FUN_180067810': 'ExecuteSystemFunctionCallback',
    'FUN_180067840': 'ManageMemoryBufferAllocation',
    'FUN_180067bc0': 'InitializeSystemEventHandlers',
    'FUN_180067f00': 'DestroyMutexInSitu',
    'FUN_180067f30': 'DestroyMutexInSituAlternate',
    'FUN_180067f60': 'SynchronizeDataStructures',
    'FUN_180068250': 'ProcessDataValidation',
    'FUN_180068490': 'CalculateMemoryAllocationSize',
    'FUN_180068620': 'ExecuteDataTransferOperation',
    'FUN_1800686b0': 'ReleaseSystemResources',
    'FUN_1800687d0': 'UpdateSystemConfiguration',
    'FUN_180068860': 'ProcessSystemDataTransfer',
    'FUN_180068ec0': 'CoreEngineDataStructureManager',
    'FUN_180068ff0': 'InitializeTargetDataStructure',
    'FUN_180069070': 'InitializeThreadLocalStorageStructure',
    'FUN_180069130': 'CopyDataStructureStatusFlags',
    'FUN_180069190': 'ReleaseTargetDataStructure',
    'FUN_1800691e0': 'InitializeThreadLocalStorage',
    'FUN_180069220': 'ProcessDataStructureWithTimeout',
    'FUN_180069241': 'ExecuteMemoryCopyNoReturn',
    'FUN_180069266': 'InitializeByteData',
    'FUN_180069470': 'ReleaseTargetDataStructureResources',
    'FUN_180069530': 'CleanupDataStructureResources',
    'FUN_1800695a0': 'SetThreadLocalStorageTemplate',
    'FUN_1800696d0': 'InitializeDataNodeTemplate',
    'FUN_180069720': 'InitializeSystemDataStructureTemplate',
    'FUN_1800697a0': 'ProcessSystemMemoryReferenceManagement',
    'FUN_180069f00': 'ProcessDataStructureTransfer',
    'FUN_180069f60': 'ProcessDataStructureWithParameters',
    'FUN_180069fb0': 'ProcessDataStructureWithReturn',
    'FUN_18006a1c0': 'ProcessDataStructureWithCallback',
    'FUN_180070680': 'ProcessDataStructureWithSemaphore',
    'FUN_180070930': 'ProcessCoreEngineDataStructure',
    'FUN_180071940': 'ProcessDataStructureWithSource',
    
    # 其他系统函数
    'FUN_18008fd894': 'ProcessSystemSleep',
    'FUN_18008fd8b4': 'ProcessSystemWakeUp',
    'FUN_180092940': 'ProcessSystemMemoryManager',
    'FUN_1800f93e0': 'ProcessNetworkTimeout',
    'FUN_1800f9600': 'ProcessNetworkCharacterData',
    'FUN_1800f98e0': 'ProcessNetworkSystemVariable',
    'FUN_1800f9ce0': 'AllocateNetworkMemory',
    'FUN_1801570c0': 'ProcessNetworkCompletion',
    'FUN_1801718f0': 'HandleNetworkError',
    'FUN_1801719d0': 'ProcessNetworkRecovery',
    'FUN_1801723a0': 'ProcessNetworkEvent',
    
    # 内存和数据处理
    'FUN_180625690': 'ProcessSystemDataValidation',
    'FUN_180626f80': 'InitializeSystemFunctionPointer',
    'FUN_1806272a0': 'ProcessSystemTimeout',
    'FUN_180627e10': 'ProcessSystemDataConfiguration',
    'FUN_180628040': 'ProcessSystemContextConfiguration',
    'FUN_180628380': 'ProcessSystemOperation',
    'FUN_1806288c0': 'ProcessSystemIntegerData',
    'FUN_1806391a0': 'ProcessSystemMemoryData',
    'FUN_180639250': 'ReleaseSystemMemoryData',
    'FUN_18062b8b0': 'AllocateMemoryPool',
    'FUN_18062c470': 'ProcessSystemDataPointer',
    'FUN_18062da70': 'ReleaseMemoryPool',
    'FUN_18062db60': 'ProcessSystemMemoryData',
    'FUN_18066c220': 'ProcessSystemDataTransfer',
    'FUN_180627e10': 'ProcessSystemDataConfiguration',
    'FUN_180628040': 'ProcessSystemContextConfiguration',
    'FUN_180628380': 'ProcessSystemOperation',
    'FUN_1806288c0': 'ProcessSystemIntegerData',
    'FUN_1806391a0': 'ProcessSystemMemoryData',
    'FUN_180639250': 'ReleaseSystemMemoryData',
    
    # 其他辅助函数
    'FUN_18064e0d0': 'ProcessSystemDataRelease',
    'FUN_180626f80': 'InitializeSystemFunctionPointer',
    'FUN_1806272a0': 'ProcessSystemTimeout',
    'FUN_18066c220': 'ProcessSystemDataTransfer',
    'FUN_1806b940': 'ProcessSystemEventInitialization',
    'FUN_18069cc0': 'ProcessSystemMemoryAllocation',
}

def replace_function_names(content):
    """替换文件中的函数名"""
    for old_name, new_name in FUNCTION_MAPPINGS.items():
        # 替换函数调用
        content = re.sub(r'\b' + old_name + r'\b', new_name, content)
    return content

def main():
    if len(sys.argv) != 2:
        print("Usage: python batch_replace_functions.py <file_path>")
        sys.exit(1)
    
    file_path = sys.argv[1]
    
    try:
        with open(file_path, 'r', encoding='utf-8') as f:
            content = f.read()
        
        # 执行替换
        new_content = replace_function_names(content)
        
        # 写回文件
        with open(file_path, 'w', encoding='utf-8') as f:
            f.write(new_content)
        
        print(f"Successfully processed {file_path}")
        
    except Exception as e:
        print(f"Error processing {file_path}: {e}")
        sys.exit(1)

if __name__ == "__main__":
    main()