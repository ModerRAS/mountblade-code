#!/bin/bash

# 美化02_core_engine.c文件中的LAB_标签
# 此脚本将所有的LAB_标签替换为语义化的名称

echo "开始美化02_core_engine.c文件中的LAB_标签..."

# 定义一些常见标签的语义化替换
declare -A replacements=(
    ["LAB_180048f62"]="StringValidationComplete"
    ["LAB_18005122d"]="CharacterProcessingComplete"
    ["LAB_180051f8b"]="BufferProcessingStart"
    ["LAB_180051fc9"]="BufferValidationComplete"
    ["LAB_180052ce3"]="MemoryCheckComplete"
    ["LAB_180052de5"]="MemoryValidationComplete"
    ["LAB_1800535b0"]="InfiniteLoopDetected"
    ["LAB_18005364c"]="QueueProcessingComplete"
    ["LAB_180054302"]="DataProcessingComplete"
    ["LAB_18005419d"]="DataProcessingStart"
    ["LAB_18005485e"]="StackProcessingComplete"
    ["LAB_180054912"]="IndexProcessingComplete"
    ["LAB_180054ec9"]="StringValidationResult"
    ["LAB_180054d28"]="PathSeparatorFound"
    ["LAB_180054d57"]="DirectorySeparatorDetected"
    ["LAB_180056220"]="ComparisonResultMatch"
    ["LAB_180056228"]="ComparisonResultMismatch"
    ["LAB_18005726e"]="NodeProcessingComplete"
    ["LAB_180057b97"]="RangeCheckComplete"
    ["LAB_180057ba2"]="RangeValidationStart"
    ["LAB_1800580f9"]="DataValidationComplete"
    ["LAB_180058138"]="ByteProcessingComplete"
    ["LAB_1800590e2"]="LoopContinuePoint"
    ["LAB_1800591a6"]="MemoryValidationComplete"
    ["LAB_180059885"]="SystemProcessingComplete"
    ["LAB_1800602a0"]="FunctionReturnPoint"
    ["LAB_1800602f0"]="AlternativeReturnPath"
    ["LAB_18006031a"]="MainReturnPath"
    ["LAB_18006039b"]="SecondaryReturnPath"
    ["LAB_1800604d1"]="NullCheckComplete"
    ["LAB_1800607cc"]="CharacterCheckComplete"
    ["LAB_180060993"]="CharacterValidationComplete"
    ["LAB_18006357e"]="UnsignedVariableCheck"
    ["LAB_180063de9"]="ArrayComparisonMismatch"
    ["LAB_180064eed"]="LongVariableCheck"
    ["LAB_180065009"]="LongVariableValidation"
    ["LAB_180065a3e"]="IntegerVariableCheck"
    ["LAB_18006650a"]="ComparisonResultFour"
    ["LAB_180066971"]="MainComparisonPath"
    ["LAB_180066bf4"]="ComparisonFourPath"
    ["LAB_180066ec4"]="ZeroCheckComplete"
    ["LAB_180068c87"]="AlternativeBitPath"
    ["LAB_180068c92"]="BitMaskPath"
    ["LAB_180068c94"]="BitProcessingComplete"
    ["LAB_180069842"]="SecondaryNullCheck"
    ["LAB_180069c2b"]="BooleanCheckComplete"
    ["LAB_180069dc3"]="NullCharacterFound"
    ["LAB_180069dda"]="CharacterProcessingComplete"
    ["LAB_180070a3f"]="LoopEntryPoint"
    ["LAB_180070b00"]="RangeValidationComplete"
    ["LAB_1800718e9"]="AlternativeReturnPath"
    ["LAB_180070db8"]="SecondaryLoopPath"
    ["LAB_180070e64"]="FirstRangeCheck"
    ["LAB_180070ee8"]="ThirdLoopPath"
    ["LAB_180070f81"]="SecondRangeCheck"
    ["LAB_180071000"]="ThirdRangeCheck"
    ["LAB_1800710b8"]="FourthRangeCheck"
    ["LAB_18007113f"]="FifthRangeCheck"
    ["LAB_1800715eb"]="ComparisonThreePath"
    ["LAB_180071af3"]="FourthLoopPath"
    ["LAB_180071b69"]="FifthLoopPath"
    ["LAB_180071c1a"]="SixthRangeCheck"
    ["LAB_180071c93"]="SixthLoopPath"
    ["LAB_180071d1f"]="SeventhRangeCheck"
    ["LAB_180071d94"]="EighthRangeCheck"
    ["LAB_180071e34"]="NinthRangeCheck"
    ["LAB_180071eb0"]="TenthRangeCheck"
    ["LAB_180072d7b"]="ThreadStatusCheck"
    ["LAB_180072120"]="SeventhLoopPath"
    ["LAB_1800721e1"]="EleventhRangeCheck"
    ["LAB_1800722f5"]="BooleanValidationComplete"
    ["LAB_180072521"]="EighthLoopPath"
    ["LAB_1800725ac"]="NinthLoopPath"
    ["LAB_180072662"]="TwelfthRangeCheck"
    ["LAB_1800726e7"]="TenthLoopPath"
    ["LAB_180072780"]="ThirteenthRangeCheck"
    ["LAB_1800727ff"]="FourteenthRangeCheck"
    ["LAB_1800728ad"]="FifteenthRangeCheck"
    ["LAB_180072934"]="SixteenthRangeCheck"
    ["LAB_1800729bd"]="SeventeenthRangeCheck"
    ["LAB_180075f4f"]="FloatComparisonComplete"
    ["LAB_180076feb"]="BufferCheckComplete"
    ["LAB_18007738d"]="MemoryCheckComplete"
    ["LAB_180077847"]="TabCharacterCheck"
    ["LAB_180077879"]="TabCharacterFound"
    ["LAB_180077fcf"]="MemoryAllocationCheck"
    ["LAB_1800782d4"]="BitMaskCheck"
    ["LAB_1800782e0"]="BitProcessingComplete"
    ["LAB_180079c12"]="FirstLongVariableCheck"
    ["LAB_180079cd7"]="SecondLongVariableCheck"
    ["LAB_180079d9b"]="ThirdLongVariableCheck"
    ["LAB_18007a5ac"]="StackVariableCheck"
    ["LAB_18007ac04"]="FourthLongVariableCheck"
    ["LAB_180079e40"]="PointerCheckComplete"
    ["LAB_180079fb3"]="PointerValidationComplete"
    ["LAB_18007a203"]="FifthLongVariableCheck"
    ["LAB_18007a142"]="SixthLongVariableCheck"
    ["LAB_18007a312"]="ReturnPathComplete"
    ["LAB_18007a58b"]="AlternativeReturnComplete"
    ["LAB_1800802aa"]="BitFlagCheck"
    ["LAB_180082720"]="MemoryCheckComplete"
    ["LAB_180086316"]="MainProcessingPath"
    ["LAB_18008642b"]="AlternativeProcessingPath"
    ["LAB_180087337"]="DataComparisonComplete"
    ["LAB_1800872f7"]="DataComparisonPath"
    ["LAB_18008733a"]="DataValidationStart"
    ["LAB_180087418"]="ParameterValidationComplete"
    ["LAB_18008755d"]="StatusFlagCheck"
    ["LAB_18008758f"]="StatusFlagComplete"
    ["LAB_1800878e0"]="CharacterCheckComplete"
    ["LAB_18008807f"]="IntegerCheckComplete"
    ["LAB_180088131"]="MainProcessingComplete"
    ["LAB_180087f81"]="SecondaryProcessingPath"
    ["LAB_180087f16"]="SeventhLongVariableCheck"
    ["LAB_180088ac9"]="StackProcessingComplete"
    ["LAB_18008913b"]="AlternativeProcessingComplete"
    ["LAB_18008917c"]="BufferValidationComplete"
    ["LAB_1800892ba"]="DataProcessingPath"
    ["LAB_18008927d"]="DataProcessingStart"
    ["LAB_1800892bd"]="MemoryValidationStart"
    ["LAB_1800892fd"]="MemoryProcessingComplete"
    ["LAB_18008984e"]="NegativeOneCheck"
    ["LAB_1800897d5"]="IndexProcessingPath"
    ["LAB_180089861"]="IndexValidationPath"
    ["LAB_180089891"]="CharacterComparisonComplete"
    ["LAB_18008a32f"]="NodeComparisonComplete"
    ["LAB_18008a327"]="NodeComparisonPath"
    ["LAB_18008a310"]="AlternativeNodePath"
    ["LAB_18008a753"]="PathSeparatorDetected"
    ["LAB_18008a841"]="StringComparisonResult"
    ["LAB_18008acc1"]="StringProcessingComplete"
    ["LAB_18008ae5a"]="EighthLongVariableCheck"
    ["LAB_18008b3e2"]="DataBufferCheck"
    ["LAB_18008b7ea"]="BufferValidationComplete"
    ["LAB_18008c01e"]="CharacterCheckComplete"
    ["LAB_18008c531"]="PointerValidationComplete"
    ["LAB_18008cc42"]="ParentNodeCheck"
    ["LAB_18008cd70"]="BooleanValidationComplete"
    ["LAB_18008ce20"]="LongVariableCheck"
    ["LAB_18008ce85"]="NinthLongVariableCheck"
    ["LAB_18008caf0"]="BufferProcessingPath"
    ["LAB_18008cb7e"]="BufferValidationComplete"
    ["LAB_18008cdfe"]="BooleanCheckComplete"
    ["LAB_18008d51d"]="AlternativeDataPath"
    ["LAB_18008d56b"]="DataValidationComplete"
    ["LAB_18008d7a0"]="PointerCheckComplete"
    ["LAB_18008d951"]="ParameterCheckComplete"
    ["LAB_18008d9c4"]="ParameterValidationComplete"
    ["LAB_18008d9f7"]="NegativeIndexCheck"
    ["LAB_18008daa1"]="ParameterCheckPath"
    ["LAB_18008daa4"]="ParameterValidationPath"
    ["LAB_18008dde0"]="StackCheckComplete"
    ["LAB_18008e13f"]="StackProcessingComplete"
    ["LAB_18008ebc0"]="LoopEntryPoint"
    ["LAB_18008eecc"]="LoopContinuePoint"
    ["LAB_18008ef40"]="LoopExitPoint"
    ["LAB_18008efb7"]="ValidationComplete"
    ["LAB_18008ee00"]="AlternativeLoopPath"
    ["LAB_18008efcb"]="MemoryCheckComplete"
    ["LAB_18008eff7"]="ReturnPathComplete"
    ["LAB_18008f4f4"]="BufferCheckComplete"
    ["LAB_18008f669"]="StatusCheckComplete"
    ["LAB_18008fb99"]="ProcessingComplete"
    ["LAB_1800911c4"]="StatusMatchComplete"
    ["LAB_180091164"]="StatusValidationComplete"
    ["LAB_180091192"]="StatusProcessingComplete"
    ["LAB_180092bbb"]="TenthLongVariableCheck"
    ["LAB_180092c16"]="StackCheckComplete"
    ["LAB_180092e59"]="EleventhLongVariableCheck"
    ["LAB_180093089"]="TwelfthLongVariableCheck"
    ["LAB_1800932b6"]="ThirteenthLongVariableCheck"
    ["LAB_1800934cd"]="FourteenthLongVariableCheck"
    ["LAB_180093cb6"]="ProcessingPathComplete"
    ["LAB_180093e1b"]="MemoryCheckComplete"
    ["LAB_180095527"]="MainProcessingPath"
    ["LAB_18009556a"]="BufferValidationComplete"
    ["LAB_180095648"]="IntegerProcessingComplete"
    ["LAB_1800957c7"]="IntegerProcessingPath"
    ["LAB_18009580a"]="SecondaryBufferValidation"
    ["LAB_1800958e8"]="SecondaryIntegerProcessing"
    ["LAB_1800960d8"]="TertiaryIntegerPath"
    ["LAB_18009611a"]="TertiaryBufferValidation"
    ["LAB_180096990"]="DataProcessingComplete"
    ["LAB_180096a34"]="DataValidationComplete"
    ["LAB_18009662b"]="AlternativeDataPath"
    ["LAB_18009667a"]="RangeCheckComplete"
    ["LAB_180096691"]="RangeValidationComplete"
    ["LAB_1800967cd"]="PointerCheckComplete"
    ["LAB_180096e94"]="SecondaryProcessingPath"
    ["LAB_180097ca1"]="CharacterCheckComplete"
    ["LAB_180098929"]="DataBufferCheck"
    ["LAB_180098960"]="SecondaryDataCheck"
    ["LAB_18009a8d1"]="MainProcessingPath"
    ["LAB_18009a8ab"]="TertiaryDataCheck"
    ["LAB_18009abe9"]="DataProcessingComplete"
    ["LAB_18009abab"]="AlternativeDataPath"
    ["LAB_18009abec"]="DataValidationStart"
    ["LAB_18009ac35"]="DataStructureCheck"
    ["LAB_18009b417"]="BufferProcessingComplete"
    ["LAB_18009b467"]="BufferValidationComplete"
    ["LAB_18009b517"]="DataTransferComplete"
    ["LAB_18009b567"]="SecondaryBufferComplete"
    ["LAB_18009b617"]="TertiaryTransferComplete"
    ["LAB_18009b658"]="RangeValidationStart"
    ["LAB_18009b737"]="MemoryCheckComplete"
    ["LAB_18009b73a"]="MemoryValidationComplete"
    ["LAB_18009b758"]="MemoryProcessingComplete"
    ["LAB_18009b76b"]="SecondaryMemoryComplete"
    ["LAB_18009b7f7"]="MemoryTransferComplete"
    ["LAB_18009b838"]="TertiaryRangeValidation"
    ["LAB_18009b917"]="SecondaryMemoryCheck"
    ["LAB_18009b91a"]="SecondaryMemoryValidation"
    ["LAB_18009b938"]="SecondaryMemoryComplete"
    ["LAB_18009b94b"]="TertiaryMemoryComplete"
    ["LAB_18009b9d7"]="TertiaryMemoryTransfer"
    ["LAB_18009ba27"]="QuaternaryBufferComplete"
    ["LAB_18009bb27"]="QuinaryBufferComplete"
    ["LAB_18009bad7"]="QuaternaryTransferComplete"
    ["LAB_18009bdd4"]="CharacterValidationComplete"
    ["LAB_18009bdb7"]="CharacterCheckComplete"
    ["LAB_18009bdba"]="CharacterValidationPath"
    ["LAB_18009bdf2"]="BooleanCheckComplete"
    ["LAB_18009be12"]="BooleanValidationComplete"
    ["LAB_18009bf1a"]="SecondaryRangeComplete"
    ["LAB_18009be87"]="AlternativeRangePath"
    ["LAB_18009bed0"]="RangeProcessingComplete"
    ["LAB_18009c054"]="BufferValidationComplete"
    ["LAB_18009c037"]="SecondaryBufferCheck"
    ["LAB_18009c1b4"]="CharacterProcessingComplete"
    ["LAB_18009c197"]="CharacterCheckComplete"
    ["LAB_18009c19a"]="CharacterValidationPath"
    ["LAB_18009c1d2"]="SecondaryBooleanCheck"
    ["LAB_18009c1f2"]="SecondaryBooleanComplete"
    ["LAB_18009c2f7"]="TertiaryRangeComplete"
)

# 应用替换
for lab_name in "${!replacements[@]}"; do
    semantic_name="${replacements[$lab_name]}"
    echo "替换 $lab_name -> $semantic_name"
    
    # 首先替换goto语句
    sed -i "s/goto $lab_name;/goto $semantic_name; \/\/ 原始标签：$lab_name/g" /dev/shm/mountblade-code/TaleWorlds.Native/src/02_core_engine.c
    
    # 然后替换标签定义
    sed -i "s/^$lab_name:/$semantic_name: \/\/ 原始标签：$lab_name，现已重命名为$semantic_name/g" /dev/shm/mountblade-code/TaleWorlds.Native/src/02_core_engine.c
done

echo "LAB_标签美化完成！"