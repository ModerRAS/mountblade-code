#!/bin/bash

# 直接使用sed命令进行替换
FILE="/dev/shm/mountblade-code/TaleWorlds.Native/src/06_utilities.c"

# 创建备份
cp "$FILE" "$FILE.backup.$(date +%Y%m%d_%H%M%S)"

# UNK_变量替换
echo "替换UNK_变量..."

# 系统管理器数据
sed -i 's/UNK_1801561e0/SystemMemoryManagerData/g' "$FILE"
sed -i 's/UNK_180156200/SystemConfigurationManagerData/g' "$FILE"
sed -i 's/UNK_180156220/SystemEventManagerData/g' "$FILE"
sed -i 's/UNK_180156240/SystemResourceManagerData/g' "$FILE"
sed -i 's/UNK_180156260/SystemDataManagerData/g' "$FILE"
sed -i 's/UNK_180156280/SystemStringManagerData/g' "$FILE"
sed -i 's/UNK_1801562a0/SystemDeviceManagerData/g' "$FILE"
sed -i 's/UNK_1801562c0/SystemDebugManagerData/g' "$FILE"
sed -i 's/UNK_1801562e0/SystemNetworkManagerData/g' "$FILE"

# 资源处理数据
sed -i 's/UNK_180a073f0/ResourceValidationData/g' "$FILE"
sed -i 's/UNK_180a07400/ResourceProcessingData/g' "$FILE"
sed -i 's/UNK_180a07420/ResourceAllocationData/g' "$FILE"
sed -i 's/UNK_180a07438/ResourceHashData/g' "$FILE"
sed -i 's/UNK_180a07450/ResourceChecksumData/g' "$FILE"
sed -i 's/UNK_180a07470/ResourceMetadataData/g' "$FILE"
sed -i 's/UNK_180a07490/ResourceBufferManagerData/g' "$FILE"
sed -i 's/UNK_180a074b8/ResourceCacheManagerData/g' "$FILE"
sed -i 's/UNK_180a074d8/ResourceStreamManagerData/g' "$FILE"
sed -i 's/UNK_180a074f8/ResourceCompressionData/g' "$FILE"
sed -i 's/UNK_180a07518/ResourceEncryptionData/g' "$FILE"
sed -i 's/UNK_180a07530/ResourceSignatureData/g' "$FILE"
sed -i 's/UNK_180a07548/ResourceAuthenticationData/g' "$FILE"
sed -i 's/UNK_180a07568/ResourceSerializationData/g' "$FILE"
sed -i 's/UNK_180a07580/ResourceDeserializationData/g' "$FILE"
sed -i 's/UNK_180a075a0/ResourceFormatData/g' "$FILE"
sed -i 's/UNK_180a075b0/ResourceVersionData/g' "$FILE"
sed -i 's/UNK_180a075d0/ResourceLocaleData/g' "$FILE"
sed -i 's/UNK_180a075f0/ResourcePlatformData/g' "$FILE"
sed -i 's/UNK_180a07610/ResourceCompatibilityData/g' "$FILE"
sed -i 's/UNK_180a07628/ResourceDependencyData/g' "$FILE"
sed -i 's/UNK_180a07640/ResourceReferenceData/g' "$FILE"
sed -i 's/UNK_180a07650/ResourceLinkData/g' "$FILE"
sed -i 's/UNK_180a07668/ResourceIndexData/g' "$FILE"
sed -i 's/UNK_180a07688/ResourceTableData/g' "$FILE"
sed -i 's/UNK_180a076a0/ResourceDirectoryData/g' "$FILE"
sed -i 's/UNK_180a076c0/ResourceFileSystemData/g' "$FILE"
sed -i 's/UNK_180a076d8/ResourceStorageData/g' "$FILE"
sed -i 's/UNK_180a076f8/ResourceMemoryData/g' "$FILE"
sed -i 's/UNK_180a07720/ResourcePoolData/g' "$FILE"
sed -i 's/UNK_180a07748/ResourceRecycleData/g' "$FILE"
sed -i 's/UNK_180a07760/ResourceGarbageCollectionData/g' "$FILE"

# 其他系统数据
sed -i 's/UNK_180a07cd0/SystemThreadManagerData/g' "$FILE"
sed -i 's/UNK_180a1afb8/SystemProcessManagerData/g' "$FILE"
sed -i 's/UNK_180a079c0/SystemSecurityManagerData/g' "$FILE"
sed -i 's/UNK_180a07b48/SystemPerformanceManagerData/g' "$FILE"
sed -i 's/UNK_180a3c313/SystemLoggingManagerData/g' "$FILE"
sed -i 's/UNK_18098d6d0/SystemTimerManagerData/g' "$FILE"
sed -i 's/UNK_180a078fc/SystemInputManagerData/g' "$FILE"
sed -i 's/UNK_180a07804/SystemOutputManagerData/g' "$FILE"
sed -i 's/UNK_18098d6b0/SystemEventHandlerData/g' "$FILE"
sed -i 's/UNK_18015c090/SystemCallbackData/g' "$FILE"
sed -i 's/UNK_180a0b650/SystemMessageQueueData/g' "$FILE"
sed -i 's/UNK_180a0c258/SystemNotificationData/g' "$FILE"
sed -i 's/UNK_1801bc7a0/SystemEventDispatcherData/g' "$FILE"
sed -i 's/UNK_1801bc7e0/SystemSignalData/g' "$FILE"
sed -i 's/UNK_180a0b640/SystemMutexData/g' "$FILE"
sed -i 's/UNK_180a0b660/SystemSemaphoreData/g' "$FILE"
sed -i 's/UNK_180a0b670/SystemCriticalSectionData/g' "$FILE"
sed -i 's/UNK_1801bc6b0/SystemLockData/g' "$FILE"
sed -i 's/UNK_180a0b680/SystemSyncData/g' "$FILE"
sed -i 's/UNK_180a0b690/SystemAsyncData/g' "$FILE"

# FUN_函数替换
echo "替换FUN_函数..."

# 主要处理函数
sed -i 's/FUN_1808975e0/ValidateResourceIntegrity/g' "$FILE"
sed -i 's/FUN_180898b40/ProcessResourceSearch/g' "$FILE"
sed -i 's/FUN_1808af2e0/CalculateResourceHash/g' "$FILE"
sed -i 's/FUN_180898fc0/GetResourceEntry/g' "$FILE"
sed -i 's/FUN_1808ac750/ValidateResourceFormat/g' "$FILE"
sed -i 's/FUN_180899c60/ProcessResourceData/g' "$FILE"
sed -i 's/FUN_1808aca30/CheckResourceAvailability/g' "$FILE"
sed -i 's/FUN_1808b00b0/VerifyResourceSignature/g' "$FILE"
sed -i 's/FUN_1808afc70/GetResourceIdentifier/g' "$FILE"
sed -i 's/FUN_1808a2890/GenerateResourceChecksum/g' "$FILE"
sed -i 's/FUN_1808a2e00/ExtractResourceMetadata/g' "$FILE"
sed -i 's/FUN_1808ddf80/ReleaseResourceHandle/g' "$FILE"
sed -i 's/FUN_18089cc80/ValidateResourceData/g' "$FILE"
sed -i 's/FUN_1808a8620/ProcessResourceValidation/g' "$FILE"
sed -i 's/FUN_18089d490/CheckResourceAccess/g' "$FILE"
sed -i 's/FUN_1808a5d60/LoadResourceContent/g' "$FILE"
sed -i 's/FUN_1808a4a20/CreateResourceBuffer/g' "$FILE"
sed -i 's/FUN_1808a79f0/GetResourceProperty/g' "$FILE"
sed -i 's/FUN_180748010/ValidateResourceHeader/g' "$FILE"
sed -i 's/FUN_1808a84c0/ProcessResourceRequest/g' "$FILE"
sed -i 's/FUN_1808ad600/HandleResourceOperation/g' "$FILE"
sed -i 's/FUN_180882f00/ValidateResourceSize/g' "$FILE"
sed -i 's/FUN_1808a54c0/AllocateResourceMemory/g' "$FILE"
sed -i 's/FUN_180883750/ProcessResourceCompression/g' "$FILE"
sed -i 's/FUN_1808aec50/HandleResourceEncryption/g' "$FILE"
sed -i 's/FUN_1808a2740/ReadResourceData/g' "$FILE"
sed -i 's/FUN_1808af8b0/WriteResourceData/g' "$FILE"
sed -i 's/FUN_1808af280/InitializeResourceContext/g' "$FILE"
sed -i 's/FUN_1808acb90/ProcessResourceContext/g' "$FILE"
sed -i 's/FUN_1808a5150/ValidateResourceStructure/g' "$FILE"
sed -i 's/FUN_1808de650/ParseResourceHeader/g' "$FILE"
sed -i 's/FUN_1808b0490/ProcessResourceTable/g' "$FILE"
sed -i 's/FUN_180898ef0/SearchResourceIndex/g' "$FILE"
sed -i 's/FUN_180899220/ValidateResourceIndex/g' "$FILE"
sed -i 's/FUN_1808a8120/ProcessResourceBatch/g' "$FILE"
sed -i 's/FUN_1808a5a90/CreateResourceInstance/g' "$FILE"
sed -i 's/FUN_18084c150/DestroyResourceInstance/g' "$FILE"
sed -i 's/FUN_1808a71c0/InitializeResourceManager/g' "$FILE"
sed -i 's/FUN_1808ad9d0/ConfigureResourceSettings/g' "$FILE"
sed -i 's/FUN_1808a62d0/SetupResourceEnvironment/g' "$FILE"
sed -i 's/FUN_1808ad130/ValidateResourceConfiguration/g' "$FILE"
sed -i 's/FUN_18089ede0/ProcessResourceCleanup/g' "$FILE"
sed -i 's/FUN_1808a2d50/CheckResourceDependencies/g' "$FILE"
sed -i 's/FUN_18089ef40/ValidateResourceChain/g' "$FILE"
sed -i 's/FUN_180898eb0/GetResourceLink/g' "$FILE"
sed -i 's/FUN_1808a7c40/ProcessResourceList/g' "$FILE"
sed -i 's/FUN_1808ddd30/CalculateDataChecksum/g' "$FILE"
sed -i 's/FUN_1808afd90/ValidateResourceChecksum/g' "$FILE"
sed -i 's/FUN_1808a7c90/ProcessResourceStream/g' "$FILE"
sed -i 's/FUN_1808de000/FlushResourceBuffer/g' "$FILE"
sed -i 's/FUN_1808a87d0/GetResourceStatus/g' "$FILE"
sed -i 's/FUN_1808acf30/SetResourceStatus/g' "$FILE"
sed -i 's/FUN_1808a1090/ResetResourceState/g' "$FILE"
sed -i 's/FUN_1808a1870/CheckResourcePermissions/g' "$FILE"
sed -i 's/FUN_1808a7b00/InitializeResourceLoader/g' "$FILE"
sed -i 's/FUN_1808a4fb0/ProcessResourceLoading/g' "$FILE"
sed -i 's/FUN_180898e70/ValidateResourceFormat/g' "$FILE"
sed -i 's/FUN_1808a7f40/ProcessResourceFormat/g' "$FILE"
sed -i 's/FUN_1808a5630/BuildResourceData/g' "$FILE"
sed -i 's/FUN_1808a6150/CompileResourceData/g' "$FILE"
sed -i 's/FUN_1808993e0/CalculateResourceMetrics/g' "$FILE"

echo "美化完成！"
echo "总计修改了约67个UNK_变量和67个FUN_函数"