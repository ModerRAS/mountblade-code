#!/bin/bash

# 00_data_definitions.h 变量重命名脚本
# 用于批量重命名未知变量为语义化名称

# 定义重命名映射
declare -A RENAME_MAP=(
    # UnknownData 变量
    ["UnknownData1809fdc18"]="SystemStringDataTemplate"
    ["UnknownData180a004e8"]="StringProcessorATemplate"
    ["UnknownData180a004f8"]="StringProcessorBTemplate"
    ["unknownData_1809fdc18"]="StringProcessorDataTemplate"
    ["unknownData_180a00508"]="StringProcessorCTemplate"
    ["unknownData_180a00518"]="StringProcessorDTemplate"
    ["unknownData_180a00528"]="StringProcessorETemplate"
    ["unknownData_180a00538"]="StringProcessorFTemplate"
    ["UnknownData1809fcc58"]="ModuleStringDataTemplate"
    ["UnknownData180a22c48"]="ModuleStringTemplateA"
    ["UnknownData180a22c30"]="ModuleStringTemplateB"
    ["UnknownData180a22c18"]="ModuleStringTemplateC"
    ["UnknownData180a22c00"]="ModuleStringTemplateD"
    ["UnknownData180a22c98"]="ModuleStringTemplateE"
    ["UnknownData180a3c3e0"]="SystemMemoryBufferTemplate"
    ["GlobalUnknownDataBase"]="SystemStringDataBase"
    
    # UNK_ 变量
    ["UNK_180a0cb48"]="SystemConfigStringA"
    ["UNK_180a0cb80"]="SystemConfigStringB"
    ["UNK_180a0cb90"]="SystemConfigStringC"
    ["UNK_180a0cb60"]="SystemConfigStringD"
    ["UNK_180a0cb70"]="SystemConfigStringE"
    ["UNK_180a0cbe0"]="SystemConfigStringF"
    ["UNK_180a0cbf0"]="SystemConfigStringG"
    ["UNK_180a0cba8"]="SystemConfigStringH"
    ["UNK_180a05740"]="SystemConfigStringI"
    ["UNK_180a0cbc8"]="SystemConfigStringJ"
    ["UNK_180a0cc30"]="SystemConfigStringK"
    ["UNK_180a0cc48"]="SystemConfigStringL"
    ["UNK_180a0cc08"]="SystemConfigStringM"
    ["UNK_180a0cc10"]="SystemConfigStringN"
    ["UNK_180a0cca0"]="SystemConfigStringO"
    ["UNK_180a0ccb8"]="SystemConfigStringP"
    ["UNK_180a0cc68"]="SystemConfigStringQ"
    ["UNK_180a0cc88"]="SystemConfigStringR"
    ["UNK_180a0cd08"]="SystemConfigStringS"
    ["UNK_180a0cd28"]="SystemConfigStringT"
    ["UNK_180a0ccd0"]="SystemConfigStringU"
    ["UNK_180a0ccf0"]="SystemConfigStringV"
    ["UNK_180a0cd70"]="SystemConfigStringW"
    ["UNK_180a0cd88"]="SystemConfigStringX"
    ["UNK_180a0cd40"]="SystemConfigStringY"
    ["UNK_180a0cd58"]="SystemConfigStringZ"
    ["UNK_180a0cdc8"]="SystemConfigStringAA"
    ["UNK_180a0cde0"]="SystemConfigStringBB"
    ["UNK_180a0cd98"]="SystemConfigStringCC"
    ["UNK_180a0cdb0"]="SystemConfigStringDD"
    ["UNK_180a0ce40"]="SystemConfigStringEE"
    ["UNK_180a01300"]="SystemConfigTemplate13"
    ["UNK_180a01330"]="SystemConfigTemplate14"
    ["UNK_180a22b38"]="SystemConfigTemplate15"
    ["UNK_180a22c70"]="ModuleConfigStringA"
    ["UNK_180a22c58"]="ModuleConfigStringB"
    ["UNK_180a22d28"]="ModuleConfigStringC"
    ["UNK_180a22d08"]="ModuleConfigStringD"
    ["UNK_180a22ce8"]="ModuleConfigStringE"
    ["UNK_180a22cc8"]="ModuleConfigStringF"
    ["UNK_180a22db0"]="ModuleConfigStringG"
    ["UNK_180a22d88"]="ModuleConfigStringH"
    ["UNK_180a22d68"]="ModuleConfigStringI"
    ["UNK_180a22e40"]="ModuleConfigStringJ"
    ["UNK_180a22e20"]="ModuleConfigStringK"
    ["UNK_180a22df8"]="ModuleConfigStringL"
    ["UNK_180a22dd0"]="ModuleConfigStringM"
    ["UNK_180a22eb0"]="ModuleConfigStringN"
    ["UNK_180a22e90"]="ModuleConfigStringO"
    ["UNK_180a22e70"]="ModuleConfigStringP"
    ["UNK_180a22e58"]="ModuleConfigStringQ"
    ["UNK_180a22f28"]="ModuleConfigStringR"
    ["UNK_180a22f10"]="ModuleConfigStringS"
    ["UNK_180a22ef8"]="ModuleConfigStringT"
    ["UNK_180a22ed8"]="ModuleConfigStringU"
    ["UNK_180a0f5b8"]="NetworkConfigStringA"
    ["UNK_180a0f190"]="NetworkConfigStringB"
    ["UNK_180a0f168"]="NetworkConfigStringC"
    ["UNK_180a0f188"]="NetworkConfigStringD"
    ["UNK_180a0f178"]="NetworkConfigStringE"
    ["UNK_180a24c50"]="NetworkConfigStringF"
    ["UNK_180a24c60"]="NetworkConfigStringG"
    ["UNK_180a24bd0"]="NetworkConfigStringH"
    ["UNK_180a24bf0"]="NetworkConfigStringI"
    ["UNK_180a24c10"]="NetworkConfigStringJ"
    ["UNK_180a24c30"]="NetworkConfigStringK"
    ["UNK_180a24d58"]="NetworkConfigStringL"
    ["UNK_180a24d80"]="NetworkConfigStringM"
    ["UNK_180a24da8"]="NetworkConfigStringN"
    ["UNK_180a24dc0"]="NetworkConfigStringO"
    ["UNK_180a27a58"]="FileSystemConfigStringA"
    ["UNK_180a27a6c"]="FileSystemConfigStringB"
    ["UNK_180a27a70"]="FileSystemConfigStringC"
    ["UNK_1809fd160"]="SystemConstantA"
    ["UNK_1809fd170"]="SystemConstantB"
    ["UNK_1809fd180"]="SystemConstantC"
    ["UNK_1809fd190"]="SystemConstantD"
    ["UNK_1809fd1a0"]="SystemConstantE"
    ["UNK_1809fd1b0"]="SystemConstantF"
    ["UNK_1809fd1c0"]="SystemConstantG"
    ["UNK_1809fd1d8"]="SystemConstantH"
    ["UNK_1809fd1f0"]="SystemConstantI"
    ["UNK_1809fd208"]="SystemConstantJ"
    ["UNK_1809fd220"]="SystemConstantK"
    ["UNK_1809fd238"]="SystemConstantL"
    ["UNK_1809fd250"]="SystemConstantM"
    ["UNK_1809fd260"]="SystemConstantN"
    ["UNK_1809fd270"]="SystemConstantO"
    ["UNK_1809fd288"]="SystemConstantP"
    ["UNK_1809fd298"]="SystemConstantQ"
    ["UNK_1809fd2a8"]="SystemConstantR"
    ["UNK_1809fd2c0"]="SystemConstantS"
    ["UNK_1809fd318"]="SystemConstantT"
    ["UNK_1809fd328"]="SystemConstantU"
    ["UNK_1809fd340"]="SystemConstantV"
    ["UNK_1809fd368"]="SystemConstantW"
    ["UNK_1809fd380"]="SystemConstantX"
    ["UNK_1809fd398"]="SystemConstantY"
    ["UNK_1809fd3f0"]="SystemConstantZ"
    ["UNK_1809fd3c8"]="SystemConstantAA"
    ["UNK_1809fd4b8"]="SystemConstantBB"
    ["UNK_1809fd8c0"]="SystemConstantCC"
    ["UNK_1809fd8d8"]="SystemConstantDD"
    ["UNK_1809fd910"]="SystemConstantEE"
    ["UNK_1809fd930"]="SystemConstantFF"
    ["UNK_1809fd950"]="SystemConstantGG"
    ["UNK_1809fd970"]="SystemConstantHH"
    ["UNK_1809fd980"]="SystemConstantII"
    ["UNK_1809fdfc0"]="SystemConstantJJ"
    ["UNK_180a0ad28"]="SystemConstantKK"
    ["UNK_180a3c3e0"]="SystemMemoryBuffer"
    ["UNK_1809fc7b8"]="SystemConstantLL"
    ["UNK_1809fe1b0"]="SystemConstantMM"
    ["UNK_1809fe1c8"]="SystemConstantNN"
    ["UNK_1809fe1d8"]="SystemConstantOO"
    ["UNK_1809fe1b0"]="SystemConstantPP"
    ["UNK_1809ff2f8"]="SystemConstantQQ"
    ["UNK_1809417e0"]="SystemFunctionPointerA"
    ["UNK_180941ab0"]="SystemFunctionPointerB"
    ["UNK_1809fd7b8"]="SystemConstantRR"
    ["UNK_1809fd7c8"]="SystemConstantSS"
    ["UNK_1809fd7d8"]="SystemConstantTT"
    ["UNK_1809fd7e8"]="SystemConstantUU"
    ["UNK_1809fd7f8"]="SystemConstantVV"
    ["UNK_1809fd808"]="SystemConstantWW"
    ["UNK_1809fd818"]="SystemConstantXX"
    ["UNK_1809fd828"]="SystemConstantYY"
    ["UNK_1809fd838"]="SystemConstantZZ"
    ["UNK_180a04910"]="SystemMemoryAddressA"
    ["UNK_180639070"]="SystemFunctionAddressA"
    ["UNK_180a0c2b8"]="SystemPointerArrayA"
    ["UNK_180049530"]="SystemFunctionPointerC"
    ["UNK_1801bc840"]="SystemMemoryAddressB"
    ["UNK_1801bc820"]="SystemMemoryAddressC"
    ["UNK_180a177f0"]="NetworkConfigAddressA"
    ["UNK_180a17770"]="NetworkConfigAddressB"
    ["UNK_180a17798"]="NetworkConfigAddressC"
)

# DAT_ 变量
declare -A DAT_RENAME_MAP=(
    ["DAT_180bf7ea8"]="SystemConfigBufferA"
    ["DAT_180bf7f00"]="SystemConfigBufferB"
    ["DAT_180bf7f58"]="SystemConfigBufferC"
    ["DAT_180bf7fb0"]="SystemConfigBufferD"
    ["DAT_180bf8008"]="SystemConfigBufferE"
    ["DAT_180bf8060"]="SystemConfigBufferF"
    ["DAT_180bf80b8"]="SystemConfigBufferG"
    ["DAT_180bf8110"]="SystemConfigBufferH"
    ["DAT_180bf8168"]="SystemConfigBufferI"
    ["DAT_180bf81c0"]="SystemConfigBufferJ"
    ["DAT_180bf8218"]="SystemConfigBufferK"
    ["DAT_180bf82c8"]="SystemConfigBufferL"
    ["DAT_180bf8320"]="SystemConfigBufferM"
    ["DAT_180bf8378"]="SystemConfigBufferN"
    ["DAT_180bf83d0"]="SystemConfigBufferO"
    ["DAT_180bf8428"]="SystemConfigBufferP"
    ["DAT_180bf8480"]="SystemConfigBufferQ"
    ["DAT_180bf84d8"]="SystemConfigBufferR"
    ["DAT_180bf8530"]="SystemConfigBufferS"
    ["DAT_180bf8588"]="SystemConfigBufferT"
    ["DAT_180bf85e0"]="SystemConfigBufferU"
    ["DAT_180bf8638"]="SystemConfigBufferV"
    ["DAT_180bf86e8"]="SystemConfigBufferW"
    ["DAT_180bf8740"]="SystemConfigBufferX"
    ["DAT_180bf8798"]="SystemConfigBufferY"
    ["DAT_180bf87f0"]="SystemConfigBufferZ"
    ["DAT_180bf8848"]="SystemConfigBufferAA"
    ["DAT_180bf88a0"]="SystemConfigBufferBB"
    ["DAT_180bf88f8"]="SystemConfigBufferCC"
    ["DAT_180bf8950"]="SystemConfigBufferDD"
    ["DAT_180bf90c8"]="ModuleConfigBufferA"
    ["DAT_180bf91c8"]="ModuleConfigBufferB"
    ["DAT_180bf9768"]="ModuleConfigBufferC"
    ["DAT_180bf97c8"]="ModuleConfigBufferD"
    ["DAT_180bf9828"]="ModuleConfigBufferE"
    ["DAT_180bf9888"]="ModuleConfigBufferF"
    ["DAT_180bf99a8"]="ModuleConfigBufferG"
    ["DAT_180bf9a08"]="ModuleConfigBufferH"
    ["DAT_180bf9a68"]="ModuleConfigBufferI"
    ["DAT_180bf9b28"]="ModuleConfigBufferJ"
    ["DAT_180bf9b88"]="ModuleConfigBufferK"
    ["DAT_180bf9be8"]="ModuleConfigBufferL"
    ["DAT_180bf9c48"]="ModuleConfigBufferM"
    ["DAT_180bf9ca8"]="ModuleConfigBufferN"
    ["DAT_180bf9d08"]="ModuleConfigBufferO"
    ["DAT_180bf9d68"]="ModuleConfigBufferP"
    ["DAT_180bf9dc8"]="ModuleConfigBufferQ"
    ["DAT_180bf9e28"]="ModuleConfigBufferR"
    ["DAT_180bf9e88"]="ModuleConfigBufferS"
    ["DAT_180bf9ee8"]="ModuleConfigBufferT"
    ["DAT_180bf9f48"]="ModuleConfigBufferU"
    ["DAT_180bfa368"]="NetworkConfigBufferA"
    ["DAT_180bfa400"]="NetworkConfigBufferB"
    ["DAT_180bfa498"]="NetworkConfigBufferC"
    ["DAT_180bfa530"]="NetworkConfigBufferD"
    ["DAT_180bfa5c8"]="NetworkConfigBufferE"
    ["DAT_180bfa660"]="NetworkConfigBufferF"
    ["DAT_180bfa6f8"]="NetworkConfigBufferG"
    ["DAT_180bfa798"]="NetworkConfigBufferH"
    ["DAT_180bfa830"]="NetworkConfigBufferI"
    ["DAT_180bfa8c8"]="NetworkConfigBufferJ"
    ["DAT_180bfa960"]="NetworkConfigBufferK"
    ["DAT_180bfa9f8"]="NetworkConfigBufferL"
    ["DAT_180bfaa90"]="NetworkConfigBufferM"
    ["DAT_180bfab28"]="NetworkConfigBufferN"
    ["DAT_180bfabc0"]="NetworkConfigBufferO"
    ["DAT_180bfac58"]="NetworkConfigBufferP"
    ["DAT_180bfacf0"]="NetworkConfigBufferQ"
    ["DAT_180bfad88"]="NetworkConfigBufferR"
    ["DAT_180bfae20"]="NetworkConfigBufferS"
    ["DAT_180bfaf08"]="FileSystemConfigBufferA"
    ["DAT_180bfb328"]="FileSystemConfigBufferB"
    ["DAT_180bfb748"]="FileSystemConfigBufferC"
    ["DAT_180bf6060"]="SystemTemplateBufferA"
    ["DAT_180bf64b0"]="SystemTemplateBufferB"
    ["DAT_180bf6510"]="SystemTemplateBufferC"
    ["DAT_180bf6570"]="SystemTemplateBufferD"
    ["DAT_18098bc73"]="SystemStringBufferA"
    ["DAT_180d49158"]="SystemDataTableA"
    ["DAT_180d49288"]="SystemDataTableB"
    ["DAT_18098bc48"]="SystemDataBufferA"
)

# FUN_ 函数
declare -A FUN_RENAME_MAP=(
    ["FUN_180626f80"]="InitializeSystemDataBuffer"
    ["FUN_1806277c0"]="CopySystemDataBuffer"
    ["FUN_18064e900"]="ProcessSystemDataBuffer"
    ["FUN_1806298d0"]="CreateSystemDataBuffer"
    ["FUN_180629a40"]="ConfigureSystemDataBuffer"
    ["FUN_18062c1e0"]="FinalizeSystemDataBuffer"
    ["FUN_1806289a0"]="InitializeSystemBufferA"
    ["FUN_180628a40"]="InitializeSystemBufferB"
    ["FUN_18062b420"]="AllocateSystemMemory"
    ["FUN_18064e990"]="ValidateSystemMemory"
    ["FUN_180628ca0"]="GetSystemBufferSize"
    ["FUN_1808fc050"]="CalculateSystemChecksum"
    ["FUN_18066bdc0"]="ProcessSystemModule"
    ["FUN_180627ae0"]="InitializeSystemModule"
    ["FUN_180125780"]="InitializeCoreSystem"
    ["FUN_1801299b0"]="InitializeSystemComponent"
    ["FUN_18010f010"]="ConfigureSystemComponent"
    ["FUN_180114450"]="RegisterSystemComponent"
    ["FUN_18012cfe0"]="FinalizeSystemComponent"
    ["FUN_180194a50"]="ProcessModuleInitialization"
    ["FUN_18016bdb0"]="InitializeModuleContext"
    ["FUN_18016c970"]="ConfigureModuleContext"
    ["FUN_180629020"]="ReleaseSystemResources"
    ["FUN_180096b60"]="InitializeFileSystem"
    ["FUN_1801ff450"]="InitializeFileSystemComponent"
    ["FUN_1801fffd0"]="FinalizeFileSystemComponent"
    ["FUN_180291500"]="ProcessNetworkModule"
    ["FUN_18011fab0"]="InitializeNetworkComponent"
    ["FUN_180127860"]="FinalizeNetworkComponent"
    ["FUN_1800496b0"]="ProcessNetworkData"
    ["FUN_1800da760"]="InitializeNetworkConnection"
    ["FUN_18005e890"]="CreateNetworkContext"
    ["FUN_18005ce30"]="ConfigureNetworkContext"
    ["FUN_1808fc820"]="InitializeSystemFunctionA"
    ["FUN_1808fcb30"]="InitializeSystemFunctionB"
    ["FUN_18006b640"]="CreateSystemContext"
    ["FUN_18005e110"]="ConfigureSystemContext"
    ["FUN_1800466d0"]="ProcessSystemContext"
    ["FUN_1801ab660"]="InitializeSystemModuleA"
    ["FUN_180046190"]="InitializeSystemModuleB"
    ["FUN_1801b9a40"]="ConfigureSystemModule"
    ["FUN_180075ff0"]="ProcessSystemTask"
    ["FUN_180077750"]="FinalizeSystemTask"
    ["FUN_180624a00"]="ValidateSystemData"
    ["FUN_18062c5f0"]="ProcessSystemDataA"
    ["FUN_180179aa0"]="CreateSystemDataStructure"
    ["FUN_180624af0"]="ProcessSystemDataB"
    ["FUN_1800588c0"]="ConfigureSystemData"
    ["FUN_18005d580"]="FinalizeSystemData"
    ["FUN_18004b790"]="ProcessSystemConfiguration"
    ["FUN_1801ebff0"]="CreateSystemConfiguration"
    ["FUN_1801ec160"]="ConfigureSystemConfiguration"
    ["FUN_1801ec300"]="FinalizeSystemConfiguration"
    ["FUN_18034dd30"]="InitializeNetworkModuleA"
    ["FUN_1804055e0"]="InitializeNetworkModuleB"
    ["FUN_18062b420"]="AllocateNetworkMemory"
    ["FUN_180068a90"]="InitializeNetworkConnection"
    ["FUN_180060680"]="ConfigureNetworkConnection"
    ["FUN_1802a41e0"]="ProcessNetworkDataA"
    ["FUN_1802a4590"]="ProcessNetworkDataB"
    ["FUN_1800c4960"]="InitializeNetworkComponentA"
    ["FUN_1800c4da0"]="InitializeNetworkComponentB"
    ["FUN_1801efe50"]="InitializeNetworkSystem"
    ["FUN_1801f01c0"]="FinalizeNetworkSystem"
)

# 处理文件
INPUT_FILE="/dev/shm/mountblade-code/TaleWorlds.Native/src/00_data_definitions.h"
TEMP_FILE="/tmp/00_data_definitions_temp.h"

# 创建临时文件
cp "$INPUT_FILE" "$TEMP_FILE"

# 执行重命名 - UnknownData 和 UNK_ 变量
for old_name in "${!RENAME_MAP[@]}"; do
    new_name="${RENAME_MAP[$old_name]}"
    echo "重命名: $old_name -> $new_name"
    sed -i "s/\b$old_name\b/$new_name/g" "$TEMP_FILE"
done

# 执行重命名 - DAT_ 变量
for old_name in "${!DAT_RENAME_MAP[@]}"; do
    new_name="${DAT_RENAME_MAP[$old_name]}"
    echo "重命名: $old_name -> $new_name"
    sed -i "s/\b$old_name\b/$new_name/g" "$TEMP_FILE"
done

# 执行重命名 - FUN_ 函数
for old_name in "${!FUN_RENAME_MAP[@]}"; do
    new_name="${FUN_RENAME_MAP[$old_name]}"
    echo "重命名: $old_name -> $new_name"
    sed -i "s/\b$old_name\b/$new_name/g" "$TEMP_FILE"
done

# 替换文件
mv "$TEMP_FILE" "$INPUT_FILE"

echo "重命名完成"