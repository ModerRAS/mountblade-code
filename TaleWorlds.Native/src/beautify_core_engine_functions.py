#!/usr/bin/env python3
# -*- coding: utf-8 -*-

import re
import sys

def beautify_core_engine_functions(file_path):
    """
    美化02_core_engine.c文件中的FUN_函数名
    根据函数的功能和上下文给它们起更有意义的名字
    """
    
    # 读取文件内容
    with open(file_path, 'r', encoding='utf-8') as f:
        content = f.read()
    
    # 函数名映射字典
    function_mappings = {
        'FUN_1800391a0': 'CoreEngineInitializeSystemConnectionTemplateF',
        'FUN_1800392a0': 'CoreEngineInitializeSystemConnectionTemplateG',
        'FUN_1800393a0': 'CoreEngineInitializeSystemConnectionTemplateH',
        'FUN_1800394a0': 'CoreEngineInitializeSystemConnectionTemplateI',
        'FUN_1800395a0': 'CoreEngineInitializeSystemConnectionTemplateJ',
        'FUN_1800396a0': 'CoreEngineInitializeSystemConnectionTemplateK',
        'FUN_1800397a0': 'CoreEngineInitializeSystemConnectionTemplateL',
        'FUN_1800398a0': 'CoreEngineInitializeSystemConnectionTemplateM',
        'FUN_1800399a0': 'CoreEngineInitializeSystemConnectionTemplateN',
        'FUN_180039aa0': 'CoreEngineInitializeSystemConnectionTemplateO',
        'FUN_180039bb0': 'CoreEngineInitializeSystemConnectionTemplateP',
        'FUN_180039cb0': 'CoreEngineInitializeSystemConnectionTemplateQ',
        'FUN_180039db0': 'CoreEngineInitializeSystemConnectionTemplateR',
        'FUN_180039eb0': 'CoreEngineInitializeSystemConnectionTemplateS',
        'FUN_180039fb0': 'CoreEngineInitializeSystemConnectionTemplateT',
        'FUN_1800404b0': 'CoreEngineInitializeMemoryNodeA',
        'FUN_1800405b0': 'CoreEngineInitializeMemoryNodeB',
        'FUN_1800406b0': 'CoreEngineInitializeMemoryNodeC',
        'FUN_1800408d0': 'CoreEngineInitializeMemoryNodeD',
        'FUN_1800409d0': 'CoreEngineInitializeMemoryNodeE',
        'FUN_180040ae0': 'CoreEngineInitializeMemoryNodeF',
        'FUN_180040be0': 'CoreEngineInitializeMemoryNodeG',
        'FUN_180040ce0': 'CoreEngineInitializeMemoryNodeH',
        'FUN_180040de0': 'CoreEngineInitializeMemoryNodeI',
        'FUN_180040fe0': 'CoreEngineInitializeMemoryNodeJ',
        'FUN_1800410e0': 'CoreEngineInitializeMemoryNodeK',
        'FUN_1800411e0': 'CoreEngineInitializeMemoryNodeL',
        'FUN_1800414e0': 'CoreEngineInitializeSystemConnectionTemplateU',
        'FUN_1800415e0': 'CoreEngineInitializeSystemDataTemplateP',
        'FUN_1800416e0': 'CoreEngineInitializeSystemDataTemplateQ',
        'FUN_1800417e0': 'CoreEngineInitializeSystemDataTemplateR',
        'FUN_180041d10': 'CoreEngineInitializeGameRenderMemoryManager',
        'FUN_180041e10': 'CoreEngineInitializeResourceManager',
        'FUN_180041f10': 'CoreEngineInitializeCacheManager',
        'FUN_180041fd0': 'CoreEngineInitializeStringProcessor',
        'FUN_1800420d0': 'CoreEngineInitializeDataStreamManager',
        'FUN_1800421d0': 'CoreEngineInitializeDataStreamProcessor',
        'FUN_1800422d0': 'CoreEngineInitializeDataStreamHandler',
        'FUN_1800429d0': 'CoreEngineInitializeNetworkConnectionPoolProcessor',
        'FUN_180042ad0': 'CoreEngineInitializeNetworkConnectionPoolHandler',
        'FUN_180042bd0': 'CoreEngineInitializeNetworkConnectionPoolManager',
        'FUN_180042cd0': 'CoreEngineInitializeNetworkConnectionPoolController',
        'FUN_180042dd0': 'CoreEngineInitializeNetworkConnectionPoolSupervisor',
        'FUN_180042ed0': 'CoreEngineInitializeNetworkConnectionPoolAdministrator',
        'FUN_180042fd0': 'CoreEngineInitializeNetworkConnectionPoolCoordinator',
        'FUN_1800430d0': 'CoreEngineInitializeNetworkConnectionPoolScheduler',
        'FUN_1800431d0': 'CoreEngineInitializeNetworkConnectionPoolDispatcher',
        'FUN_1800432d0': 'CoreEngineInitializeNetworkConnectionPoolRouter',
        'FUN_1800433d0': 'CoreEngineInitializeNetworkConnectionPoolBalancer',
        'FUN_1800434d0': 'CoreEngineInitializeNetworkConnectionPoolOptimizer',
        'FUN_180043690': 'CoreEngineInitializeNetworkConnectionPoolAnalyzer',
        'FUN_180043c30': 'CoreEngineInitializeNetworkConnectionPoolMonitor',
        'FUN_180043f90': 'CoreEngineInitializeNetworkConnectionPoolInspector',
        'FUN_180044a30': 'CoreEngineProcessNetworkConnectionPool',
        'FUN_180044a50': 'CoreEngineFinalizeNetworkConnectionPool',
        'FUN_180044dc0': 'CoreEngineConfigureNetworkConnectionPool',
        'FUN_180045380': 'CoreEngineValidateNetworkConnectionPool',
        'FUN_180045b20': 'CoreEngineOptimizeNetworkConnectionPool',
        'FUN_180045ee0': 'CoreEngineSynchronizeNetworkConnectionPool',
        'FUN_180045f60': 'CoreEngineResetNetworkConnectionPool',
        'FUN_180045f81': 'CoreEngineCleanupNetworkConnectionPool',
        'FUN_180045fa6': 'CoreEngineFlushNetworkConnectionPool',
        'FUN_180045fc0': 'CoreEngineInitializeNetworkConnectionPoolCache',
        'FUN_180046130': 'CoreEngineProcessNetworkConnectionPoolEvent',
        'FUN_180046160': 'CoreEngineHandleNetworkConnectionPoolRequest',
        'FUN_1800462c0': 'CoreEngineManageNetworkConnectionPoolState',
        'FUN_180046380': 'CoreEngineUpdateNetworkConnectionPoolStatus',
        'FUN_180046400': 'CoreEngineConfigureNetworkConnectionPoolSettings',
        'FUN_18004641f': 'CoreEngineResetNetworkConnectionPoolConfiguration',
        'FUN_180046444': 'CoreEngineValidateNetworkConnectionPoolConfiguration',
        'FUN_1800466a0': 'CoreEngineInitializeNetworkConnectionPoolSession',
        'FUN_1800466d0': 'CoreEngineProcessNetworkConnectionPoolSession',
        'FUN_180046750': 'CoreEngineFinalizeNetworkConnectionPoolSession',
        'FUN_180046820': 'CoreEngineInitializeNetworkConnectionPoolBuffer',
        'FUN_180046840': 'CoreEngineProcessNetworkConnectionPoolBuffer',
        'FUN_180046860': 'CoreEngineValidateNetworkConnectionPoolBuffer',
        'FUN_180046b10': 'CoreEngineInitializeNetworkConnectionPoolQueue',
        'FUN_180046ca0': 'CoreEngineProcessNetworkConnectionPoolQueue',
        'FUN_180046e20': 'CoreEngineFinalizeNetworkConnectionPoolQueue',
        'FUN_180047e10': 'CoreEngineInitializeNetworkConnectionPoolThread',
        'FUN_180047e40': 'CoreEngineProcessNetworkConnectionPoolThread',
        'FUN_180047e70': 'CoreEngineManageNetworkConnectionPoolThread',
        'FUN_180047fc0': 'CoreEngineConfigureNetworkConnectionPoolThread',
        'FUN_180048910': 'CoreEngineInitializeNetworkConnectionPoolLock',
        'FUN_180048980': 'CoreEngineProcessNetworkConnectionPoolLock',
        'FUN_180048a20': 'CoreEngineValidateNetworkConnectionPoolLock',
        'FUN_180048a50': 'CoreEngineReleaseNetworkConnectionPoolLock',
        'FUN_180048ee0': 'CoreEngineInitializeNetworkConnectionPoolSemaphore',
        'FUN_180049470': 'CoreEngineProcessNetworkConnectionPoolSemaphore',
        'FUN_1800495d0': 'CoreEngineManageNetworkConnectionPoolSemaphore',
        'FUN_180049770': 'CoreEngineInitializeNetworkConnectionPoolEvent',
        'FUN_180049790': 'CoreEngineProcessNetworkConnectionPoolEvent',
        'FUN_1800497b0': 'CoreEngineFinalizeNetworkConnectionPoolEvent',
        'FUN_1800497d0': 'CoreEngineConfigureNetworkConnectionPoolEvent',
        'FUN_1800497f0': 'CoreEngineHandleNetworkConnectionPoolEvent',
        'FUN_180049910': 'CoreEngineInitializeNetworkConnectionPoolTimer',
        'FUN_180049931': 'CoreEngineProcessNetworkConnectionPoolTimer',
        'FUN_180049956': 'CoreEngineValidateNetworkConnectionPoolTimer',
        'FUN_1800499c0': 'CoreEngineManageNetworkConnectionPoolTimer',
        'FUN_180049bf0': 'CoreEngineInitializeNetworkConnectionPoolCounter',
        'FUN_180049c70': 'CoreEngineProcessNetworkConnectionPoolCounter',
        'FUN_180049c8f': 'CoreEngineResetNetworkConnectionPoolCounter',
        'FUN_180049cb4': 'CoreEngineValidateNetworkConnectionPoolCounter',
        'FUN_180049d20': 'CoreEngineUpdateNetworkConnectionPoolCounter',
        'FUN_180049f30': 'CoreEngineInitializeNetworkConnectionPoolFlag',
        'FUN_180049fd0': 'CoreEngineProcessNetworkConnectionPoolFlag',
        'FUN_180050b00': 'CoreEngineFinalizeNetworkConnectionPoolFlag',
        'FUN_180050b30': 'CoreEngineResetNetworkConnectionPoolFlag',
        'FUN_180051150': 'CoreEngineValidateNetworkConnectionPoolFlag',
        'FUN_180051d00': 'CoreEngineInitializeNetworkConnectionPoolMask',
        'FUN_180051de4': 'CoreEngineProcessNetworkConnectionPoolMask',
        'FUN_180051e13': 'CoreEngineFinalizeNetworkConnectionPoolMask',
        'FUN_180051e74': 'CoreEngineValidateNetworkConnectionPoolMask',
        'FUN_180051eef': 'CoreEngineResetNetworkConnectionPoolMask',
        'FUN_180052940': 'CoreEngineInitializeNetworkConnectionPoolPattern',
        'FUN_180052ef0': 'CoreEngineProcessNetworkConnectionPoolPattern',
        'FUN_180053200': 'CoreEngineValidateNetworkConnectionPoolPattern',
        'FUN_1800533d0': 'CoreEngineConfigureNetworkConnectionPoolPattern',
        'FUN_180054360': 'CoreEngineInitializeNetworkConnectionPoolTable',
        'FUN_1800547b0': 'CoreEngineFinalizeNetworkConnectionPoolTable',
        'FUN_180055050': 'CoreEngineInitializeNetworkConnectionPoolArray',
        'FUN_180055e10': 'CoreEngineProcessNetworkConnectionPoolArray',
        'FUN_180055e30': 'CoreEngineConfigureNetworkConnectionPoolArray',
        'FUN_180055e60': 'CoreEngineValidateNetworkConnectionPoolArray',
        'FUN_180055ed0': 'CoreEngineResetNetworkConnectionPoolArray',
        'FUN_180055f20': 'CoreEngineInitializeNetworkConnectionPoolList',
        'FUN_180055f50': 'CoreEngineProcessNetworkConnectionPoolList',
        'FUN_180055f70': 'CoreEngineValidateNetworkConnectionPoolList',
        'FUN_180055fa0': 'CoreEngineFinalizeNetworkConnectionPoolList',
        'FUN_180056150': 'CoreEngineInitializeNetworkConnectionPoolTree',
        'FUN_180056410': 'CoreEngineProcessNetworkConnectionPoolTree',
        'FUN_1800565f0': 'CoreEngineConfigureNetworkConnectionPoolTree',
        'FUN_180056810': 'CoreEngineValidateNetworkConnectionPoolTree',
        'FUN_180056b30': 'CoreEngineInitializeNetworkConnectionPoolGraph',
        'FUN_180056c50': 'CoreEngineProcessNetworkConnectionPoolGraph',
        'FUN_180057010': 'CoreEngineConfigureNetworkConnectionPoolGraph',
        'FUN_180057029': 'CoreEngineValidateNetworkConnectionPoolGraph',
        'FUN_180057062': 'CoreEngineFinalizeNetworkConnectionPoolGraph',
        'FUN_180057110': 'CoreEngineInitializeNetworkConnectionPoolHash',
        'FUN_180057170': 'CoreEngineProcessNetworkConnectionPoolHash',
        'FUN_1800571e0': 'CoreEngineConfigureNetworkConnectionPoolHash',
        'FUN_1800572d0': 'CoreEngineValidateNetworkConnectionPoolHash',
        'FUN_1800572e6': 'CoreEngineResetNetworkConnectionPoolHash',
        'FUN_180057314': 'CoreEngineFinalizeNetworkConnectionPoolHash',
        'FUN_180057340': 'CoreEngineInitializeNetworkConnectionPoolMap',
        'FUN_18005736b': 'CoreEngineProcessNetworkConnectionPoolMap',
        'FUN_180057446': 'CoreEngineConfigureNetworkConnectionPoolMap',
        'FUN_180057479': 'CoreEngineValidateNetworkConnectionPoolMap',
        'FUN_180057490': 'CoreEngineInitializeNetworkConnectionPoolSet',
        'FUN_1800574b0': 'CoreEngineProcessNetworkConnectionPoolSet',
        'FUN_180057510': 'CoreEngineConfigureNetworkConnectionPoolSet',
        'FUN_180057530': 'CoreEngineValidateNetworkConnectionPoolSet',
        'FUN_180057550': 'CoreEngineFinalizeNetworkConnectionPoolSet',
        'FUN_180057556': 'CoreEngineResetNetworkConnectionPoolSet',
        'FUN_180057580': 'CoreEngineInitializeNetworkConnectionPoolStack',
        'FUN_1800575b6': 'CoreEngineProcessNetworkConnectionPoolStack',
        'FUN_1800575d4': 'CoreEngineFinalizeNetworkConnectionPoolStack',
        'FUN_1800575f0': 'CoreEngineInitializeNetworkConnectionPoolQueueAdvanced',
        'FUN_180057610': 'CoreEngineProcessNetworkConnectionPoolQueueAdvanced',
        'FUN_180057680': 'CoreEngineConfigureNetworkConnectionPoolQueueAdvanced',
        'FUN_180057730': 'CoreEngineValidateNetworkConnectionPoolQueueAdvanced',
        'FUN_180057790': 'CoreEngineResetNetworkConnectionPoolQueueAdvanced',
        'FUN_180057796': 'CoreEngineFinalizeNetworkConnectionPoolQueueAdvanced',
        'FUN_1800577c0': 'CoreEngineInitializeNetworkConnectionPoolHeap',
        'FUN_1800577f6': 'CoreEngineProcessNetworkConnectionPoolHeap',
        'FUN_180057814': 'CoreEngineFinalizeNetworkConnectionPoolHeap',
        'FUN_180057830': 'CoreEngineInitializeNetworkConnectionPoolPriorityQueue',
        'FUN_1800578a0': 'CoreEngineProcessNetworkConnectionPoolPriorityQueue',
        'FUN_180057980': 'CoreEngineConfigureNetworkConnectionPoolPriorityQueue',
        'FUN_180057bf0': 'CoreEngineValidateNetworkConnectionPoolPriorityQueue',
        'FUN_180057d70': 'CoreEngineInitializeNetworkConnectionPoolCircularBuffer',
        'FUN_180057e90': 'CoreEngineProcessNetworkConnectionPoolCircularBuffer',
        'FUN_180057ec0': 'CoreEngineConfigureNetworkConnectionPoolCircularBuffer',
        'FUN_180057ee0': 'CoreEngineValidateNetworkConnectionPoolCircularBuffer',
        'FUN_180057f10': 'CoreEngineResetNetworkConnectionPoolCircularBuffer',
        'FUN_180057f30': 'CoreEngineFinalizeNetworkConnectionPoolCircularBuffer',
        'FUN_180058000': 'CoreEngineInitializeNetworkConnectionPoolRingBuffer',
        'FUN_180058020': 'CoreEngineProcessNetworkConnectionPoolRingBuffer',
        'FUN_180058160': 'CoreEngineInitializeNetworkConnectionPoolDoubleBuffer',
    }
    
    # 应用函数名替换
    for old_name, new_name in function_mappings.items():
        # 替换函数声明
        content = re.sub(rf'void\s+{old_name}\s*\(', f'void {new_name}(', content)
        # 替换函数调用
        content = re.sub(rf'\b{old_name}\b\s*\(', f'{new_name}(', content)
        # 替换注释中的函数名
        content = re.sub(rf'// 函数:\s*void\s+{old_name}', f'// 函数: void {new_name}', content)
    
    # 写入文件
    with open(file_path, 'w', encoding='utf-8') as f:
        f.write(content)
    
    print(f"成功美化 {len(function_mappings)} 个函数名")

if __name__ == "__main__":
    if len(sys.argv) != 2:
        print("用法: python beautify_core_engine_functions.py <文件路径>")
        sys.exit(1)
    
    file_path = sys.argv[1]
    beautify_core_engine_functions(file_path)