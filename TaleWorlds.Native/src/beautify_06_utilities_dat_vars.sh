#!/bin/bash

# 美化06_utilities.c文件中的DAT_变量名
# 将DAT_180*变量替换为语义化名称

cd /dev/shm/mountblade-code/TaleWorlds.Native/src/

# 创建备份
cp 06_utilities.c 06_utilities.c.backup

# 定义替换规则
declare -A replacements=(
    ["DAT_180c8ed30"]="SystemResourceOffsetTable"
    ["DAT_180d49238"]="SystemGlobalStatusFlag"
    ["DAT_180c86938"]="SystemMemoryManagerPointer"
    ["DAT_180c86890"]="SystemMemoryManagerBase"
    ["DAT_180c821d0"]="SystemStatusIndicator"
    ["DAT_180bf5208"]="SystemDataStructurePointer001"
    ["DAT_180bf5bc0"]="SystemDataStructurePointer002"
    ["DAT_180bf5c30"]="SystemDataStructurePointer003"
    ["DAT_180bf52e8"]="SystemDataStructurePointer004"
    ["DAT_180bf5738"]="SystemDataStructurePointer005"
    ["DAT_180d49218"]="SystemResourceHandlerPointer001"
    ["DAT_180d49220"]="SystemResourceHandlerFlag001"
    ["DAT_180d49230"]="SystemResourceHandlerFlag002"
    ["DAT_180d49240"]="SystemResourceHandlerPointer002"
    ["DAT_180d49248"]="SystemResourceHandlerFlag003"
    ["DAT_180d49258"]="SystemResourceHandlerFlag004"
    ["DAT_180d49950"]="SystemErrorCheckFlag"
    ["DAT_180d49830"]="SystemDataStructurePointer006"
    ["DAT_180c91f18"]="MemoryPoolStartAddress"
    ["DAT_180c91f28"]="MemoryPoolEndAddress"
    ["DAT_180bf91b0"]="SystemDataStructurePointer007"
    ["DAT_180bf9210"]="SystemDataStructurePointer008"
    ["DAT_180bf9270"]="SystemDataStructurePointer009"
    ["DAT_180bf92d0"]="SystemDataStructurePointer010"
    ["DAT_180bf9330"]="SystemDataStructurePointer011"
    ["DAT_180bf9390"]="SystemDataStructurePointer012"
    ["DAT_180bf93f0"]="SystemDataStructurePointer013"
    ["DAT_180bf9450"]="SystemDataStructurePointer014"
    ["DAT_180bf9570"]="SystemDataStructurePointer015"
    ["DAT_180bf95d0"]="SystemDataStructurePointer016"
    ["DAT_180bf9630"]="SystemDataStructurePointer017"
    ["DAT_180bf9690"]="SystemDataStructurePointer018"
    ["DAT_180bf96f0"]="SystemDataStructurePointer019"
    ["DAT_180bf9750"]="SystemDataStructurePointer020"
    ["DAT_180bf97b0"]="SystemDataStructurePointer021"
    ["DAT_180bf9810"]="SystemDataStructurePointer022"
    ["DAT_180bf9870"]="SystemDataStructurePointer023"
    ["DAT_180bf98d0"]="SystemDataStructurePointer024"
    ["DAT_180bf9930"]="SystemDataStructurePointer025"
    ["DAT_180bf9990"]="SystemDataStructurePointer026"
    ["DAT_180bf9a50"]="SystemDataStructurePointer027"
    ["DAT_180bf9ab0"]="SystemDataStructurePointer028"
    ["DAT_180bf9b10"]="SystemDataStructurePointer029"
    ["DAT_180bf9b70"]="SystemDataStructurePointer030"
    ["DAT_180bf9bd0"]="SystemDataStructurePointer031"
    ["DAT_180bf9c30"]="SystemDataStructurePointer032"
    ["DAT_180bf9c90"]="SystemDataStructurePointer033"
    ["DAT_180bf9cf0"]="SystemDataStructurePointer034"
    ["DAT_180bf9d50"]="SystemDataStructurePointer035"
    ["DAT_180bf9db0"]="SystemDataStructurePointer036"
    ["DAT_180bf9e10"]="SystemDataStructurePointer037"
    ["DAT_180bf9e70"]="SystemDataStructurePointer038"
    ["DAT_180bf9ed0"]="SystemDataStructurePointer039"
    ["DAT_180bf9f30"]="SystemDataStructurePointer040"
    ["DAT_180bf9f90"]="SystemDataStructurePointer041"
    ["DAT_180bf9ff0"]="SystemDataStructurePointer042"
    ["DAT_180bfa050"]="SystemDataStructurePointer043"
    ["DAT_180bfa0b0"]="SystemDataStructurePointer044"
    ["DAT_180bfa110"]="SystemDataStructurePointer045"
    ["DAT_180bfa170"]="SystemDataStructurePointer046"
    ["DAT_180bfa1d0"]="SystemDataStructurePointer047"
    ["DAT_180bfa230"]="SystemDataStructurePointer048"
    ["DAT_180bfa290"]="SystemDataStructurePointer049"
    ["DAT_180bfa2f0"]="SystemResourceHashPointer001"
    ["DAT_180bfa2e8"]="SystemValidationResultPointer001"
    ["DAT_180bfa310"]="SystemResourceHashPointer002"
    ["DAT_180bfa308"]="SystemValidationResultPointer002"
    ["DAT_180bfa330"]="SystemResourceHashPointer003"
    ["DAT_180bfa328"]="SystemValidationResultPointer003"
    ["DAT_180bfaec0"]="SystemResourceDataTable"
    ["DAT_180bfaed0"]="SystemResourceDataPointer"
    ["DAT_180bfaea8"]="SystemResourceHashPointer"
    ["DAT_180bfaea0"]="SystemValidationResultPointer"
    ["DAT_180c92050"]="SystemDataStructurePointerCF"
    ["DAT_180bfc140"]="SystemStateData"
    ["DAT_180bfc118"]="SystemStateCount"
    ["DAT_180bfc100"]="SystemStateBase"
    ["DAT_180bfc110"]="SystemStateFlag"
    ["DAT_180bfb730"]="SystemDataStructurePointer050"
    ["DAT_180d499d0"]="SystemDataStructurePointer051"
    ["DAT_180d49bf0"]="SystemDataStructurePointer052"
    ["DAT_180c92478"]="ResourceManagerPointer"
    ["DAT_180c92498"]="ResourceTablePointer001"
    ["DAT_180c92488"]="ResourceTablePointer002"
    ["DAT_180bfc188"]="SystemBufferSize"
    ["DAT_180bfc170"]="SystemBufferBase"
    ["DAT_180bfc180"]="SystemBufferFlag"
    ["DAT_180bf6048"]="SystemDataStructurePointer053"
    ["DAT_180bf6498"]="SystemDataStructurePointer054"
    ["DAT_180d49e18"]="NetworkDataPointer"
    ["DAT_180c95ef0"]="SystemModuleFlag001"
    ["DAT_180c96008"]="SystemModuleFlag002"
    ["DAT_180c95ff0"]="SystemModulePointer001"
    ["DAT_180c96028"]="SystemModuleFlag003"
    ["DAT_180c96010"]="SystemModuleFlag004"
    ["DAT_180c96030"]="SystemModulePointer002"
    ["DAT_180c96048"]="SystemModuleFlag005"
    ["DAT_180c96050"]="SystemModulePointer003"
    ["DAT_180c96068"]="SystemModuleFlag006"
    ["DAT_180c96070"]="SystemModulePointer004"
    ["DAT_180c960b8"]="SystemModuleFlag007"
    ["DAT_180c960a0"]="SystemModulePointer005"
    ["DAT_180c96100"]="SystemModuleFlag008"
    ["DAT_180c960c0"]="SystemModuleData"
    ["DAT_180c96138"]="SystemResourcePointer"
    ["DAT_180c96140"]="SystemResourceFlag"
    ["DAT_180c96120"]="SystemResourceFlag009"
    ["DAT_180c961d8"]="SystemValidationFlag"
    ["DAT_180c961b0"]="SystemValidationData"
    ["DAT_180c95f18"]="SystemCleanupPointer"
    ["DAT_180c95f28"]="SystemCleanupFlag"
    ["DAT_180c95f20"]="SystemCleanupStatus"
    ["DAT_180c95ef8"]="SystemCleanupFlag010"
    ["DAT_180c95fe8"]="SystemFinalFlag"
    ["DAT_180c95fc8"]="SystemFinalFlag011"
    ["DAT_180c96210"]="SystemFinalFlag012"
    ["DAT_180bf64f8"]="SystemDataStructurePointer055"
    ["DAT_180bf6558"]="SystemDataStructurePointer056"
    ["DAT_180d49f80"]="SystemDataStructurePointer057"
    ["DAT_180d49fe0"]="SystemDataStructurePointer058"
)

# 执行替换
for old_name in "${!replacements[@]}"; do
    new_name="${replacements[$old_name]}"
    sed -i "s/\b$old_name\b/$new_name/g" 06_utilities.c
done

echo "DAT_变量名美化完成"