#!/bin/bash

# UI系统函数名美化脚本
# 用于批量替换FUN_开头的函数名为有意义的名称

# 函数替换映射
declare -A function_map=(
    ["FUN_18068def0"]="ValidateUIDataChecksum"
    ["FUN_18068df70"]="ValidateUIDataStructure"
    ["FUN_18068dff0"]="ValidateUIDataFormat"
    ["FUN_18068e070"]="ProcessUIDataValidation"
    ["FUN_18068e250"]="ProcessUIDataTransformation"
    ["FUN_18068e430"]="ProcessUIDataConversion"
    ["FUN_18068e610"]="ProcessUIDataEncoding"
    ["FUN_18068e7f0"]="ValidateUIResourceIntegrity"
    ["FUN_18068e870"]="ValidateUIResourceStructure"
    ["FUN_18068e8f0"]="ValidateUIResourceFormat"
    ["FUN_18068e970"]="ValidateUIResourceChecksum"
    ["FUN_18068e9f0"]="ProcessUIResourceValidation"
    ["FUN_18068ea70"]="ProcessUIResourceTransformation"
    ["FUN_18068eaf0"]="ProcessUIResourceConversion"
    ["FUN_18068eb60"]="ProcessUIResourceEncoding"
    ["FUN_18068ebd0"]="ValidateUIComponentIntegrity"
    ["FUN_18068ec40"]="ValidateUIComponentStructure"
    ["FUN_18068ecb0"]="ValidateUIComponentFormat"
    ["FUN_18068ed20"]="ValidateUIComponentChecksum"
    ["FUN_18068ed90"]="ProcessUIComponentValidation"
    ["FUN_18068ee80"]="ProcessUIComponentTransformation"
    ["FUN_18068ef70"]="ProcessUIComponentConversion"
    ["FUN_18068f060"]="ProcessUIComponentEncoding"
    ["FUN_18068f150"]="ValidateUIBufferIntegrity"
    ["FUN_18068f240"]="ValidateUIBufferStructure"
    ["FUN_18068f330"]="ValidateUIBufferFormat"
    ["FUN_18068f3a0"]="ValidateUIBufferChecksum"
    ["FUN_18068f410"]="ProcessUIBufferValidation"
    ["FUN_18068f480"]="ProcessUIBufferTransformation"
    ["FUN_18068f4f0"]="ProcessUIBufferConversion"
    ["FUN_18068f680"]="ProcessUIBufferEncoding"
    ["FUN_18068f810"]="ValidateUIEventIntegrity"
    ["FUN_18068f9a0"]="ValidateUIEventStructure"
    ["FUN_18068fb30"]="ValidateUIEventFormat"
    ["FUN_18068fba0"]="ValidateUIEventChecksum"
    ["FUN_18068fc10"]="ProcessUIEventValidation"
    ["FUN_18068fc80"]="ProcessUIEventTransformation"
    ["FUN_18068fcf0"]="ProcessUIEventConversion"
    ["FUN_18068fd60"]="ProcessUIEventEncoding"
    ["FUN_18068fdd0"]="ValidateUIRenderIntegrity"
    ["FUN_18068fe10"]="ValidateUIRenderStructure"
    ["FUN_18068ff60"]="ValidateUIRenderFormat"
    ["FUN_180690200"]="ValidateUIRenderChecksum"
    ["FUN_1806903c0"]="ProcessUIRenderValidation"
    ["FUN_1806905c0"]="ProcessUIRenderTransformation"
    ["FUN_180690700"]="ProcessUIRenderConversion"
    ["FUN_180690800"]="ProcessUIRenderEncoding"
    ["FUN_180691080"]="ValidateUILayoutIntegrity"
    ["FUN_1806917c0"]="ValidateUILayoutStructure"
    ["FUN_180691db0"]="ValidateUILayoutFormat"
    ["FUN_1806922f0"]="ValidateUILayoutChecksum"
    ["FUN_1806935a0"]="ProcessUILayoutValidation"
    ["FUN_180694010"]="ProcessUILayoutTransformation"
    ["FUN_180694040"]="ProcessUILayoutConversion"
    ["FUN_180694c40"]="ProcessUILayoutEncoding"
    ["FUN_180695530"]="ValidateUIAnimationIntegrity"
    ["FUN_180695870"]="ValidateUIAnimationStructure"
    ["FUN_1806958c0"]="ValidateUIAnimationFormat"
    ["FUN_180695990"]="ValidateUIAnimationChecksum"
    ["FUN_180695ac0"]="ProcessUIAnimationValidation"
    ["FUN_180695bf0"]="ProcessUIAnimationTransformation"
    ["FUN_180695c4d"]="ProcessUIAnimationConversion"
    ["FUN_180695f0f"]="ProcessUIAnimationEncoding"
    ["FUN_180696370"]="ValidateUITextureIntegrity"
    ["FUN_180696540"]="ValidateUITextureStructure"
    ["FUN_180696710"]="ValidateUITextureFormat"
    ["FUN_1806968e0"]="ValidateUITextureChecksum"
    ["FUN_180696a60"]="ProcessUITextureValidation"
    ["FUN_180696be0"]="ProcessUITextureTransformation"
    ["FUN_180696d90"]="ProcessUITextureConversion"
    ["FUN_180696f40"]="ProcessUITextureEncoding"
    ["FUN_1806979e0"]="ValidateUIFontIntegrity"
    ["FUN_180698140"]="ValidateUIFontStructure"
    ["FUN_1806982a0"]="ValidateUIFontFormat"
    ["FUN_180698440"]="ValidateUIFontChecksum"
    ["FUN_1806984b0"]="ProcessUIFontValidation"
    ["FUN_1806984f1"]="ProcessUIFontTransformation"
    ["FUN_1806986b7"]="ProcessUIFontConversion"
    ["FUN_1806986d0"]="ProcessUIFontEncoding"
    ["FUN_1806986ff"]="ValidateUIShaderIntegrity"
    ["FUN_1806987ee"]="ValidateUIShaderStructure"
    ["FUN_180698800"]="ValidateUIShaderFormat"
    ["FUN_1806988d0"]="ValidateUIShaderChecksum"
    ["FUN_1806988f5"]="ProcessUIShaderValidation"
    ["FUN_180698a50"]="ProcessUIShaderTransformation"
    ["FUN_180698b00"]="ProcessUIShaderConversion"
    ["FUN_180698bb0"]="ProcessUIShaderEncoding"
    ["FUN_180698c64"]="ValidateUIMemoryIntegrity"
    ["FUN_180698e02"]="ValidateUIMemoryStructure"
    ["FUN_1806993a0"]="ValidateUIMemoryFormat"
    ["FUN_180699508"]="ValidateUIMemoryChecksum"
    ["FUN_180699620"]="ProcessUIMemoryValidation"
    ["FUN_180699e30"]="ProcessUIMemoryTransformation"
    ["FUN_180699e38"]="ProcessUIMemoryConversion"
    ["FUN_180699e5f"]="ProcessUIMemoryEncoding"
    ["FUN_180699f09"]="ValidateUIInputIntegrity"
    ["FUN_180699f10"]="ValidateUIInputStructure"
    ["FUN_180699f21"]="ValidateUIInputFormat"
    ["FUN_180699f40"]="ValidateUIInputChecksum"
    ["FUN_18069a100"]="ProcessUIInputValidation"
    ["FUN_18069a210"]="ProcessUIInputTransformation"
    ["FUN_18069a490"]="ProcessUIInputConversion"
    ["FUN_18069a580"]="ProcessUIInputEncoding"
)

# 对每个函数进行替换
for old_name in "${!function_map[@]}"; do
    new_name="${function_map[$old_name]}"
    
    # 检查文件中是否存在该函数
    if grep -q "$old_name" /dev/shm/mountblade-code/TaleWorlds.Native/src/04_ui_system.c; then
        echo "替换函数: $old_name -> $new_name"
        
        # 替换所有出现的地方
        sed -i "s/$old_name/$new_name/g" /dev/shm/mountblade-code/TaleWorlds.Native/src/04_ui_system.c
    fi
done

echo "函数名替换完成"