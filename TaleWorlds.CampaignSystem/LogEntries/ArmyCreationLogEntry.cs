using System;
using System.Collections.Generic;
using Helpers;
using TaleWorlds.Localization;
using TaleWorlds.ObjectSystem;
using TaleWorlds.SaveSystem;

namespace TaleWorlds.CampaignSystem.LogEntries
{
	// Token: 0x020002C6 RID: 710
	public class ArmyCreationLogEntry : LogEntry, IEncyclopediaLog, IWarLog
	{
		// Token: 0x060029E6 RID: 10726 RVA: 0x000B3A1E File Offset: 0x000B1C1E
		internal static void AutoGeneratedStaticCollectObjectsArmyCreationLogEntry(object o, List<object> collectedObjects)
		{
			((ArmyCreationLogEntry)o).AutoGeneratedInstanceCollectObjects(collectedObjects);
		}

		// Token: 0x060029E7 RID: 10727 RVA: 0x000B3A2C File Offset: 0x000B1C2C
		protected override void AutoGeneratedInstanceCollectObjects(List<object> collectedObjects)
		{
			base.AutoGeneratedInstanceCollectObjects(collectedObjects);
			collectedObjects.Add(this._armyLeader);
		}

		// Token: 0x060029E8 RID: 10728 RVA: 0x000B3A41 File Offset: 0x000B1C41
		internal static object AutoGeneratedGetMemberValue_armyLeader(object o)
		{
			return ((ArmyCreationLogEntry)o)._armyLeader;
		}

		// Token: 0x17000A72 RID: 2674
		// (get) Token: 0x060029E9 RID: 10729 RVA: 0x000B3A4E File Offset: 0x000B1C4E
		public override CampaignTime KeepInHistoryTime
		{
			get
			{
				return CampaignTime.Weeks(1f);
			}
		}

		// Token: 0x060029EA RID: 10730 RVA: 0x000B3A5A File Offset: 0x000B1C5A
		public ArmyCreationLogEntry(Army army)
		{
			this._armyLeader = army.LeaderParty.LeaderHero.CharacterObject;
		}

		// Token: 0x060029EB RID: 10731 RVA: 0x000B3A78 File Offset: 0x000B1C78
		public override string ToString()
		{
			return this.GetEncyclopediaText().ToString();
		}

		// Token: 0x060029EC RID: 10732 RVA: 0x000B3A88 File Offset: 0x000B1C88
		public bool IsRelatedToWar(StanceLink stance, out IFaction effector, out IFaction effected)
		{
			IFaction faction = stance.Faction1;
			IFaction faction2 = stance.Faction2;
			effector = this._armyLeader.HeroObject.MapFaction;
			effected = null;
			return this._armyLeader.HeroObject.MapFaction == faction || this._armyLeader.HeroObject.MapFaction == faction2;
		}

		// Token: 0x060029ED RID: 10733 RVA: 0x000B3AE0 File Offset: 0x000B1CE0
		public bool IsVisibleInEncyclopediaPageOf<T>(T obj) where T : MBObjectBase
		{
			return obj == this._armyLeader.HeroObject;
		}

		// Token: 0x060029EE RID: 10734 RVA: 0x000B3AF8 File Offset: 0x000B1CF8
		public TextObject GetEncyclopediaText()
		{
			TextObject textObject = new TextObject("{=aXhPvVud}{HERO.LINK} created an army.", null);
			StringHelpers.SetCharacterProperties("HERO", this._armyLeader, textObject, false);
			return textObject;
		}

		// Token: 0x04000C98 RID: 3224
		[SaveableField(20)]
		private readonly CharacterObject _armyLeader;
	}
}
