using System;
using System.Collections.Generic;
using Helpers;
using TaleWorlds.CampaignSystem.Settlements;
using TaleWorlds.Localization;
using TaleWorlds.SaveSystem;

namespace TaleWorlds.CampaignSystem.LogEntries
{
	// Token: 0x020002D9 RID: 729
	public class GatherArmyLogEntry : LogEntry, IChatNotification
	{
		// Token: 0x06002AD2 RID: 10962 RVA: 0x000B63EF File Offset: 0x000B45EF
		internal static void AutoGeneratedStaticCollectObjectsGatherArmyLogEntry(object o, List<object> collectedObjects)
		{
			((GatherArmyLogEntry)o).AutoGeneratedInstanceCollectObjects(collectedObjects);
		}

		// Token: 0x06002AD3 RID: 10963 RVA: 0x000B63FD File Offset: 0x000B45FD
		protected override void AutoGeneratedInstanceCollectObjects(List<object> collectedObjects)
		{
			base.AutoGeneratedInstanceCollectObjects(collectedObjects);
			collectedObjects.Add(this.ArmyLeader);
			collectedObjects.Add(this.ArmyMapFaction);
			collectedObjects.Add(this.GatheringSettlement);
		}

		// Token: 0x06002AD4 RID: 10964 RVA: 0x000B642A File Offset: 0x000B462A
		internal static object AutoGeneratedGetMemberValueArmyLeader(object o)
		{
			return ((GatherArmyLogEntry)o).ArmyLeader;
		}

		// Token: 0x06002AD5 RID: 10965 RVA: 0x000B6437 File Offset: 0x000B4637
		internal static object AutoGeneratedGetMemberValueArmyMapFaction(object o)
		{
			return ((GatherArmyLogEntry)o).ArmyMapFaction;
		}

		// Token: 0x06002AD6 RID: 10966 RVA: 0x000B6444 File Offset: 0x000B4644
		internal static object AutoGeneratedGetMemberValueGatheringSettlement(object o)
		{
			return ((GatherArmyLogEntry)o).GatheringSettlement;
		}

		// Token: 0x17000A90 RID: 2704
		// (get) Token: 0x06002AD7 RID: 10967 RVA: 0x000B6451 File Offset: 0x000B4651
		public override ChatNotificationType NotificationType
		{
			get
			{
				return base.MilitaryNotification(this.ArmyLeader.Clan, null);
			}
		}

		// Token: 0x17000A91 RID: 2705
		// (get) Token: 0x06002AD8 RID: 10968 RVA: 0x000B6465 File Offset: 0x000B4665
		public bool IsVisibleNotification
		{
			get
			{
				return this.ArmyMapFaction == Hero.MainHero.MapFaction;
			}
		}

		// Token: 0x06002AD9 RID: 10969 RVA: 0x000B6479 File Offset: 0x000B4679
		public GatherArmyLogEntry(Army army, Settlement gatheringSettlement)
		{
			this.ArmyLeader = army.LeaderParty.LeaderHero;
			this.ArmyMapFaction = army.Kingdom;
			this.GatheringSettlement = gatheringSettlement;
		}

		// Token: 0x06002ADA RID: 10970 RVA: 0x000B64A5 File Offset: 0x000B46A5
		public override string ToString()
		{
			return this.GetNotificationText().ToString();
		}

		// Token: 0x06002ADB RID: 10971 RVA: 0x000B64B4 File Offset: 0x000B46B4
		public TextObject GetNotificationText()
		{
			TextObject textObject = new TextObject("{=Vi5Ylvr1}{LORD.NAME} is gathering army near {SETTLEMENT}", null);
			StringHelpers.SetCharacterProperties("LORD", this.ArmyLeader.CharacterObject, textObject, false);
			textObject.SetTextVariable("SETTLEMENT", this.GatheringSettlement.ToString());
			return textObject;
		}

		// Token: 0x04000CD8 RID: 3288
		[SaveableField(220)]
		public readonly Hero ArmyLeader;

		// Token: 0x04000CD9 RID: 3289
		[SaveableField(221)]
		public readonly IFaction ArmyMapFaction;

		// Token: 0x04000CDA RID: 3290
		[SaveableField(222)]
		public readonly Settlement GatheringSettlement;
	}
}
